<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Shodan手册</title>
    <meta name="description" content="现由ph0rse和Jirairya共同修订，欢迎大家issue  **_PS:本来本文投稿于信安之路（http://mp.weixin.qq.com/s/SVl_YLhcfNgHya6jEnKx1g）的， 后@ph0rse建议放于gitbook上，方便大家在线查阅、共同维护，就有了gitbook版本 （https...">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/2018/02/08/Shodan-Manual/">
    <link rel="alternate" type="application/rss+xml" title="Jirairya" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?973906e37cc7bcb6714807627cf64ec6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-111240288-1', 'auto');
      ga('send', 'pageview');

    </script>



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">Jirairya</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collections/">
                        
                            <i class="fa fa-folder-open"></i>Collections
                        </a>
                    </li>
                    
                
                    
                
                    
                    <li>
                        
                        <a href="/skills/">
                        
                            <i class="fa fa-bezier-curve"></i>Skills
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tools/">
                        
                            <i class="fa fa-toolbox"></i>Tools
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-paper-plane"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>Shodan手册</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2018-02-08
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#hack" title="Category: hack" rel="category">hack</a>&nbsp;
    
        <a href="/category/#skills" title="Category: skills" rel="category">skills</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#sec" title="Tag: sec" rel="tag">sec</a-->
        <a href="/tag/#sec" title="Tag: sec" rel="tag">sec</a>&nbsp;
    
        <!--a href="/tag/#skills" title="Tag: skills" rel="tag">skills</a-->
        <a href="/tag/#skills" title="Tag: skills" rel="tag">skills</a>&nbsp;
    
        <!--a href="/tag/#shodan" title="Tag: shodan" rel="tag">shodan</a-->
        <a href="/tag/#shodan" title="Tag: shodan" rel="tag">shodan</a>&nbsp;
    
        <!--a href="/tag/#information" title="Tag: information" rel="tag">information</a-->
        <a href="/tag/#information" title="Tag: information" rel="tag">information</a>&nbsp;
    
        <!--a href="/tag/#search" title="Tag: search" rel="tag">search</a-->
        <a href="/tag/#search" title="Tag: search" rel="tag">search</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <ul id="markdown-toc">
  <li><a href="#前言" id="markdown-toc-前言">前言</a></li>
  <li><a href="#介绍" id="markdown-toc-介绍">介绍</a>    <ul>
      <li><a href="#关于数据" id="markdown-toc-关于数据">关于数据</a>        <ul>
          <li><a href="#banner" id="markdown-toc-banner">Banner</a></li>
          <li><a href="#设备元数据" id="markdown-toc-设备元数据">设备元数据</a></li>
          <li><a href="#ipv6" id="markdown-toc-ipv6">IPv6</a></li>
        </ul>
      </li>
      <li><a href="#数据采集" id="markdown-toc-数据采集">数据采集</a>        <ul>
          <li><a href="#频率" id="markdown-toc-频率">频率</a></li>
          <li><a href="#分布式" id="markdown-toc-分布式">分布式</a></li>
          <li><a href="#随机" id="markdown-toc-随机">随机</a></li>
        </ul>
      </li>
      <li><a href="#深入ssl" id="markdown-toc-深入ssl">深入SSL</a>        <ul>
          <li><a href="#漏洞测试" id="markdown-toc-漏洞测试">漏洞测试</a>            <ul>
              <li><a href="#心脏出血漏洞" id="markdown-toc-心脏出血漏洞">心脏出血漏洞</a></li>
              <li><a href="#freak" id="markdown-toc-freak">FREAK</a></li>
              <li><a href="#logjam" id="markdown-toc-logjam">Logjam</a></li>
              <li><a href="#版本" id="markdown-toc-版本">版本</a></li>
              <li><a href="#遵循链" id="markdown-toc-遵循链">遵循链</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#基础之上" id="markdown-toc-基础之上">基础之上</a>        <ul>
          <li><a href="#web组件" id="markdown-toc-web组件">Web组件</a></li>
          <li><a href="#级联" id="markdown-toc-级联">级联</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#web界面" id="markdown-toc-web界面">Web界面</a>    <ul>
      <li><a href="#搜索查询说明" id="markdown-toc-搜索查询说明">搜索查询说明</a></li>
      <li><a href="#过滤器" id="markdown-toc-过滤器">过滤器</a></li>
      <li><a href="#搜索引擎" id="markdown-toc-搜索引擎">搜索引擎</a>        <ul>
          <li><a href="#下载数据" id="markdown-toc-下载数据">下载数据</a></li>
          <li><a href="#生成报告" id="markdown-toc-生成报告">生成报告</a></li>
          <li><a href="#分享结果" id="markdown-toc-分享结果">分享结果</a></li>
        </ul>
      </li>
      <li><a href="#例子" id="markdown-toc-例子">例子</a></li>
      <li><a href="#shodan地图" id="markdown-toc-shodan地图">Shodan地图</a></li>
      <li><a href="#shodan-exploits" id="markdown-toc-shodan-exploits">Shodan Exploits</a></li>
      <li><a href="#shodan-images" id="markdown-toc-shodan-images">Shodan Images</a></li>
      <li><a href="#共享的shodan搜索语法" id="markdown-toc-共享的shodan搜索语法">共享的Shodan搜索语法</a></li>
    </ul>
  </li>
  <li><a href="#关于shodan的外部工具" id="markdown-toc-关于shodan的外部工具">关于Shodan的外部工具</a>    <ul>
      <li><a href="#shodan命令行界面" id="markdown-toc-shodan命令行界面">Shodan命令行界面</a>        <ul>
          <li><a href="#alert命令" id="markdown-toc-alert命令">alert命令</a></li>
          <li><a href="#convert命令" id="markdown-toc-convert命令">convert命令</a></li>
          <li><a href="#count命令" id="markdown-toc-count命令">count命令</a></li>
          <li><a href="#download命令" id="markdown-toc-download命令">download命令</a></li>
          <li><a href="#host命令" id="markdown-toc-host命令">host命令</a></li>
          <li><a href="#honeyscore命令" id="markdown-toc-honeyscore命令">honeyscore命令</a></li>
          <li><a href="#info命令" id="markdown-toc-info命令">info命令</a></li>
          <li><a href="#myip命令" id="markdown-toc-myip命令">myip命令</a></li>
          <li><a href="#parse命令" id="markdown-toc-parse命令">parse命令</a></li>
          <li><a href="#scan命令" id="markdown-toc-scan命令">scan命令</a></li>
          <li><a href="#search命令" id="markdown-toc-search命令">search命令</a></li>
          <li><a href="#stats命令" id="markdown-toc-stats命令">stats命令</a></li>
          <li><a href="#stream命令" id="markdown-toc-stream命令">stream命令</a></li>
        </ul>
      </li>
      <li><a href="#例子-1" id="markdown-toc-例子-1">例子</a>        <ul>
          <li><a href="#官方例子" id="markdown-toc-官方例子">官方例子</a></li>
          <li><a href="#网络分析例子" id="markdown-toc-网络分析例子">网络分析例子</a></li>
          <li><a href="#分析ssl的例子" id="markdown-toc-分析ssl的例子">分析SSL的例子</a></li>
          <li><a href="#分析telnet情况" id="markdown-toc-分析telnet情况">分析telnet情况</a></li>
        </ul>
      </li>
      <li><a href="#maltego扩展组件assets" id="markdown-toc-maltego扩展组件assets">Maltego扩展组件/assets</a></li>
      <li><a href="#浏览器插件" id="markdown-toc-浏览器插件">浏览器插件</a></li>
      <li><a href="#metasploit" id="markdown-toc-metasploit">Metasploit</a></li>
      <li><a href="#recon-ng" id="markdown-toc-recon-ng">Recon-ng</a></li>
    </ul>
  </li>
  <li><a href="#developer-api" id="markdown-toc-developer-api">Developer API</a>    <ul>
      <li><a href="#使用限制" id="markdown-toc-使用限制">使用限制</a></li>
      <li><a href="#facets" id="markdown-toc-facets">Facets</a></li>
      <li><a href="#入门" id="markdown-toc-入门">入门</a></li>
      <li><a href="#初始化" id="markdown-toc-初始化">初始化</a></li>
      <li><a href="#搜索" id="markdown-toc-搜索">搜索</a></li>
      <li><a href="#主机查找" id="markdown-toc-主机查找">主机查找</a></li>
      <li><a href="#扫描" id="markdown-toc-扫描">扫描</a></li>
      <li><a href="#实时数据流" id="markdown-toc-实时数据流">实时数据流</a></li>
      <li><a href="#网络提醒" id="markdown-toc-网络提醒">网络提醒</a>        <ul>
          <li><a href="#订阅" id="markdown-toc-订阅">订阅</a></li>
          <li><a href="#使用shodan命令行界面" id="markdown-toc-使用shodan命令行界面">使用Shodan命令行界面</a></li>
        </ul>
      </li>
      <li><a href="#例子-2" id="markdown-toc-例子-2">例子</a>        <ul>
          <li><a href="#常用-shodan-库函数" id="markdown-toc-常用-shodan-库函数">常用 Shodan 库函数</a></li>
          <li><a href="#例子基本的搜索" id="markdown-toc-例子基本的搜索">例子——基本的搜索</a></li>
          <li><a href="#例子使用facets收集概要信息" id="markdown-toc-例子使用facets收集概要信息">例子——使用Facets收集概要信息</a></li>
          <li><a href="#例子利用api编写gif图片" id="markdown-toc-例子利用api编写gif图片">例子——利用API编写GIF图片</a></li>
          <li><a href="#例子公开的mongodb数据" id="markdown-toc-例子公开的mongodb数据">*例子——公开的MongoDB数据</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#工业控制系统" id="markdown-toc-工业控制系统">工业控制系统</a>    <ul>
      <li><a href="#常用缩写" id="markdown-toc-常用缩写">常用缩写</a></li>
      <li><a href="#协议" id="markdown-toc-协议">协议</a>        <ul>
          <li><a href="#modbus" id="markdown-toc-modbus">Modbus</a></li>
          <li><a href="#profibus" id="markdown-toc-profibus">PROFIBUS</a></li>
          <li><a href="#dnp3" id="markdown-toc-dnp3">DNP3</a></li>
          <li><a href="#iccp" id="markdown-toc-iccp">ICCP</a></li>
          <li><a href="#opc" id="markdown-toc-opc">OPC</a></li>
          <li><a href="#bacnet" id="markdown-toc-bacnet">BACnet</a></li>
          <li><a href="#cip" id="markdown-toc-cip">CIP</a></li>
          <li><a href="#siemens-s7" id="markdown-toc-siemens-s7">Siemens S7</a></li>
          <li><a href="#其他工控协议" id="markdown-toc-其他工控协议">其他工控协议</a></li>
          <li><a href="#架构缺陷" id="markdown-toc-架构缺陷">架构缺陷</a></li>
          <li><a href="#工控系统的指纹识别技术" id="markdown-toc-工控系统的指纹识别技术">工控系统的指纹识别技术</a></li>
        </ul>
      </li>
      <li><a href="#信息探测" id="markdown-toc-信息探测">信息探测</a>        <ul>
          <li><a href="#ethernetip" id="markdown-toc-ethernetip">Ethernet/IP</a></li>
          <li><a href="#modbus-1" id="markdown-toc-modbus-1">Modbus</a></li>
          <li><a href="#iec-61870-5-101104" id="markdown-toc-iec-61870-5-101104">IEC 61870-5-101/104</a></li>
          <li><a href="#siemens-s7-1" id="markdown-toc-siemens-s7-1">Siemens S7</a></li>
          <li><a href="#tridium-niagara-fox" id="markdown-toc-tridium-niagara-fox">Tridium Niagara Fox</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#附录abanner格式" id="markdown-toc-附录abanner格式">附录A：Banner格式</a>    <ul>
      <li><a href="#常用属性" id="markdown-toc-常用属性">常用属性</a></li>
      <li><a href="#elastic属性" id="markdown-toc-elastic属性">Elastic属性</a></li>
      <li><a href="#https属性" id="markdown-toc-https属性">HTTP(S)属性</a></li>
      <li><a href="#位置属性" id="markdown-toc-位置属性">位置属性</a></li>
      <li><a href="#smb属性" id="markdown-toc-smb属性">SMB属性</a></li>
      <li><a href="#ssh属性" id="markdown-toc-ssh属性">SSH属性</a></li>
      <li><a href="#ssl-属性" id="markdown-toc-ssl-属性">SSL 属性</a></li>
      <li><a href="#isakmp属性" id="markdown-toc-isakmp属性">ISAKMP属性</a></li>
      <li><a href="#特殊属性" id="markdown-toc-特殊属性">特殊属性</a>        <ul>
          <li><a href="#_shodan" id="markdown-toc-_shodan">_shodan</a></li>
        </ul>
      </li>
      <li><a href="#例子-3" id="markdown-toc-例子-3">例子</a></li>
    </ul>
  </li>
  <li><a href="#附录b搜索语法关键词列表" id="markdown-toc-附录b搜索语法关键词列表">附录B：搜索语法关键词列表</a>    <ul>
      <li><a href="#常用语法" id="markdown-toc-常用语法">常用语法</a>        <ul>
          <li><a href="#http过滤器" id="markdown-toc-http过滤器">HTTP过滤器</a></li>
          <li><a href="#ntp-过滤器" id="markdown-toc-ntp-过滤器">NTP 过滤器</a></li>
          <li><a href="#ssl过滤器" id="markdown-toc-ssl过滤器">SSL过滤器</a></li>
          <li><a href="#telnet-过滤器" id="markdown-toc-telnet-过滤器">Telnet 过滤器</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#附录cfacets搜索" id="markdown-toc-附录cfacets搜索">附录C：Facets搜索</a>    <ul>
      <li><a href="#常用facets" id="markdown-toc-常用facets">常用Facets</a></li>
      <li><a href="#http-facets" id="markdown-toc-http-facets">HTTP Facets</a></li>
      <li><a href="#ntp-facets" id="markdown-toc-ntp-facets">NTP Facets</a></li>
      <li><a href="#ssh-facets" id="markdown-toc-ssh-facets">SSH Facets</a></li>
      <li><a href="#ssl-facets" id="markdown-toc-ssl-facets">SSL Facets</a></li>
      <li><a href="#telnet-facets" id="markdown-toc-telnet-facets">Telnet Facets</a></li>
    </ul>
  </li>
  <li><a href="#附录d端口列表" id="markdown-toc-附录d端口列表">附录D：端口列表</a></li>
  <li><a href="#附录e-ssl-banner示例" id="markdown-toc-附录e-ssl-banner示例">附录E: SSL banner示例</a></li>
  <li><a href="#refer" id="markdown-toc-refer">Refer</a></li>
</ul>

<p>现由<a href="http://ph0rse.me/">ph0rse</a>和Jirairya共同修订，欢迎大家issue</p>
<blockquote>
  <p>**_PS:本来本文投稿于<a href="http://www.myh0st.cn/">信安之路</a>（http://mp.weixin.qq.com/s/SVl_YLhcfNgHya6jEnKx1g）的， 后@<a href="http://ph0rse.me/">ph0rse</a>建议放于gitbook上，方便大家在线查阅、共同维护，就有了<a href="https://b404.gitbooks.io/shodan-manual/content/">gitbook版本</a> （https://b404.gitbooks.io/shodan-manual/content/）</p>
</blockquote>

<!--more-->

<h2 id="前言">前言</h2>

<p>本文主要对<a href="https://leanpub.com/shodan">Complete Guide to Shodan</a>（https://leanpub.com/shodan）的内容进行增、删、改，虽篇幅较长，但内容涉及了Shodan的搜索语法、客户端命令行、API编程、工具插件、工控等，较为详细，适合当作Shodan手册。代码和搜索示例均已亲自测试并附截图。</p>

<p>若内容有错误或者不恰当的地方，望大佬指出，谢谢。</p>

<h2 id="介绍">介绍</h2>

<p><a href="https://www.shodan.io">Shodan</a>是一个搜索互联网连接设备的搜索引擎，不同于谷歌、必应、百度这些搜索引擎。用户可以在Shodan上使用Shodan搜索语法查找连接到互联网的摄像头、路由器、服务器等设备信息。在渗透测试中，是个很不错的神器。</p>

<p>Shodan的搜索流程：</p>

<p><img src="/img/shodan/1517795894244.png" alt="Alt text" /></p>

<h3 id="关于数据">关于数据</h3>

<h4 id="banner">Banner</h4>

<p>Shodan采集的基本数据单位是banner。banner是描述设备所运行服务的标志性文本信息。对于Web服务器来说，其将返回标题或者是telnet登陆界面。Banner的内容因服务类型的不同而相异。</p>

<p>以下这是一个典型的HTTP Banner：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="nx">OK</span>
<span class="nx">Server</span><span class="p">:</span> <span class="nx">nginx</span><span class="o">/</span><span class="mf">1.1</span><span class="p">.</span><span class="mi">19</span>
<span class="nb">Date</span><span class="p">:</span> <span class="nx">Sat</span><span class="p">,</span> <span class="mi">03</span> <span class="nx">Oct</span> <span class="mi">2015</span> <span class="mi">06</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">24</span> <span class="nx">GMT</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="p">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span> <span class="nx">charset</span><span class="o">=</span><span class="nx">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="p">:</span> <span class="mi">6466</span>
<span class="nx">Connection</span><span class="p">:</span> <span class="nx">keep</span><span class="o">-</span><span class="nx">alive</span>
</code></pre></div></div>

<blockquote>
  <p>上面的banner显示该设备正在运行一个<code class="highlighter-rouge">1.1.19</code>版本的nginx Web服务器软件</p>
</blockquote>

<p>下面是西门子S7工控系统协议的一个banner，这次返回的banner完全不同，提供了大量的详细数据(有关的固件信息、序列号):</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Copyright</span><span class="p">:</span> <span class="nx">Original</span> <span class="nx">Siemens</span> <span class="nx">Equipment</span>
<span class="nx">PLC</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">S7_Turbine</span>
<span class="nx">Module</span> <span class="nx">type</span><span class="p">:</span> <span class="nx">CPU</span> <span class="mi">313</span><span class="nx">C</span>
<span class="nx">Unknown</span> <span class="p">(</span><span class="mi">129</span><span class="p">):</span> <span class="nx">Boot</span> <span class="nx">Loader</span>           <span class="nx">A</span>
<span class="nx">Module</span><span class="p">:</span> <span class="mi">6</span><span class="nx">ES7</span> <span class="mi">313</span><span class="o">-</span><span class="mi">5</span><span class="nx">BG04</span><span class="o">-</span><span class="mi">0</span><span class="nx">AB0</span>  <span class="nx">v</span><span class="p">.</span><span class="mf">0.3</span>
<span class="nx">Basic</span> <span class="nx">Firmware</span><span class="p">:</span> <span class="nx">v</span><span class="p">.</span><span class="mf">3.3</span><span class="p">.</span><span class="mi">8</span>
<span class="nx">Module</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">CPU</span> <span class="mi">313</span><span class="nx">C</span>
<span class="nx">Serial</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">module</span><span class="p">:</span> <span class="nx">S</span> <span class="nx">Q</span><span class="o">-</span><span class="nx">D9U083642013</span>
<span class="nx">Plant</span> <span class="nx">identification</span><span class="p">:</span> 
<span class="nx">Basic</span> <span class="nx">Hardware</span><span class="p">:</span> <span class="mi">6</span><span class="nx">ES7</span> <span class="mi">313</span><span class="o">-</span><span class="mi">5</span><span class="nx">BG04</span><span class="o">-</span><span class="mi">0</span><span class="nx">AB0</span>  <span class="nx">v</span><span class="p">.</span><span class="mf">0.3</span>
</code></pre></div></div>

<blockquote>
  <p>注：Shodan搜索的是联网设备运行服务的banner，不是单一的主机信息。如果单个IP暴露很多服务信息，在指定特定搜索内容的时候，搜索结果只会出现指定的内容，不会显示其他的服务信息。</p>
</blockquote>

<h4 id="设备元数据">设备元数据</h4>

<p>除了获取banner，Shodan还可以获取相关设备的元数据，例如地理位置、主机名、操作系统等信息。大部分元数据可以通过Shodan的官网获取，小部分的可以通过使用API编程获取。</p>

<h4 id="ipv6">IPv6</h4>

<p>据统计，截至2015年10月，Shodan每月收集数百万条关于IPv6设备的可用数据。不过与收集的数亿个IPv4 banner相比，这些数字还是苍白。预计在未来几年会有所增长。</p>

<h3 id="数据采集">数据采集</h3>

<h4 id="频率">频率</h4>

<p>Shodan的爬虫全天候工作，并实时更新数据库。在任何时候使用Shodan查询，都可以获得最新的结果。</p>

<h4 id="分布式">分布式</h4>

<p>爬虫分布于世界各地，包括：</p>

<ul>
  <li>美国（东海岸和西海岸）</li>
  <li>中国</li>
  <li>冰岛</li>
  <li>法国</li>
  <li>台湾</li>
  <li>越南</li>
  <li>罗马尼亚</li>
  <li>捷克共和国</li>
</ul>

<p>从世界各地收集数据是为了防止地区各种因素的差异造成数据的偏差。例如，美国的许多系统管理员会封锁整个中国的IP范围，分布在世界各地的Shodan爬虫就可以确保任何全国性的封锁不会影响数据收集。</p>

<h4 id="随机">随机</h4>

<p>Shodan爬虫的基本算法是：</p>

<ol>
  <li>生成一个随机的IPv4地址</li>
  <li>从Shodan能解析的端口列表中生成一个随机端口测试</li>
  <li>检测随机端口上的随机IPv4地址，并获取Banner</li>
  <li>继续步骤1</li>
</ol>

<p>这意味着爬行器不扫描增量的网络范围。爬行是完全随机的，以确保在任何给定的时间内对因特网进行统一的覆盖，并防止数据的偏差。</p>

<h3 id="深入ssl">深入SSL</h3>

<p>SSL正在成为互联网上重要的服务，Shodan也随之扩展性地收集其banner，包括收集每个SSL的功能服务及其漏洞信息，比如HTTPS，不仅仅是SSL证书。</p>

<h4 id="漏洞测试">漏洞测试</h4>

<h5 id="心脏出血漏洞">心脏出血漏洞</h5>

<p>如果某服务有心脏滴血漏洞，返回的banner将包含以下2个附加属性。
<strong>opts.heartbleed</strong>包含了对服务进行心脏出血漏洞测试的原始回应（在测试中，爬虫只抓取少量溢出来确认服务是否受到心脏出血的影响，不会获取泄露的私钥）。若设备容易受到攻击，爬虫会将<code class="highlighter-rouge">CVE-2014-0160</code>添加到<strong>opts.vulns</strong>列表中；若不易受到攻击，则会返回<code class="highlighter-rouge">!CVE-2014-0160</code>：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"opts"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"heartbleed"</span><span class="p">:</span> <span class="s2">"... 174.142.92.126:8443 - VULNERABLE</span><span class="err">\</span><span class="s2">n"</span><span class="p">,</span>
        <span class="s2">"vulns"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"CVE-2014-0160"</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Shodan也支持漏洞信息搜索。比如，要搜索美国受心脏滴血漏洞影响可在<a href="https://www.shodan.io">shodan</a>输入<code class="highlighter-rouge">country:US vuln:CVE-2014-0160</code></p>

<p><img src="/img/shodan/1517293780813.png" alt="Alt text" /></p>

<h5 id="freak">FREAK</h5>

<p>如果服务支持导出密码，则爬虫程序就将“CVE-2015-0204”项添加到<code class="highlighter-rouge">opts.vulns</code>属性</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"opts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="s2">"vulns"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"CVE-2015-0204"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h5 id="logjam">Logjam</h5>

<p>爬虫将短暂使用Diffie-Hellman密码连接到SSL服务，若连接成功就存储返回以下信息：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"dhparams"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"prime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bbbc2dcad84674907c43fcf580e9..."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"public_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49858e1f32aefe4af39b28f51c..."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
    </span><span class="s2">"generator"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nginx/Hardcoded 1024-bit prime"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h5 id="版本">版本</h5>

<p>通常情况下，当浏览器连接到SSL服务时，它将协商应该与服务器一起使用的SSL版本和密码。然后，他们会就某个SSL版本（如TLSv1.2）达成一致，然后将其用于通信。</p>

<p>Shodan 爬虫开始按照上面所述的正常请求，与服务器进行协商连接SSL。但是，之后，他们还显式地尝试使用其他的SSL版本连接到服务器。换句话说，爬行器尝试使用SSLv2、SSLV3、TLSv1.0、TLSv1.1和TLSv1.2连接到服务器，来确定该SSL服务支持的所有版本。</p>

<p>收集到的信息将在<code class="highlighter-rouge">ssl.versions </code>版本字段中显示：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"ssl"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"versions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"TLSv1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SSLv3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-SSLv2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-TLSv1.1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-TLSv1.2"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>如果在版本前面有一个<code class="highlighter-rouge">-</code>符号，那么该设备不支持SSL版本。如果版本不以<code class="highlighter-rouge">-</code>开头，则服务支持给定的SSL版本。例如，上面的服务器支持:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">TLSv</span><span class="mi">1</span><span class="w">
</span><span class="err">SSLv</span><span class="mi">3</span><span class="w">
</span></code></pre></div></div>

<p>不支持版本：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">SSLv</span><span class="mi">2</span><span class="w">
</span><span class="err">TLSv</span><span class="mf">1.1</span><span class="w">
</span><span class="err">TLSv</span><span class="mf">1.2</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>TLS 1.0通常被标示为SSL 3.1，TLS 1.1为SSL 3.2，TLS 1.2为SSL 3.3。见<a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A">传输层安全性协议</a></p>
</blockquote>

<p>版本信息可以通过shodan的网站或者API搜索。例如，输入<code class="highlighter-rouge">ssl.version:sslv2</code>搜索查询将返回允许使用SSLv2的所有SSL服务(包括HTTP、SMTP、HTTP、POP3、IMAP等)</p>

<p><img src="/img/shodan/1517296483629.png" alt="Alt text" /></p>

<h5 id="遵循链">遵循链</h5>

<p>证书链是从root到最终用户的SSL 证书列表；SSL的banner服务包括一个<code class="highlighter-rouge">ssl.chain</code>属性，该属性包含PEM序列化证书中链的所有SSL证书。</p>

<h3 id="基础之上">基础之上</h3>

<p>对于大多数服务，爬虫试图分析主要的banner文本，并解析出有用的信息。不过有些情况是，抓取MongoDB的集合名称，从远程桌面服务获取屏幕截图，存储比特币的对等点列表。有两种Shodan使用的高级数据分析技术，我想强调一下：</p>

<p><img src="/img/shodan/1517298089142.png" alt="Alt text" /></p>

<h4 id="web组件">Web组件</h4>

<p>爬虫也会尝试确定创建网站的Web技术。对于http和https模块，将分析header和HTML来分解网站的组件。结果信息存储在<code class="highlighter-rouge">http.components</code>属性中。该属性是一个技术字典，关键是技术的名称（例如jQuery），值是另一个具有类别属性的字典。categories属性是与技术相关的类别列表。例如</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"http"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
        </span><span class="s2">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"jQuery"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"javascript-frameworks"</span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"Drupal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"cms"</span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"PHP"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"programming-languages"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
             </span><span class="err">...</span><span class="w">
    </span><span class="p">},</span><span class="w">
</span></code></pre></div></div>

<p><code class="highlighter-rouge">http.components</code>表明该网站在运行<code class="highlighter-rouge">Drupal</code>内容管理系统，该系统本身使用的<code class="highlighter-rouge">jQuery</code>和<code class="highlighter-rouge">PHP</code>。
<code class="highlighter-rouge">Shodan REST API</code>使信息通过过滤器http.component和2个方面（http.componen和http.component_category）进行搜索。要获得所有可能的组件/类别值的完整列表，请使用新的方面。例如，要获得所有可能类别的完整列表，请使用以下shodan命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> http.component_category:1000 http
</code></pre></div></div>
<p><img src="/img/shodan/1517299854335.png" alt="Alt text" /></p>

<h4 id="级联">级联</h4>

<p>如果一个banner返回了关于对等点的信息，或者有关于另一个运行服务的IP地址的信息，那么爬虫就会试图在这个IP/服务上执行一个banner抓取。例如: 主线DHT（过去用于Bittorrent）的默认端口是6881。这样一个DHT节点的banner看起来如下:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DHT Nodes
97.94.250.250	58431
150.77.37.22	34149
113.181.97.227	63579
252.246.184.180	36408
83.145.107.53	52158
77.232.167.126	52716
25.89.240.146	27179
147.23.120.228	50074
85.58.200.213	27422
180.214.174.82	36937
241.241.187.233	60339
166.219.60.135	3297
149.56.67.21	13735
107.55.196.179	8748
</code></pre></div></div>

<p>以前，抓取工具会抓取上面的banner，然后继续抓取。现通过为DHT banner的抓取启用级联功能，抓取工具现在可以为所有的对等启动新的banner抓取请求。在上面的示例中，搜寻器将使用DHT banner捕获器，在IP为<code class="highlighter-rouge">97.94.250.250</code>的58431端口上启动扫描<code class="highlighter-rouge">150.77.37.22</code>,继续在端口34149上启动扫描，依此类推。
也就是说，如果初始扫描数据包含有关其他潜在主机的信息，对IP的单次扫描可能会导致级联扫描。</p>

<p>为了跟踪初始扫描请求与任何子级/级联请求之间的关系，我们引入了2个新属性：</p>

<ul>
  <li><strong>_shodan.id</strong>：banner的唯一ID。如果可以从服务启动级联请求，这个属性就一定存在，但这并不一定意味着级联请求会成功。</li>
  <li><strong>_shodan.options.referrer</strong>：提供触发创建当前banner的banner的唯一ID。即引用者是当前banner的父代。</li>
</ul>

<h2 id="web界面">Web界面</h2>

<p>访问Shodan收集的数据最简单的方法是通过Web界面。所有的人都可以输入一个需要查询的设备。</p>

<h3 id="搜索查询说明">搜索查询说明</h3>

<p>默认情况下，搜索查询仅查看主横幅文本，不搜索元数据。例如，如果您要搜索“Google”，那么搜索结果将只包含标题中显示“Google”文本的结果; 它不一定会返回Google网络范围的结果。</p>

<p><img src="/img/shodan/1517301871310.png" alt="Alt text" /></p>

<p>如上所述，搜索“谷歌”返回许多组织购买并连接到Internet的谷歌搜索设备;它不返回谷歌的服务器。</p>

<p>Shodan将尝试找到匹配所有搜索项的结果，这意味着隐含地在每个搜索项之间存在<code class="highlighter-rouge">+</code>或<code class="highlighter-rouge">AND</code>连接符号。例如，搜索查询“apache + 1.3”相当于“apache 1.3”</p>

<p>要搜索特定的元数据需要使用搜索过滤器。</p>

<h3 id="过滤器">过滤器</h3>

<p>过滤器是Shodan用来根据服务或设备的元数据缩小搜索结果的特殊关键字。输入过滤器的格式是：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">filtername</span><span class="p">:</span><span class="nx">value</span>
</code></pre></div></div>

<blockquote>
  <p><strong>注意 <code class="highlighter-rouge">:</code>和值之间没有空格</strong></p>
</blockquote>

<p>要使用包含过滤器空间的值，必须将值包含在双引号中。例如搜索圣地亚哥的所有联网设备：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">city</span><span class="p">:</span><span class="s2">"San Diego"</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517303846916.png" alt="Alt text" /></p>

<p>筛选多个值可以使用<code class="highlighter-rouge">,</code>分开。比如要查找23号端口和1023号端口上运行telnet 的设备:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">1023</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517360821230.png" alt="Alt text" /></p>

<p>如果过滤语法不允许使用逗号(如<code class="highlighter-rouge">port,hostname,net</code>)，那么可以使用多个值联合查询：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">80</span><span class="p">,</span><span class="mi">8080</span>  <span class="nx">city</span><span class="p">:</span><span class="s2">"beijing"</span> <span class="nx">hostname</span><span class="p">:</span><span class="s2">"baidu.com"</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517361411351.png" alt="Alt text" /></p>

<p>当然也可以使用<code class="highlighter-rouge">-</code>排除结果。比如：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">1023</span>  <span class="o">-</span><span class="nx">city</span><span class="p">:</span><span class="s2">"San Diego"</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517361748328.png" alt="Alt text" /></p>

<p>有时候也需要过滤一些主文本标题为空的搜索结果，这时候就需要使用<code class="highlighter-rouge">-hash:0</code>。比如：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">8080</span> <span class="o">-</span><span class="nx">hash</span><span class="p">:</span><span class="mi">0</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517362504823.png" alt="Alt text" /></p>

<p>Shodan上的每个banner都有一个哈希值，对于空的banner，hash值就为0。若尝试搜索简短的、静态的banner，使用哈希过滤语法就比较便捷。</p>

<p>shodan支持大量的过滤器，比较常用的是：</p>

<table>
  <thead>
    <tr>
      <th>过滤器名</th>
      <th>描述</th>
      <th>举例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>category</td>
      <td>现有的分类：ics, malware</td>
      <td><code class="highlighter-rouge">category:"malware"</code></td>
    </tr>
    <tr>
      <td>city</td>
      <td>城市的名字</td>
      <td><code class="highlighter-rouge">city:"San Diego"</code></td>
    </tr>
    <tr>
      <td>country</td>
      <td>国家简写</td>
      <td><code class="highlighter-rouge">country:"ES"</code> <code class="highlighter-rouge">country:"CN"</code></td>
    </tr>
    <tr>
      <td>net</td>
      <td>CIDR格式的IP地址</td>
      <td><code class="highlighter-rouge">net:190.30.40.0/24</code></td>
    </tr>
    <tr>
      <td>hostname</td>
      <td>主机名或域名</td>
      <td><code class="highlighter-rouge">hostname:"google"</code></td>
    </tr>
    <tr>
      <td>port</td>
      <td>端口号</td>
      <td><code class="highlighter-rouge">port:21</code></td>
    </tr>
    <tr>
      <td>org</td>
      <td>组织或公司</td>
      <td><code class="highlighter-rouge">org:"google"</code></td>
    </tr>
    <tr>
      <td>isp</td>
      <td>ISP供应商</td>
      <td><code class="highlighter-rouge">isp:"China Telecom"</code></td>
    </tr>
    <tr>
      <td>product</td>
      <td>软件、平台</td>
      <td><code class="highlighter-rouge">product:"Apache httpd"</code> <code class="highlighter-rouge">product:"openssh"</code></td>
    </tr>
    <tr>
      <td>os</td>
      <td>操作系统</td>
      <td><code class="highlighter-rouge">os:"Windows 7 or 8"</code></td>
    </tr>
    <tr>
      <td>version</td>
      <td>软件版本</td>
      <td><code class="highlighter-rouge">version:"2.6.1"</code></td>
    </tr>
    <tr>
      <td>geo</td>
      <td>经纬度</td>
      <td><code class="highlighter-rouge">geo:"46.9481,7.4474"</code></td>
    </tr>
  </tbody>
</table>

<p><em>可参见附录B</em></p>

<h3 id="搜索引擎">搜索引擎</h3>

<p><img src="/img/shodan/1517365516965.png" alt="Alt text" /></p>

<p>默认情况下，搜索查询将查看过去30天内收集的数据。</p>

<h4 id="下载数据">下载数据</h4>

<p>完成搜索后，顶部将出现一个名为“ 下载数据”的按钮。点击该按钮将为您提供以JSON，CSV(XML已经弃用)格式下载搜索结果的选项.</p>

<p><img src="/img/shodan/1517365559748.png" alt="Alt text" /></p>

<p>JSON格式的文件，其中每行包括全部的banner和所有附带的元数据收集信息。这是保存所有可用信息的首选格式。格式与Shodan命令行客户端兼容，这意味着可以从Shodan网站下载数据，然后使用终端进一步处理。</p>

<p>CSV格式的文件，返回包含IP、端口，banner，组织和主机名内容。它不包含由于CSV文件格式的限制收集的所有Shodan信息。如果只关心结果的基本信息，并希望快速将其加载到外部工具（如Excel）中，可以使用此方法。</p>

<p>下载数据会消耗积分，积分需要在网站上购买。积分与Shodan API没有任何关联，并且不会每月自动更新。1积分可用于下载10000个结果。</p>

<h4 id="生成报告">生成报告</h4>

<p>Shodan可让根据搜索查询生成报告。该报告包含图表，可以全面了解互联网上的分发结果。这个功能是免费的，任何人都可以使用。</p>

<h4 id="分享结果">分享结果</h4>

<p>搜索完成之后，可以自定义，分享内容给其他Shodan用户。</p>

<p><img src="/img/shodan/1517365655467.png" alt="Alt text" /></p>

<blockquote>
  <p>共享搜索查询是公开查看的</p>
</blockquote>

<h3 id="例子">例子</h3>

<p><strong>搜索美国 的服务器在8080端口上运行8.0版本IIS服务的服务器：</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">8080</span> <span class="nx">product</span><span class="p">:</span><span class="s2">"Microsoft-IIS"</span> <span class="nx">country</span><span class="p">:</span><span class="s2">"US"</span> <span class="nx">version</span><span class="p">:</span><span class="s2">"8.0"</span>
</code></pre></div></div>
<p><img src="/img/shodan/1517815120023.png" alt="Alt text" /></p>

<p><strong>搜索可能受到DOUBLEPULSAR攻击的机器：</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">port</span><span class="p">:</span><span class="mi">445</span> <span class="s2">"SMB Version: 1"</span> <span class="nx">os</span><span class="p">:</span><span class="nx">Windows</span> <span class="o">!</span><span class="nx">product</span><span class="p">:</span><span class="nx">Samba</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517815308110.png" alt="Alt text" /></p>

<p><strong>搜索所有<code class="highlighter-rouge">nist.gov</code>域名里的apache服务:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">apache</span> <span class="nx">hostname</span><span class="p">:.</span><span class="nx">nist</span><span class="p">.</span><span class="nx">gov</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517823589050.png" alt="Alt text" /></p>

<h3 id="shodan地图">Shodan地图</h3>

<p>https://maps.shodan.io/</p>

<p>直观的地图界面,显示搜索的结果</p>

<p><img src="/img/shodan/1517366645440.png" alt="Alt text" /></p>

<p>使用<img src="/img/shodan/1517366962856.png" alt="Alt text" />可改变显示风格，有卫星、街景选项。</p>

<h3 id="shodan-exploits">Shodan Exploits</h3>

<p>https://exploits.shodan.io</p>

<p>Shodan Exploits收集来自CVE，Exploit DB和Metasploit的漏洞和攻击，使其可通过Web界面进行搜索。</p>

<p><img src="/img/shodan/1517367125715.png" alt="Alt text" /></p>

<p>Shodan Exploit搜索的结果不同于Shodan，Exploit搜索的内容包括exploit的信息和元数据。</p>

<table>
  <thead>
    <tr>
      <th>名称</th>
      <th>描述</th>
      <th>举例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>author</td>
      <td>漏洞或exploit的作者</td>
      <td><code class="highlighter-rouge">author:"Tom Ferris"</code></td>
    </tr>
    <tr>
      <td>description</td>
      <td>描述</td>
      <td><code class="highlighter-rouge">description:"remote"</code></td>
    </tr>
    <tr>
      <td>platform</td>
      <td>平台</td>
      <td><code class="highlighter-rouge">platform:"php"</code> <code class="highlighter-rouge">platform:"windows"</code> <code class="highlighter-rouge">platform:"Linux"</code></td>
    </tr>
    <tr>
      <td>type</td>
      <td>漏洞类型</td>
      <td><code class="highlighter-rouge">type:"remote"</code> <code class="highlighter-rouge">type:"dos"</code></td>
    </tr>
  </tbody>
</table>

<h3 id="shodan-images">Shodan Images</h3>

<p>https://images.shodan.io</p>

<p>顶部的搜索框使用与Shodan主搜索引擎相同的语法。使用搜索框按组织或网点筛选最有用。但是，它也可以用于过滤显示的图像类型。</p>

<p><img src="/img/shodan/1517367993553.png" alt="Alt text" /></p>

<p>图像数据主要来自：</p>

<ul>
  <li>VNC</li>
  <li>Remote Desktop (RDP)</li>
  <li>RTSP</li>
  <li>Webcams</li>
  <li>X Windows</li>
</ul>

<p>每个图像源来自不同的端口/服务，因此具有不同的banner。如果只想看到来自摄像头的图像，你可以搜索：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">HTTP</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517368351206.png" alt="Alt text" /></p>

<blockquote>
  <p>查找<code class="highlighter-rouge">VNC</code>可以输入<code class="highlighter-rouge">RFB</code>，查找<code class="highlighter-rouge">RTSP</code>可以使用<code class="highlighter-rouge">RTSP</code></p>
</blockquote>

<p>如果在<a href="https://www.shodan.io">Shodan</a>中搜索截图，可以使用<code class="highlighter-rouge">has_screenshot:true</code>：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">has_screenshot</span><span class="p">:</span><span class="kc">true</span> <span class="nx">country</span><span class="p">:</span><span class="s2">"KR"</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517368614134.png" alt="Alt text" /></p>

<p><img src="/img/shodan/1517368596925.png" alt="Alt text" /></p>

<h3 id="共享的shodan搜索语法">共享的Shodan搜索语法</h3>

<p>链接见https://www.shodan.io/explore</p>

<p><img src="/img/shodan/1517815542618.png" alt="Alt text" /></p>

<h2 id="关于shodan的外部工具">关于Shodan的外部工具</h2>

<h3 id="shodan命令行界面">Shodan命令行界面</h3>

<p>安装最新的Shodan可以通过</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>easy_install shodan
</code></pre></div></div>

<p>安装该工具之后，使用API对其进行初始化操作：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan init API_KEY
</code></pre></div></div>

<p><img src="/img/shodan/1517369431079.png" alt="Alt text" /></p>

<h4 id="alert命令">alert命令</h4>

<p>alert命令提供创建、列表、清除和删除网络提醒的能力。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan alert
</code></pre></div></div>

<p><img src="/img/shodan/1517369532577.png" alt="Alt text" /></p>

<h4 id="convert命令">convert命令</h4>

<p>convert命令是导出Shodan的搜索结果文件，比如JSON文件。</p>

<h4 id="count命令">count命令</h4>

<p>统计查询结果</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan count microsoft iis 6.0
</code></pre></div></div>

<p><img src="/img/shodan/1517378957224.png" alt="Alt text" /></p>

<h4 id="download命令">download命令</h4>

<p>搜索Shodan并将结果导出到JSON文件中（请参阅附录A）。</p>

<p>默认情况下，只下载1000个结果.如果想导出更多的结果，加上<code class="highlighter-rouge">--limit</code>标志。</p>

<p>download命令可以保存搜索结果到本地，随时使用<code class="highlighter-rouge">parse</code>命令处理结果，当再次导出相同搜索内容的时候，就不必再花费积分导出。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan download  microsoft iis 6.0
</code></pre></div></div>

<p><img src="/img/shodan/1517379702688.png" alt="Alt text" /></p>

<h4 id="host命令">host命令</h4>

<p>查看有关主机的信息，例如它位于何处，哪些端口是开放的以及哪个组织拥有其IP。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan host 189.201.128.250
</code></pre></div></div>

<p><img src="/img/shodan/1517379850752.png" alt="Alt text" /></p>

<h4 id="honeyscore命令">honeyscore命令</h4>

<p>检查IP地址是否是蜜罐。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan honeyscore 41.231.95.212
</code></pre></div></div>

<p><img src="/img/shodan/1517379975971.png" alt="Alt text" /></p>

<h4 id="info命令">info命令</h4>

<p>查询自己的API账户信息，包括本月剩余的查询次数和扫描积分数量。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan info
</code></pre></div></div>

<p><img src="/img/shodan/1517380040916.png" alt="Alt text" /></p>

<h4 id="myip命令">myip命令</h4>

<p>返回本机的出口IP（类似于<code class="highlighter-rouge">curl ip.cn</code>）</p>

<p><img src="/img/shodan/1517380251699.png" alt="Alt text" /></p>

<p><img src="/img/shodan/1517380533585.png" alt="Alt text" /></p>

<h4 id="parse命令">parse命令</h4>

<p>使用<code class="highlighter-rouge">parse</code>来分析使用导出的搜索结果。它可以让过滤出感兴趣的字段，也可以将JSON转换为CSV。这样，对于导入到其他脚本比较友好。</p>

<p>以下命令输出之前下载的Microsoft-IIS数据，并且将JSON文件转换为的CSV格式的文件。其中包括IP地址，端口和归属组织：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan parse <span class="nt">--fields</span> ip_str,port,org <span class="nt">--separator</span> , microsoft-data.json.gz
</code></pre></div></div>

<p><img src="/img/shodan/1517381072881.png" alt="Alt text" /></p>

<h4 id="scan命令">scan命令</h4>

<p><code class="highlighter-rouge">scan</code>命令提供了一些子命令。最重要的一个是<code class="highlighter-rouge">submit</code>命令，这个命令可以使用shodan执行网络扫描。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan scan submit 198.20.99.0/24
</code></pre></div></div>

<blockquote>
  <p>默认情况下，它将显示IP，端口，主机名和数据。您可以使用<code class="highlighter-rouge">--fields</code>来打印感兴趣的任何banner字段。</p>
</blockquote>

<p><img src="/img/shodan/1517382144428.png" alt="Alt text" /></p>

<h4 id="search命令">search命令</h4>

<p><code class="highlighter-rouge">search</code>命令搜索时候，终端将以友好的方式显示结果。默认情况下，它将显示IP，端口，主机名和数据。不过可以使用<code class="highlighter-rouge">--fields 参数</code>来打印感兴趣的任何banner字段。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan search <span class="nt">--fields</span> ip_str，port，org，hostnames microsoft iis 6.0
</code></pre></div></div>

<p><img src="/img/shodan/1517382536055.png" alt="Alt text" /></p>

<h4 id="stats命令">stats命令</h4>

<p>提供关于搜索的摘要信息，当然可以用于统计信息。
命令显示了Apache Web服务器所在的最常用的国家：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> country apache
</code></pre></div></div>

<p><img src="/img/shodan/1517382718966.png" alt="Alt text" /></p>

<h4 id="stream命令">stream命令</h4>

<p><code class="highlighter-rouge">stream</code>命令提供对Shodan爬虫收集的实时数据流的访问。</p>

<p><img src="/img/shodan/1517382980293.png" alt="Alt text" /></p>

<p>该命令支持许多不同的选项，但有2个是重要的提及：</p>

<ul>
  <li><code class="highlighter-rouge">--datadir</code>:可以指定流数据存储的目录，生成的文件格式<code class="highlighter-rouge">YYYY-MM-DD.json.gz</code>。每天只要保持数据流运行，就会生成一个新的文件。
    <ul>
      <li>例如：从实时数据流保存数据到指定路径，可以使用<code class="highlighter-rouge">shodan stream --datadir /var/lib/shodan/</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">--limit</code>：指定应下载多少结果。默认情况下，该<code class="highlighter-rouge">stream</code>命令将一直运行，直到退出该工具。但是，如果只想收集数据样本，那么<code class="highlighter-rouge">--limit</code>参数可确保收集少量记录。
    <ul>
      <li>例如：<code class="highlighter-rouge">shodan stream --limit 100</code>可以连接到Shodan实时流，打印出前100条记录，然后退出</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">--ports</code>:接受逗号分隔端口，收集指定端口记录的清单
    <ul>
      <li>例如：<code class="highlighter-rouge">shodan stream --ports 80,8080</code></li>
    </ul>
  </li>
</ul>

<h3 id="例子-1">例子</h3>

<h4 id="官方例子">官方例子</h4>

<p>官方例子见  <a href="https://asciinema.org/~Shodan">28 public asciicasts by Shodan</a>：https://asciinema.org/~Shodan</p>

<p><img src="/img/shodan/1517883511076.png" alt="Alt text" /></p>

<h4 id="网络分析例子">网络分析例子</h4>

<p>Shodan最常见的使用案例是使用它来更好地了解公共网络范围内的运行情况。Shodan命令行工具可以快速帮助、处理你的目标。例如，查看<code class="highlighter-rouge">78.13.0.0/16</code>段在网上暴露了多少服务。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan count net:78.13/16
</code></pre></div></div>

<p><img src="/img/shodan/1517384046261.png" alt="Alt text" /></p>

<p><code class="highlighter-rouge">count</code>命令提供了关于<code class="highlighter-rouge">78.13.0.0/16</code>段暴露了4960个服务</p>

<p>统计出该网段暴露的最多端口数的top10：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> port net:78.13/16
</code></pre></div></div>

<p><img src="/img/shodan/1517384203836.png" alt="Alt text" /></p>

<p>有时候也需要详尽的端口暴露数分配报告，因此指定最大的端口，返回此端口范围的暴露数统计情况：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> port:100000 net:78.13/16
</code></pre></div></div>

<p><img src="/img/shodan/1517384538705.png" alt="Alt text" /></p>

<p>该网络上有955个端口被发现暴露，并统计出各自端口暴露数。最多的是<code class="highlighter-rouge">7547</code>端口，这个端口是调制解调器的端口，这个端口也有很多的<a href="https://pastebin.com/eZrrLGzv">安全问题可以关注</a>。在统计中也有一些非常见的标准端口，这些端口大多是为了掩盖自己真实的Web服务。</p>

<p>统计该网段的80、443端口上的服务情况：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> product <span class="s2">"HTTP net:78.13/16 -port:80,443"</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517385442321.png" alt="Alt text" /></p>

<blockquote>
  <p>这里应将端口号放在引号中，防止bash认为该port是shodan的命令参数。</p>
</blockquote>

<h4 id="分析ssl的例子">分析SSL的例子</h4>

<p>若要了解整个网络的SSL使用情况，可按照以下来查询</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan stats <span class="nt">--facets</span> ssl.version HTTP net:78.13/16
</code></pre></div></div>

<p><img src="/img/shodan/1517385675772.png" alt="Alt text" /></p>

<p>可以看出大多运行的是TLS1.0及其以上的版本，不过还有一些古老的设备在使用sslv2。</p>

<p>在web端的shodan搜索出来：</p>

<p><img src="/img/shodan/1517386029123.png" alt="Alt text" /></p>

<h4 id="分析telnet情况">分析telnet情况</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir telnet-data

shodan stream <span class="nt">--ports</span> 23,1023,2323 <span class="nt">--datadir</span> telnet-data / <span class="nt">--limit</span> 10000
</code></pre></div></div>

<blockquote>
  <p>创建一个名为telnet-data的目录来存储telnet数据，然后从实时数据流中导出10000条记录，存储在telnet-data文件夹中</p>
</blockquote>

<h3 id="maltego扩展组件assets">Maltego扩展组件/assets</h3>
<p>shodan扩展组件为Maltego提供了2/assets新的实体功能(service和exploit)和五个转换：</p>
<ul>
  <li>searchShodan</li>
  <li>searchShodanByDomain</li>
  <li>searchShodanByNetblock</li>
  <li>toShodanHost</li>
  <li>searchExploits</li>
</ul>

<p><img src="/img/shodan/1517386986498.png" alt="Alt text" /></p>

<h3 id="浏览器插件">浏览器插件</h3>

<p><a href="https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap">Chrome</a>和<a href="https://addons.mozilla.org/en-US/firefox/addon/shodan-firefox-addon/">Firefox</a>都有插件可以使用</p>

<p><img src="/img/shodan/1517387336781.png" alt="Alt text" /></p>

<h3 id="metasploit">Metasploit</h3>

<p>MSF主要有两个shodan模块：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. Shodan的常用搜索：`auxiliary/gather/shodan_search `                           
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use auxiliary/gather/shodan_search

<span class="nb">set </span>SHODAN_APIKEY <span class="k">********************</span>

<span class="nb">set </span>QUERY <span class="k">****</span>

run 
</code></pre></div></div>

<p><img src="/img/shodan/1517566369191.png" alt="Alt text" /></p>

<ol>
  <li>Shodan的蜜罐验证：<code class="highlighter-rouge">auxiliary/gather/shodan_honeyscore </code>:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use auxiliary/gather/shodan_honeyscore 

<span class="nb">set </span>SHODAN_APIKEY <span class="k">********************</span>

<span class="nb">set </span>TARGET your_target

run
</code></pre></div></div>

<p><img src="/img/shodan/1517565794510.png" alt="Alt text" /></p>

<h3 id="recon-ng">Recon-ng</h3>

<p>先添加shodan API的key：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keys add shodan_api VZbVJy<span class="k">***</span>n8S<span class="k">****</span>hS1YM1<span class="k">****</span>enTuy
</code></pre></div></div>

<p>显示可用的模块：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show modules
</code></pre></div></div>

<p>使用shodan搜索主机名：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use recon/domains-hosts/shodan_hostname
</code></pre></div></div>

<p>设置参数，并运行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show options
<span class="nb">set </span>SOURCE google
<span class="nb">set </span>LIMIT 1
run
</code></pre></div></div>

<p><img src="/img/shodan/1517883058677.png" alt="Alt text" /></p>

<h2 id="developer-api">Developer API</h2>

<p>Shodan提供了一个开发者的API（https://developer.shdan.io/api）来编程，获取所需要的信息。可以通过网站完成的事情都可以通过代码完成。</p>

<p>该API分为两部分：REST API和Streaming API。REST API提供搜索Shodan的方法，查找主机，获取关于查询的信息的摘要。Streaming API提供Shodan当前收集的数据的原始实时返回。有几个不同的套餐可以获取，该API获取的数据不能被搜索或用其他方式进行交互，适用于需要获取大量数据的人。</p>

<blockquote>
  <p>只有购买<a href="https://developer.shodan.io/billing/signup">开发者API计划</a>的人才能获得Streaming API。</p>
</blockquote>

<h3 id="使用限制">使用限制</h3>

<p>根据API的套餐不同，API会有不同的限制：</p>

<ol>
  <li><strong>搜索：</strong>每月的搜索次数有不同的限制，且需要使用查询积分。如果直接查询不会消耗查询积分，若进行过滤器或者是超过一页的搜索就需要消耗查询积分。搜索<code class="highlighter-rouge">apache</code>不需要消耗查询积分，搜<code class="highlighter-rouge">apache country:"US"</code>将会消耗一个查询积分，就算查询第二页也只会消耗一个查询积分。</li>
  <li><strong>扫描：</strong>按需获得的API也会根据积分限制每月扫描主机的数量。对于每个主机的扫描都需要一个扫描积分才能扫描。</li>
  <li><strong>网络提醒：</strong>根据不同的API的使用次数可以使用提醒功能监视所查询的IP。只有付费客户才能使用此功能，且无法在账户中创建超过100条提醒。</li>
</ol>

<h3 id="facets">Facets</h3>

<p>过滤器缩小搜索结果。而<code class="highlighter-rouge">Facets</code>提供关注的banner字段的聚合信息，会得到一个大的结果视图。例如，Shodan网站使用<code class="highlighter-rouge">Facets</code>来提供搜索的统计信息，类似于在左侧显示的:</p>

<p><img src="/img/shodan/1517400554857.png" alt="Alt text" /></p>

<p><code class="highlighter-rouge">Facets</code>有很多可以选择的参数。比如<code class="highlighter-rouge">port:22</code>的<code class="highlighter-rouge">Facets</code>是<code class="highlighter-rouge">ssh.fingerprint</code>，输出的时候就能显示出网络上SSH的详细条目。</p>

<blockquote>
  <p><strong>目前Facet只能在API和Shodan的命令行上使用</strong></p>
</blockquote>

<h3 id="入门">入门</h3>

<p>所有的例子使用python来演示，当然其他的语言也有<a href="https://developer.shodan.io/api/clients">Shodan的库/客户端</a></p>

<p>为python环境安装Shodan库：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>easy_install shodan
</code></pre></div></div>

<p>如果已经安装shodan，可以使用:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>easy_install <span class="nt">-U</span> shodan
</code></pre></div></div>

<h3 id="初始化">初始化</h3>

<p>首先要做的是初始化：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">shodan</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">shodan</span><span class="o">.</span><span class="n">Shodan</span><span class="p">(</span><span class="s">'YOUR API KEY'</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>在https://account.shodan.io获取API密钥</p>
</blockquote>

<h3 id="搜索">搜索</h3>

<p>已经拥有API密钥之后,准备进行搜索：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#将请求包放在一个try/except块中，捕获抛出的异常</span>
<span class="k">try</span><span class="p">:</span>
        <span class="c"># Search Shodan</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">'apache'</span><span class="p">)</span>
 
        <span class="c"># Show the results</span>
        <span class="k">print</span> <span class="s">'Results found: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">results</span><span class="p">[</span><span class="s">'total'</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s">'matches'</span><span class="p">]:</span>
                <span class="k">print</span> <span class="s">'IP: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="s">'ip_str'</span><span class="p">]</span>
                <span class="k">print</span> <span class="n">result</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span>
                <span class="k">print</span> <span class="s">''</span>
<span class="k">except</span> <span class="n">shodan</span><span class="o">.</span><span class="n">APIError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'Error: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">e</span>
</code></pre></div></div>

<p>首先调用api对象的Shodan.search()方法，该方法返回的结果放入字典之中。然后，打印出搜索结果数量，最后将返回的结果进行遍历循环，并打印其IP和banner。每一页的搜索结果多达100个。</p>

<p><img src="/img/shodan/1517414519892.png" alt="Alt text" /></p>

<p>当然查询的时候还有很多返回信息。下面是<code class="highlighter-rouge">Shodan.search</code>返回的部分信息：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="err">'total'</span><span class="p">:</span><span class="w"> </span><span class="mi">23199543</span><span class="p">,</span><span class="w">
	</span><span class="err">'matches'</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
		</span><span class="p">{</span><span class="w">
			</span><span class="err">'data'</span><span class="p">:</span><span class="w"> </span><span class="err">'HTTP/</span><span class="mf">1.1</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="err">Moved</span><span class="w"> </span><span class="err">Permanently\r\nDate</span><span class="p">:</span><span class="w"> </span><span class="err">Thu</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="err">Feb</span><span class="w"> </span><span class="mi">2018</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">53</span><span class="w"> </span><span class="err">GMT'</span><span class="p">,</span><span class="w">
			</span><span class="err">'hostnames'</span><span class="p">:[</span><span class="err">'mypage.ponparemall.com'</span><span class="p">],</span><span class="w">
			</span><span class="err">'ip'</span><span class="p">:</span><span class="w"> </span><span class="mi">2685469827</span><span class="err">L</span><span class="p">,</span><span class="w">
			</span><span class="err">'ip_str'</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="mf">160.17</span><span class="err">.</span><span class="mf">4.131</span><span class="err">'</span><span class="p">,</span><span class="w">
			</span><span class="err">'port'</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="mi">443</span><span class="p">,</span><span class="w">
			</span><span class="err">'isp'</span><span class="p">:</span><span class="w"> </span><span class="err">Recruit</span><span class="w"> </span><span class="err">Holdings</span><span class="w"> </span><span class="err">Co.</span><span class="p">,</span><span class="err">Ltd.</span><span class="p">,</span><span class="w">
			</span><span class="err">'timestamp'</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="mi">2018-02-01</span><span class="err">T</span><span class="mi">02</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mf">34.036371</span><span class="err">'</span><span class="w">
		</span><span class="p">},</span><span class="w">
		</span><span class="err">...</span><span class="w">
	</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>有关banner可能包含的属性的完整列表请参阅附录A</p>
</blockquote>

<p>默认情况下，为了节省带宽使用量，banner中的一些大的字段会被截断（比如HTML的）。若想要检索所有的信息，只需使用<code class="highlighter-rouge">minify=False</code>禁用概要。例如，用以下代码可以将匿名VNC服务的查询结果全部返回：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">'has_screenshot:true'</span><span class="p">,</span> <span class="n">minify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>任何错误都会引发异常，将API请求封装在<code class="highlighter-rouge">try/except</code>是一种良好的代码习惯，不过为了简单起见，例子暂时不用<code class="highlighter-rouge">try/except</code>。</p>

<hr />

<p>以上脚本仅输出第一页的搜索结果。要想获得第二页或更多的结果，可以使用<code class="highlighter-rouge">page</code>参数执行请求：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">'apache'</span><span class="p">,</span><span class="n">page</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p>如果想遍历所有的结果，使用<code class="highlighter-rouge">search_cursor()</code>方法会更加便捷 ：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">api</span><span class="o">.</span><span class="n">search_cursor</span><span class="p">(</span><span class="s">'apache'</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">banner</span><span class="p">[</span><span class="s">'ip_str'</span><span class="p">])</span> <span class="c"># 打印出该IP的每个banner</span>
</code></pre></div></div>

<blockquote>
  <p><strong>该<code class="highlighter-rouge">search_cursor()</code>方法只能循环结果，返回banner,不能使用<code class="highlighter-rouge">Facets</code></strong></p>
</blockquote>

<h3 id="主机查找">主机查找</h3>

<p>要用Shodan查找特定的IP，可用<code class="highlighter-rouge">Shodan.host()</code>函数：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 查询主机</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">host</span><span class="p">(</span><span class="s">'217.140.75.46'</span><span class="p">)</span>

<span class="c"># 打印一般信息</span>
<span class="k">print</span> <span class="s">"""
	IP: </span><span class="si">%</span><span class="s">s
	Organization: </span><span class="si">%</span><span class="s">s
	Operating System: </span><span class="si">%</span><span class="s">s
"""</span> <span class="o">%</span> <span class="p">(</span><span class="n">host</span><span class="p">[</span><span class="s">'ip_str'</span><span class="p">],</span> <span class="n">host</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'org'</span><span class="p">,</span> <span class="s">'n/a'</span><span class="p">),</span> <span class="n">host</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'os'</span><span class="p">,</span> <span class="s">'n/a'</span><span class="p">))</span>

<span class="c"># 打印所有的banner</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">host</span><span class="p">[</span><span class="s">'data'</span><span class="p">]:</span>
	<span class="k">print</span> <span class="s">"""
		Port: </span><span class="si">%</span><span class="s">s
		Banner: </span><span class="si">%</span><span class="s">s
		"""</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s">'port'</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s">'data'</span><span class="p">])</span>
</code></pre></div></div>

<p>默认情况下，Shodan只返回最近收集的主机的信息。如果想获取IP地址的完整历史记录，就使用<code class="highlighter-rouge">history</code>参数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">host</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">host</span><span class="p">(</span><span class="s">'217.140.75.46'</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>虽然以上代码可以返回所有banner，但其中也包括一些可能不再在主机上活动的服务。</p>

<h3 id="扫描">扫描</h3>

<p>Shodan每月至少爬取一次，但是如果想用Shodan立即扫描网络，就可以使用API​​扫描。（订购的不同API有不同的扫描次数）</p>

<p>与Nmap等工具扫描不同，使用Shodan进行的扫描是异步完成的，在进行Shodan扫描之后不会马上就收到扫描结果。这取决于开发人员是如何收集扫描结果的，是直接查找IP信息，是用Shodan直接搜索，还是订购实时信息流查找。Shodan命令行界面在启动扫描后，创建临时网络提醒，然后根据实时数据流出扫描结果。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scan</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="s">'198.20.69.0/24'</span><span class="p">)</span>
</code></pre></div></div>

<p>也可以使用CIDR表示法的地址来提供扫描目标：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scan</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">scan</span><span class="p">([</span><span class="s">'198.20.49.30'</span><span class="p">,</span> <span class="s">'198.20.74.0/24'</span><span class="p">])</span>
</code></pre></div></div>

<p>在向API提交了扫描请求之后，会返回以下信息：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="err">'id'</span><span class="p">:</span><span class="w"> </span><span class="err">'R</span><span class="mi">2</span><span class="err">XRT</span><span class="mi">5</span><span class="err">HH</span><span class="mi">6</span><span class="err">X</span><span class="mi">67</span><span class="err">PFAB'</span><span class="p">,</span><span class="w">
	</span><span class="err">'count'</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
	</span><span class="err">'credits_left'</span><span class="p">:</span><span class="w"> </span><span class="mi">5119</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>id：唯一的扫描标识符</li>
  <li>count: 提交的IP扫描数</li>
  <li>credits: 剩余的扫描积分</li>
</ul>

<h3 id="实时数据流">实时数据流</h3>

<p>Streaming API是一种基于HTTP的服务，可返回Shodan收集的实时数据流。它不提供任何搜索或查找功能，它只是抓取工具收集的所有内容的概要。</p>

<p>例如，以下是一个脚本的部分代码，可以从容易受到<code class="highlighter-rouge">FREAK</code>（CVE-2015-0204）攻击的设备输出banner:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">has_vuln</span><span class="p">(</span><span class="n">banner</span><span class="p">,</span> <span class="n">vuln</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">'vulns'</span> <span class="ow">in</span> <span class="n">banner</span><span class="p">[</span><span class="s">'opts'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">banner</span><span class="p">[</span><span class="s">'opts'</span><span class="p">][</span><span class="s">'vulns'</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">api</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">banners</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">has_vuln</span><span class="p">(</span><span class="n">banner</span><span class="p">,</span> <span class="s">'CVE-2015-0204'</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">banner</span>
</code></pre></div></div>

<blockquote>
  <p>在上面的例子中，<code class="highlighter-rouge">has_vuln()</code>方法检查服务是否可能存在CVE-2015-0204</p>
</blockquote>

<p>banner中的许多属性是可选的，这样可以节省空间和带宽。为了使可选属性更容易处理，最好在函数中封装对属性的访问。</p>

<blockquote>
  <p><strong>注意</strong>：常规的API能访问的数量仅仅是订购的API数量的1%，只有订购了API具有许可证的客户才有100%的访问权限</p>
</blockquote>

<h3 id="网络提醒">网络提醒</h3>

<p>要创建网络提醒，需要提供一个提醒名称和一个IP范围。名称应该具有概述性，当受到提醒的时候，就大概知道是什么监视内容被返回了。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">alert</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_alert</span><span class="p">(</span><span class="s">'Production network'</span><span class="p">,</span> <span class="s">'198.20.69.0/24'</span><span class="p">)</span>
</code></pre></div></div>

<p>正如<code class="highlighter-rouge">scan()</code>方法一样，可以提供监视的网络范围列表：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">alert</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_alert</span><span class="p">(</span><span class="s">'Production and Staging network'</span><span class="p">,</span> <span class="p">[</span>
	<span class="s">'198.20.69.0/24'</span><span class="p">,</span>
	<span class="s">'198.20.70.0/24'</span><span class="p">,</span>
<span class="p">])</span>
</code></pre></div></div>

<blockquote>
  <p>只能使用有限数量的监视IP，并且每个帐户不能有超过100个监视提醒在活动。</p>
</blockquote>

<p>将网络提醒与扫描API结合使用时，一个有用的技巧是设置提醒的时间：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">alert</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_alert</span><span class="p">(</span><span class="s">'Temporary alert'</span><span class="p">,</span> <span class="s">'198.20.69.0/24'</span><span class="p">,</span> <span class="n">expires</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</code></pre></div></div>

<p>上述代码可以使得提醒会激活使用60s,60s之后就会停止，不再进行监视。</p>

<p>成功创建提醒之后，API将返回以下对象：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
	<span class="s">"name"</span><span class="p">:</span> <span class="s">"Production network"</span><span class="p">,</span> 
	<span class="s">"created"</span><span class="p">:</span> <span class="s">"2015-10-17T08:13:58.924581"</span><span class="p">,</span> 
	<span class="s">"expires"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
	<span class="s">"expiration"</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> 
	<span class="s">"filters"</span><span class="p">:</span> <span class="p">{</span>
		<span class="s">"ip"</span><span class="p">:</span> <span class="p">[</span><span class="s">"198.20.69.0/24"</span><span class="p">]</span>
	<span class="p">},</span>
	<span class="s">"id"</span><span class="p">:</span> <span class="s">"EPGWQG5GEELV4799"</span><span class="p">,</span>
	<span class="s">"size"</span><span class="p">:</span> <span class="mi">256</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="订阅">订阅</h4>

<p>一旦创建了提醒，就可以将其用作实时数据流的监视。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">api</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="n">alert</span><span class="p">[</span><span class="s">'id'</span><span class="p">]):</span>
	<span class="k">print</span> <span class="n">banner</span>
</code></pre></div></div>

<p>与常规实时流一样，该<code class="highlighter-rouge">alert()</code>方法提供了一个迭代器，其中每个项目都是由Shodan爬虫收集的banner。<code class="highlighter-rouge">id</code>是<code class="highlighter-rouge">alert()</code>方法需要的唯一参数，在有网络提醒时会返回提醒ID。</p>

<h4 id="使用shodan命令行界面">使用Shodan命令行界面</h4>

<p>接下来讲述如何使用Shodan的命令行界面快速清除基于Python代码创建的提醒。</p>

<blockquote>
  <p><strong>该<code class="highlighter-rouge">clear</code>命令将会清除电脑上创建的所有alert。</strong></p>
</blockquote>

<p>清除所有alert：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">shodan</span> <span class="n">alert</span> <span class="n">clear</span>
<span class="n">Removing</span> <span class="n">Scan</span><span class="p">:</span> <span class="mf">198.20</span><span class="o">.</span><span class="mf">69.0</span><span class="o">/</span><span class="mi">24</span> <span class="p">(</span><span class="n">ZFPSZCYUKVZLUT4F</span><span class="p">)</span>
<span class="n">Alerts</span> <span class="n">deleted</span>
</code></pre></div></div>

<p>列出alert列表，确认有无alert：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">shodan</span> <span class="n">alert</span> <span class="nb">list</span>
<span class="n">You</span> <span class="n">haven</span><span class="s">'t created any alerts yet.</span><span class="err">
</span></code></pre></div></div>

<p>创建一个新的alert：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">shodan</span> <span class="n">alert</span> <span class="n">create</span> <span class="s">"Temporary alert"</span> <span class="mf">198.20</span><span class="o">.</span><span class="mf">69.0</span><span class="o">/</span><span class="mi">24</span>
<span class="n">Successfully</span> <span class="n">created</span> <span class="n">network</span> <span class="n">alert</span><span class="err">!</span>
<span class="n">Alert</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ODMD34NFPLJBRSTC</span>
</code></pre></div></div>

<p>最后一步是订阅监视提醒，并存储返回的数据。要为创建的警报传输结果，将<code class="highlighter-rouge">ODMD34NFPLJBRSTC</code>的警报ID提供给<code class="highlighter-rouge">stream</code>命令：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">mkdir</span> <span class="n">alert</span><span class="o">-</span><span class="n">data</span>
<span class="err">$</span> <span class="n">shodan</span> <span class="n">stream</span> <span class="o">--</span><span class="n">alert</span><span class="o">=</span><span class="n">ODMD34NFPLJBRSTC</span> <span class="o">--</span><span class="n">datadir</span><span class="o">=</span><span class="n">alert</span><span class="o">-</span><span class="n">data</span>
</code></pre></div></div>

<p>上面的命令中，使用ID为<code class="highlighter-rouge">ODMD34NFPLJBRSTC</code>的alert提醒，并且使用数据流传输结果。结果将存储在名为<code class="highlighter-rouge">alert-data</code>的目录中。每天都会在<code class="highlighter-rouge">alert-data</code>目录中生成具有一个当天收集banner的新文件。也就是说，不用关心轮转文件，<code class="highlighter-rouge">stream</code>命令会处理这些。几天后，目录将如下所示：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">ls</span> <span class="n">alert</span><span class="o">-</span><span class="n">data</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mf">05.</span><span class="n">json</span><span class="o">.</span><span class="n">gz</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mf">06.</span><span class="n">json</span><span class="o">.</span><span class="n">gz</span>
<span class="mi">2016</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mf">07.</span><span class="n">json</span><span class="o">.</span><span class="n">gz</span>
</code></pre></div></div>

<h3 id="例子-2">例子</h3>

<h4 id="常用-shodan-库函数">常用 Shodan 库函数</h4>

<ul>
  <li><code class="highlighter-rouge">shodan.Shodan(key) </code>：初始化连接API</li>
  <li><code class="highlighter-rouge">Shodan.count(query, facets=None)</code>：返回查询结果数量</li>
  <li><code class="highlighter-rouge">Shodan.host(ip, history=False)</code>：返回一个IP的详细信息</li>
  <li><code class="highlighter-rouge">Shodan.ports()</code>：返回Shodan可查询的端口号</li>
  <li><code class="highlighter-rouge">Shodan.protocols()</code>：返回Shodan可查询的协议</li>
  <li><code class="highlighter-rouge">Shodan.services()</code>：返回Shodan可查询的服务</li>
  <li><code class="highlighter-rouge">Shodan.queries(page=1, sort='timestamp', order='desc')</code>：查询其他用户分享的查询规则</li>
  <li><code class="highlighter-rouge">Shodan.scan(ips, force=False)</code>：使用Shodan进行扫描，ips可以为字符或字典类型</li>
  <li><code class="highlighter-rouge">Shodan.search(query, page=1, limit=None, offset=None, ufacets=None, minify=True)</code>：查询Shodan数据</li>
</ul>

<h4 id="例子基本的搜索">例子——基本的搜索</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
<span class="c">#</span>
<span class="c"># shodan_ips.py</span>
<span class="c"># Search SHODAN and print a list of IPs matching the query</span>
<span class="c">#</span>
<span class="c"># Author: achillean</span>

<span class="kn">import</span> <span class="nn">shodan</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># Configuration</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">"VZbVJyrIrn8SCSxHhS1YM1XPeKt5nTuy"</span>

<span class="c"># Input validation</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'Usage: </span><span class="si">%</span><span class="s">s &lt;search query&gt;'</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
        <span class="c"># Setup the api</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">shodan</span><span class="o">.</span><span class="n">Shodan</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">)</span>

        <span class="c"># Perform the search</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="c"># Loop through the matches and print each IP</span>
        <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s">'matches'</span><span class="p">]:</span>
                <span class="k">print</span> <span class="n">service</span><span class="p">[</span><span class="s">'ip_str'</span><span class="p">]</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'Error: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">e</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="例子使用facets收集概要信息">例子——使用Facets收集概要信息</h4>

<p>Shodan API的强大功能其中之一是获取各种属性的概要信息。若想了解哪些国家的Apache服务器最多，那么可以使用<code class="highlighter-rouge">Facets</code>；若想知道哪个版本的nginx最受欢迎，可以使用<code class="highlighter-rouge">Facets</code>;若想查看Microsoft-IIS服务器的正常运行时间，那么可以使用<code class="highlighter-rouge">Facets</code>。</p>

<p>以下脚本显示了如何使用<code class="highlighter-rouge">shodan.Shodan.count()</code>方法在使用Shodan API进行搜索时候不返回任何详细结果，只返回组织、域、端口、ASN和国家的信息：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
<span class="c">#</span>
<span class="c"># query-summary.py</span>
<span class="c"># Search Shodan and print summary information for the query.</span>
<span class="c">#</span>
<span class="c"># Author: achillean</span>

<span class="kn">import</span> <span class="nn">shodan</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># Configuration</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'YOUR API KEY'</span>

<span class="c"># 键入想获取的信息</span>
<span class="n">FACETS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'org'</span><span class="p">,</span>
    <span class="s">'domain'</span><span class="p">,</span>
    <span class="s">'port'</span><span class="p">,</span>
    <span class="s">'asn'</span><span class="p">,</span>

    <span class="c"># 只关注前三城市，('country', 3)让Shodan返回前三城市</span>
    <span class="c"># Facet默认五个搜索区域(比如搜索1000个国家，就键入('country', 1000)</span>
<span class="p">]</span>

<span class="n">FACET_TITLES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'org'</span><span class="p">:</span> <span class="s">'Top 5 Organizations'</span><span class="p">,</span>
    <span class="s">'domain'</span><span class="p">:</span> <span class="s">'Top 5 Domains'</span><span class="p">,</span>
    <span class="s">'port'</span><span class="p">:</span> <span class="s">'Top 5 Ports'</span><span class="p">,</span>
    <span class="s">'asn'</span><span class="p">:</span> <span class="s">'Top 5 Autonomous Systems'</span><span class="p">,</span>
    <span class="s">'country'</span><span class="p">:</span> <span class="s">'Top 3 Countries'</span><span class="p">,</span>
<span class="p">}</span>

<span class="c"># Input validation</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'Usage: </span><span class="si">%</span><span class="s">s &lt;search query&gt;'</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c"># 键入Shodan API</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">shodan</span><span class="o">.</span><span class="n">Shodan</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">)</span>

    <span class="c"># Generate a query string out of the command-line arguments</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="c"># 使用count()方法，因为它不返回结果，不需要通过付费API才能使用</span>
    <span class="c"># count()运行速度快于search().</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">facets</span><span class="o">=</span><span class="n">FACETS</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">'Shodan Summary Information'</span>
    <span class="k">print</span> <span class="s">'Query: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">query</span>
    <span class="k">print</span> <span class="s">'Total Results: </span><span class="si">%</span><span class="s">s</span><span class="se">\n</span><span class="s">'</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="s">'total'</span><span class="p">]</span>

    <span class="c"># 从Facets打印摘要信息。</span>
    <span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s">'facets'</span><span class="p">]:</span>
        <span class="k">print</span> <span class="n">FACET_TITLES</span><span class="p">[</span><span class="n">facet</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s">'facets'</span><span class="p">][</span><span class="n">facet</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">'</span><span class="si">%</span><span class="s">s: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="s">'value'</span><span class="p">],</span> <span class="n">term</span><span class="p">[</span><span class="s">'count'</span><span class="p">])</span>

        <span class="c"># 在摘要信息之间打印一条空行</span>
        <span class="k">print</span> <span class="s">''</span>

<span class="k">except</span> <span class="nb">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'Error: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">e</span>
    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517540983847.png" alt="Alt text" /></p>

<h4 id="例子利用api编写gif图片">例子——利用API编写GIF图片</h4>

<p>Shodan很好得保存了爬取的IP的完整历史记录，可以通过API编写Python脚本，输出Shodan爬虫收集的屏幕截图的。</p>

<p><strong>环境：</strong></p>

<p>需要的Python包:</p>

<ul>
  <li>shodan：<code class="highlighter-rouge">sudo easy_install shodan</code>安装</li>
  <li>arrow: <code class="highlighter-rouge">sudo easy_install arrow </code>安装。<code class="highlighter-rouge">arrow</code>包用于将banner的时间戳字段解析为Python datetime对象。</li>
</ul>

<p>需要的软件包：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">imagemagick</span> <span class="o">//</span><span class="err">将多个图像合并成一个</span><span class="n">GIF</span><span class="err">动画所需要</span>

<span class="n">easy_install</span> <span class="o">-</span><span class="n">U</span> <span class="n">requests</span> <span class="n">simplejson</span>
</code></pre></div></div>

<p>代码参见：<a href="https://gist.github.com/achillean/7190d53841865a8c9978f59863669857">Timelapse GIF Creator using the Shodan API</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">arrow</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shodan</span>
<span class="kn">import</span> <span class="nn">shodan.helpers</span> <span class="k">as</span> <span class="n">helpers</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="c"># Settings</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">''</span>

<span class="c"># The user has to provide at least 1 Shodan data file</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">'Usage: {} &lt;shodan-data.json.gz&gt; ...'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
	<span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># GIFs are stored in the local "data" directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s">'data'</span><span class="p">)</span>

<span class="c"># Setup the Shodan API object</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">shodan</span><span class="o">.</span><span class="n">Shodan</span><span class="p">(</span><span class="n">API_KEY</span><span class="p">)</span>

<span class="c"># Loop over all of the Shodan data files the user provided</span>
<span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">helpers</span><span class="o">.</span><span class="n">iterate_files</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
	<span class="c"># See whether the current banner has a screenshot, if it does then lets lookup</span>
	<span class="c"># more information about this IP</span>
	<span class="n">has_screenshot</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_screenshot</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">has_screenshot</span><span class="p">:</span>
		<span class="n">ip</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_ip</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s">'Looking up {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>
		<span class="n">host</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">host</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
		
		<span class="c"># Store all the historical screenshots for this IP</span>
		<span class="n">screenshots</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">tmp_banner</span> <span class="ow">in</span> <span class="n">host</span><span class="p">[</span><span class="s">'data'</span><span class="p">]:</span>
			<span class="c"># Try to extract the image from the banner data</span>
			<span class="n">screenshot</span> <span class="o">=</span> <span class="n">helpers</span><span class="o">.</span><span class="n">get_screenshot</span><span class="p">(</span><span class="n">tmp_banner</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">screenshot</span><span class="p">:</span>
				<span class="c"># Sort the images by the time they were collected so the GIF will loop</span>
				<span class="c"># based on the local time regardless of which day the banner was taken.</span>
				<span class="n">timestamp</span> <span class="o">=</span> <span class="n">arrow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">banner</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">])</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
				<span class="n">sort_key</span> <span class="o">=</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">hour</span>

				<span class="c"># Add the screenshot to the list of screenshots which we'll use to create the timelapse</span>
				<span class="n">screenshots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span>
					<span class="n">sort_key</span><span class="p">,</span>
					<span class="n">screenshot</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span>
				<span class="p">))</span>

		<span class="c"># Extract the screenshots and turn them into a GIF if we've got more than a few images</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">screenshots</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
			<span class="c"># screenshots is a list where each item is a tuple of:</span>
			<span class="c"># (sort key, screenshot in base64 encoding)</span>
			<span class="c"># </span>
			<span class="c"># Lets sort that list based on the sort key and then use Python's enumerate</span>
			<span class="c"># to generate sequential numbers for the temporary image filenames</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">screenshot</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">screenshots</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)):</span>
				<span class="c"># Create a temporary image file</span>
				<span class="c"># TODO: don't assume that all images are "jpg", use the mimetype instead</span>
				<span class="nb">open</span><span class="p">(</span><span class="s">'/tmp/gif-image-{}.jpg'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s">'w'</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">screenshot</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'base64'</span><span class="p">))</span>
			
			<span class="c"># Create the actual GIF using the  ImageMagick "convert" command</span>
			<span class="c"># The resulting GIFs are stored in the local data/ directory</span>
			<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'convert -layers OptimizePlus -delay 5x10 /tmp/gif-image-*.jpg -loop 0 +dither -colors 256 -depth 8 data/{}.gif'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>

			<span class="c"># Clean up the temporary files</span>
			<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">'rm -f /tmp/gif-image-*.jpg'</span><span class="p">)</span>

			<span class="c"># Show a progress indicator</span>
			<span class="k">print</span><span class="p">(</span><span class="s">'GIF created for {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>
</code></pre></div></div>

<blockquote>
  <p>使用<code class="highlighter-rouge">iterate_files()</code>遍历Shodan数据文件。
在<code class="highlighter-rouge">shodan.Shodan.host()</code>方法中获取所有Shodan收集的IP的banner历史记录。</p>
</blockquote>

<p>下载屏幕截图的JSON数据包：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">shodan</span> <span class="n">download</span> <span class="o">--</span><span class="n">limit</span> <span class="o">-</span><span class="mi">1</span> <span class="n">screenshots</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">gz</span> <span class="n">has_screenshot</span><span class="p">:</span><span class="n">true</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517555243075.png" alt="Alt text" /></p>

<h4 id="例子公开的mongodb数据">*例子——公开的MongoDB数据</h4>

<p><a href="https://www.mongodb.com/">MongoDB</a>是一个流行的<a href="https://en.wikipedia.org/wiki/NoSQL">NoSQL</a>数据库。在很长一段时间内，MongoDB默认是不需要输入用户名和密码,就可以登录。导致了许多MongoDB的服务在互联网上可以被公开访问。（见<a href="http://bobao.360.cn/news/detail/1792.html">shodan扫描结果：3万个MongoDB可以无密码访问 大概包含595Tb数据</a>）</p>

<p>使用Shodan抓取这些数据库的banner，其中包含了大量关于存储数据的信息。以下是banner的概要：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">IP</span><span class="p">:</span><span class="w"> </span><span class="mf">115.231</span><span class="err">.</span><span class="mf">180.54</span><span class="w">
</span><span class="err">MongoDB</span><span class="w"> </span><span class="err">Server</span><span class="w"> </span><span class="err">Information</span><span class="w">
</span><span class="err">Authentication</span><span class="w"> </span><span class="err">partially</span><span class="w"> </span><span class="err">enabled</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="s2">"storageEngines"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"devnull"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"ephemeralForTest"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"mmapv1"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"wiredTiger"</span><span class="w">
    </span><span class="p">],</span><span class="w"> 
    </span><span class="s2">"maxBsonObjectSize"</span><span class="p">:</span><span class="w"> </span><span class="mi">16777216</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"ok"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"modules"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> 
    </span><span class="s2">"openssl"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"compiled"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpenSSL 1.0.1f 6 Jan 2014"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"running"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpenSSL 1.0.1f 6 Jan 2014"</span><span class="w">
    </span><span class="p">},</span><span class="w"> 
    </span><span class="s2">"javascriptEngine"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mozjs"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.2.18"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"gitVersion"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4c1bae566c0c00f996a2feb16febf84936ecaf6f"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"versionArray"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">3</span><span class="p">,</span><span class="w"> 
        </span><span class="mi">2</span><span class="p">,</span><span class="w"> 
        </span><span class="mi">18</span><span class="p">,</span><span class="w"> 
        </span><span class="mi">0</span><span class="w">
    </span><span class="p">],</span><span class="w"> 
    </span><span class="s2">"debug"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"buildEnvironment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"cxxflags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-Wnon-virtual-dtor -Woverloaded-virtual -Wno-maybe-uninitialized -std=c++11"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"cc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/opt/mongodbtoolchain/bin/gcc: gcc (GCC) 4.8.2"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"linkflags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-fPIC -pthread -Wl,-z,now -rdynamic -fuse-ld=gold -Wl,-z,noexecstack -Wl,--warn-execstack"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"distarch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"cxx"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/opt/mongodbtoolchain/bin/g++: g++ (GCC) 4.8.2"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"ccflags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-fno-omit-frame-pointer -fPIC -fno-strict-aliasing -ggdb -pthread -Wall -Wsign-compare -Wno-unknown-pragmas -Winvalid-pch -Werror -O2 -Wno-unused-local-typedefs -Wno-unused-function -Wno-deprecated-declarations -Wno-unused-but-set-variable -Wno-missing-braces -fno-builtin-memcmp"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"target_arch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x86_64"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"distmod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ubuntu1404"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"target_os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"linux"</span><span class="w">
    </span><span class="p">},</span><span class="w"> 
    </span><span class="s2">"sysInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deprecated"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"allocator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcmalloc"</span><span class="w">
</span><span class="p">},</span><span class="w">
</span><span class="err">....</span><span class="w">
</span></code></pre></div></div>

<p><img src="/img/shodan/1517472477983.png" alt="Alt text" /></p>

<p>基本上，banner是MongoDB服务器信息和及其3个JSON对象用逗号分隔而组成。或者有的banner里有需要登陆凭据的验证字符——“authentication enabled”。每个JSON对象都包含有关数据库的不同信息，建议在Shodan网站上查看完整的头信息，方法是搜索：</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">product</span><span class="p">:</span><span class="nx">MongoDB</span> <span class="nx">metrics</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517474301541.png" alt="Alt text" /></p>

<blockquote>
  <p><strong><code class="highlighter-rouge">metrics</code>字符保证了搜索时只搜索不需要认证的MongoDB服务</strong></p>
</blockquote>

<hr />

<p>接下来使用banner信息统计最流行的数据库名称，以及在互联网上暴露的数据量。基本的工作流程：</p>
<ol>
  <li>下载所有的MongoDB banner数据</li>
  <li>处理下载的文件，并输出前十个数据库名称的列表以及总数据大小</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shodan download <span class="nt">--limit</span> <span class="nt">-1</span> mongodb-servers.json.gz product:mongodb
</code></pre></div></div>

<p>上述命令功能是，利用Shodan搜索关于mongodb的设备信息，并使用<code class="highlighter-rouge">--limit -1</code>指令下载所有的查询结果，输出到<code class="highlighter-rouge">mongodb-servers.json.gz</code>文件。</p>

<hr />

<p>使用Python脚本处理刚才所下载的数据。</p>

<p>要轻松遍历文件，将使用<code class="highlighter-rouge">shodan.helpers.iterate_files()</code>方法:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">shodan.helpers</span> <span class="k">as</span> <span class="n">helpers</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># datafile变量是命令行的第一个参数</span>
<span class="n">datafile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">helpers</span><span class="o">.</span><span class="n">iterate_files</span><span class="p">(</span><span class="n">datafile</span><span class="p">):</span>
    <span class="c"># 获得banner</span>
</code></pre></div></div>

<p>由于每个banner仅仅是带有头信息的JSON，因此可以使用<code class="highlighter-rouge">simplejson</code>库将banner处理为本地的Python字典：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 去除Shodan加入的MongoDB的头信息</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">banner</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'MongoDB Server Information</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">},</span><span class="se">\n</span><span class="s">'</span>\
<span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="c"># 加载数据库信息</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">simplejson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">'}'</span><span class="p">)</span>
</code></pre></div></div>

<p>接下来的事情就是记录暴露的数据总量和最流行的数据库名称：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_data</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="o">...</span>

    <span class="c"># 然后循环</span>
    <span class="c"># 跟踪可访问的数据</span>
    <span class="n">total_data</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s">'totalSize'</span><span class="p">]</span>

    <span class="c"># 跟踪哪些数据库使用最多</span>
    <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">'databases'</span><span class="p">]:</span>
        <span class="n">databases</span><span class="p">[</span><span class="n">db</span><span class="p">[</span><span class="s">'name'</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>Python有一个有用的<code class="highlighter-rouge">collections.defaultdict</code>类，该类的功能是，如果字典的键尚不存在，这个类将自动为字典的键创建一个默认值。只需访问 MongoDB  banner的<code class="highlighter-rouge">totalSize</code>和<code class="highlighter-rouge">databases</code>属性即可收集的信息。
最后，我们只需要输出实际结果：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'Total: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">humanize_bytes</span><span class="p">(</span><span class="n">total_data</span><span class="p">)))</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">databases</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'#{}</span><span class="se">\t</span><span class="s">{}: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>首先打印数据总量，然后使用<code class="highlighter-rouge">humanize_bytes()</code>方法将字节存储转换为易读的MB、GB等存储格式。</p>

<p>其次，对数据库集合进行多次逆序遍历排序（<code class="highlighter-rouge">key=operator.itemgetter(1)</code>），取结果的TOP10（<code class="highlighter-rouge">[:10]</code>）。</p>

<p>以下是读取Shodan数据文件并分析banner的完整脚本：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!C:\Python27\python.exe</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># @Time    : 2018/2/2 10:01</span>
<span class="c"># @Author  : b404</span>
<span class="c"># @File    : MongDB_Shodan.py</span>
<span class="c"># @Software: PyCharm</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">shodan.helpers</span> <span class="k">as</span> <span class="n">helpers</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">simplejson</span>

<span class="k">def</span> <span class="nf">humanize_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="s">"""将字节转换为易读的存储单位MB、GB等

    Assumes `from __future__ import division`.

    &gt;&gt;&gt; humanize_bytes(1)
    '1 byte'
    &gt;&gt;&gt; humanize_bytes(1024)
    '1.0 kB'
    &gt;&gt;&gt; humanize_bytes(1024*123)
    '123.0 kB'
    &gt;&gt;&gt; humanize_bytes(1024*12342)
    '12.1 MB'
    &gt;&gt;&gt; humanize_bytes(1024*12342,2)
    '12.05 MB'
    &gt;&gt;&gt; humanize_bytes(1024*1234,2)
    '1.21 MB'
    &gt;&gt;&gt; humanize_bytes(1024*1234*1111,2)
    '1.31 GB'
     &gt;&gt;&gt; humanize_bytes(1024*1234*1111,1)
        '1.3 GB'
        """</span>
    <span class="n">abbrevs</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="il">50L</span><span class="p">,</span> <span class="s">'PB'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="il">40L</span><span class="p">,</span> <span class="s">'TB'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="il">30L</span><span class="p">,</span> <span class="s">'GB'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="il">20L</span><span class="p">,</span> <span class="s">'MB'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="il">10L</span><span class="p">,</span> <span class="s">'kB'</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'bytes'</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="nb">bytes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'1 byte'</span>
    <span class="k">for</span> <span class="n">factor</span><span class="p">,</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">abbrevs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">bytes</span> <span class="o">&gt;=</span> <span class="n">factor</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="s">'</span><span class="si">%.*</span><span class="s">f </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="nb">bytes</span> <span class="o">/</span> <span class="n">factor</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span>

<span class="n">total_data</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">banner</span> <span class="ow">in</span> <span class="n">helpers</span><span class="o">.</span><span class="n">iterate_files</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c"># 去除Shodan加入的MongoDB的头信息</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">banner</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'MongoDB Server Information</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">},</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c"># 加载数据库信息</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">simplejson</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="s">'}'</span><span class="p">)</span>
        <span class="c"># 记录公开访问的数据量</span>
        <span class="n">total_data</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s">'totalSize'</span><span class="p">]</span>

        <span class="c"># 跟踪哪些数据库名称最常见</span>
        <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">'databases'</span><span class="p">]:</span>
            <span class="n">databases</span><span class="p">[</span><span class="n">db</span><span class="p">[</span><span class="s">'name'</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">except</span> <span class="nb">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Total: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">humanize_bytes</span><span class="p">(</span><span class="n">total_data</span><span class="p">)))</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">databases</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'#{}</span><span class="se">\t</span><span class="s">{}: {}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>
<span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>该脚本输出：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Total: 569.7 GB
<span class="c">#1	Warning: 1448</span>
<span class="c">#1	local: 1172</span>
<span class="c">#1	admin: 488</span>
<span class="c">#1	README: 113</span>
<span class="c">#1	config: 67</span>
<span class="c">#1	test: 43</span>
<span class="c">#1	DATA_HAS_BEEN_BACKED_UP: 19</span>
<span class="c">#1	logs: 19</span>
<span class="c">#1	db_has_been_backed_up: 15</span>
<span class="c">#1	gpsreal: 11</span>
</code></pre></div></div>

<p><img src="/img/shodan/1517540128263.png" alt="Alt text" /></p>

<h2 id="工业控制系统">工业控制系统</h2>

<p>工控指的是工业自动化控制，主要利用电子电气、机械、软件组合实现。打比方说，工业控制系统(ICS)是控制周围世界的计算机。它们负责管理办公室的空调、发电厂的涡轮机、剧院的照明设备或者工厂的机器人。</p>

<p><em>可以去<a href="http://plcscan.org/blog/">灯塔实验室</a>（http://plcscan.org/blog/）和https://cs3sthlm.se/ 了解工控的相关姿势</em></p>

<p><a href="https://www.slideshare.net/BobRadvanovsky/project-shine-findings-report-dated-1oct2014">SHINE项目</a>（SHodan INTElligence Extraction）研究表明，从2012至2014年，互联网上至少有200万个可公开访问的工控设备。在2012年，第一个包含500,000个ICS设备的数据库被发送到ICS- cert。ICS-CERT认定，在美国50万的设备中，大约有7200个是关键的基础设施。随着对工控安全做出很多努力，越来越多的工控设备进行漏洞修补或者关机下线。但这是一个具有挑战性的问题，而且针对工控安全问题的解决方案没有一个是简单的。</p>

<p>下图是2014年Shodan爬取的工控全球分布图：</p>

<p><img src="/img/shodan/1517563420610.png" alt="Alt text" /></p>

<h3 id="常用缩写">常用缩写</h3>

<p>以下是一些常用的缩写，有助于后面了解协议，快速找到ICS设备：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">缩写</th>
      <th style="text-align: center">说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">SCADA</td>
      <td style="text-align: center">数据采集与监视控制系统</td>
    </tr>
    <tr>
      <td style="text-align: center">ICS</td>
      <td style="text-align: center">工业控制系统</td>
    </tr>
    <tr>
      <td style="text-align: center">DCS</td>
      <td style="text-align: center">分布式控制系统/集散控制系统</td>
    </tr>
    <tr>
      <td style="text-align: center">PCS</td>
      <td style="text-align: center">过程控制系统</td>
    </tr>
    <tr>
      <td style="text-align: center">ESD</td>
      <td style="text-align: center">应急停车系统</td>
    </tr>
    <tr>
      <td style="text-align: center">PLC</td>
      <td style="text-align: center">可编程序控制器(Programmable Logic Controller)</td>
    </tr>
    <tr>
      <td style="text-align: center">RTU</td>
      <td style="text-align: center">远程终端控制系统</td>
    </tr>
    <tr>
      <td style="text-align: center">IED</td>
      <td style="text-align: center">智能监测单元</td>
    </tr>
    <tr>
      <td style="text-align: center">HMI</td>
      <td style="text-align: center">人机界面(Human Machine Interface)</td>
    </tr>
    <tr>
      <td style="text-align: center">MIS</td>
      <td style="text-align: center">管理信息系统(Management Information System)</td>
    </tr>
    <tr>
      <td style="text-align: center">SIS</td>
      <td style="text-align: center">生产过程自动化监控和管理系统（Supervisory Information System）</td>
    </tr>
    <tr>
      <td style="text-align: center">MES</td>
      <td style="text-align: center">制造执行管理系统</td>
    </tr>
    <tr>
      <td style="text-align: center">BMS</td>
      <td style="text-align: center">建筑管理系统(uilding Management System)</td>
    </tr>
    <tr>
      <td style="text-align: center">VNC</td>
      <td style="text-align: center">虚拟网络计算(Virtual Network Computing)</td>
    </tr>
  </tbody>
</table>

<h3 id="协议">协议</h3>

<p>识别联网的控制系统有两种不同的方式：</p>

<p><strong>1. 在ICS环境中使用的非ICS协议。</strong></p>

<p>Shodan的ICS搜索结果大部分是通过搜索WEB服务器或其他常用的协议发现的，这些协议并不是直接与ICS相连接，而是可以在ICS网络上看到。例如，运行在HMI上的Web服务器或未经身份验证的Windows远程桌面直接连接在ICS网络上，这些协议将回提供一个ICS的可视化界面。（但大多常用某种形式进行身份验证）</p>

<p>下图就是一个在<a href="">Shodan Images</a>上找到的一个通过未经认证的VNC连接并暴露的HMI引擎。</p>

<p><img src="/img/shodan/1517558673290.png" alt="Alt text" /></p>

<p><strong>2. ICS协议</strong></p>

<p>ICS协议是控制系统使用的原始协议。每个ICS协议都有其独特的标志，它们都有一个共同点：它们不需要任何认证。这意味着，如果可以远程访问工业设备，则可以自动对其进行读取和写入。但是，原始的ICS协议往往很难开发，是独有的，实际也很难与控制系统交互。也就是使用Shodan很容易检查设备是否支持ICS协议。</p>

<p>下图的banner是一个<code class="highlighter-rouge">Siemens S7 PLC</code>设备的Shodan搜索图，banner暴露了其序列号和位置：</p>

<p><img src="/img/shodan/1517559696791.png" alt="Alt text" /></p>

<h4 id="modbus">Modbus</h4>

<p>MODBUS协议定义了一个与基础通信层无关的简单协议数据单元（PDU）。特定总线或网络上的MODBUS协议映射能够在应用数据单元（ADU）上引入一些附加域。</p>

<p><img src="/img/shodan/1517562446923.png" alt="Alt text" /></p>

<p>工控安全问题：</p>

<ul>
  <li>缺乏认证：仅需要使用一个合法的Modbus地址和合法的功能码即可以建立一个Modbus会话</li>
  <li>缺乏授权：没有基于角色的访问控制机制， 任意用户可以执行任意的功能。</li>
  <li>缺乏加密：地址和命令明文传输， 可以很容易地捕获和解析</li>
</ul>

<h4 id="profibus">PROFIBUS</h4>

<p>PROFIBUS 一种用于工厂自动化车间级监控和现场设备层数据通信与控制的现场总线技术，可实现现场设备层到车间级监控的分散式数字控制和现场通信网络</p>

<h4 id="dnp3">DNP3</h4>

<p>DNP3 DNP(Distributed Network Protocol,分布式网络协议)是一种应用于自动化组件之间的通讯协议，常见于电力、水处理等行业。简化OSI模型，只包含了物理层，数据层与应用层的体系结构（EPA）。SCADA可以使用DNP协议与主站、RTU、及IED进行通讯。</p>

<h4 id="iccp">ICCP</h4>

<p>ICCP 电力控制中心通讯协议。</p>

<h4 id="opc">OPC</h4>

<p>OPC 过程控制的OLE （OLE for Process Control）。OPC包括一整套接口、属性和方法的标准集，用于过程控制和制造业自动化系统。</p>

<h4 id="bacnet">BACnet</h4>

<p>BACnet 楼宇自动控制网络数据通讯协议（A Data Communication Protocol for Building Automation and Control Networks）。BACnet 协议是为计算机控制采暖、制冷、空调HVAC系统和其他建筑物设备系统定义服务和协议</p>

<h4 id="cip">CIP</h4>

<p>CIP 通用工业协议，被deviceNet、ControINet、EtherNet/IP三种网络所采用。</p>

<h4 id="siemens-s7">Siemens S7</h4>

<p>Siemens S7 属于第7层的协议，用于西门子设备之间进行交换数据，通过TSAP，可加载MPI,DP,以太网等不同物理结构总线或网络上，PLC一般可以通过封装好的通讯功能块实现。</p>

<h4 id="其他工控协议">其他工控协议</h4>

<p>其他工控协议IEC 60870-5-104、EtherNet/IP、Tridium Niagara Fox、Crimson V3、OMRON FINS、PCWorx、ProConOs、MELSEC-Q</p>

<h4 id="架构缺陷">架构缺陷</h4>

<ul>
  <li>未经真正安全考验的组件与协议
    <ul>
      <li>若有Web服务，那就利用Web服务该有的缺陷</li>
      <li>经典渗透技巧大多适用于工控网络</li>
    </ul>
  </li>
  <li>稳定性优先+懒 → 升级难</li>
  <li>互联网的便利性，让工控组件暴露在网络空间里</li>
  <li>以协议研究为出发点</li>
</ul>

<h4 id="工控系统的指纹识别技术">工控系统的指纹识别技术</h4>

<p>http://plcscan.org/blog/2017/03/fingerprint-identification-technology-of-industrial-control-system/</p>

<h3 id="信息探测">信息探测</h3>

<h4 id="ethernetip">Ethernet/IP</h4>

<p>Port:44818</p>

<p><img src="/img/shodan/1517562632678.png" alt="Alt text" /></p>

<p><img src="/img/shodan/1517562645838.png" alt="Alt text" /></p>

<ul>
  <li>Nmap: enip-enumerate.nse</li>
  <li>Python: https://github.com/paperwork/pyenip</li>
  <li>Wireshark dissector
    <ul>
      <li>src/epan/dissector/packet-etherip.c</li>
    </ul>
  </li>
</ul>

<h4 id="modbus-1">Modbus</h4>

<ul>
  <li>port:502</li>
  <li>抓取设备相关信息</li>
  <li>Nmap: modicon-info.nse</li>
  <li>Wireshark dissector
    <ul>
      <li>src/epan/dissector/packet-mbtcp.c</li>
    </ul>
  </li>
  <li>认证与加密缺失</li>
</ul>

<p><img src="/img/shodan/1517562668708.png" alt="Alt text" /></p>

<h4 id="iec-61870-5-101104">IEC 61870-5-101/104</h4>

<ul>
  <li>Port: 2404</li>
  <li>判断是否使用该协议
    <ul>
      <li>Nmap: iec-identify.nse</li>
      <li>Wireshark dissector
        <ul>
          <li>src/epan/dissectors/packet-iec104.c</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>认证与加密缺失</li>
</ul>

<p><img src="/img/shodan/1517562684375.png" alt="Alt text" /></p>

<h4 id="siemens-s7-1">Siemens S7</h4>

<ul>
  <li>key:Siemens S7 PLC（102）</li>
  <li>抓取设备相关信息</li>
  <li>Nmap: s7-enumerate_.nse
    <ul>
      <li>http://plcscan.org/blog/wp-content/uploads/2014/11/s7-enumerate.nse_.txt</li>
    </ul>
  </li>
  <li>Wireshark plugins
    <ul>
      <li>http://sourceforge.net/projects/s7commwireshark/</li>
    </ul>
  </li>
  <li>弱加密，易破解</li>
</ul>

<p><img src="/img/shodan/1517562711782.png" alt="Alt text" /></p>

<h4 id="tridium-niagara-fox">Tridium Niagara Fox</h4>

<ul>
  <li>port:1911</li>
  <li>抓取设备信息
    <ul>
      <li>Nmap: fox-info.nse</li>
    </ul>
  </li>
</ul>

<p><img src="/img/shodan/1517562772495.png" alt="Alt text" /></p>

<h2 id="附录abanner格式">附录A：Banner格式</h2>

<p>以下是有关banner的最新属性字段列表（若要查看最新的，请访问<a href="https://developer.shodan.io/api/banner-specification">在线文档</a>）：</p>

<h3 id="常用属性">常用属性</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">举例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">asn</td>
      <td style="text-align: center">自治系统号</td>
      <td style="text-align: center">AS4837</td>
    </tr>
    <tr>
      <td style="text-align: center">data</td>
      <td style="text-align: center">服务的主要banner</td>
      <td style="text-align: center">HTTP/1.1 200…</td>
    </tr>
    <tr>
      <td style="text-align: center">ip</td>
      <td style="text-align: center">整数型的IP地址格式</td>
      <td style="text-align: center">493427495</td>
    </tr>
    <tr>
      <td style="text-align: center">ip_str</td>
      <td style="text-align: center">字符串型IP</td>
      <td style="text-align: center">199.30.15.20</td>
    </tr>
    <tr>
      <td style="text-align: center">ipv6</td>
      <td style="text-align: center">字符串型IPv6</td>
      <td style="text-align: center">2001:4860:4860::8888</td>
    </tr>
    <tr>
      <td style="text-align: center">port</td>
      <td style="text-align: center">服务的端口号</td>
      <td style="text-align: center">80</td>
    </tr>
    <tr>
      <td style="text-align: center">timestamp</td>
      <td style="text-align: center">收集信息的日期</td>
      <td style="text-align: center">2014-01-15T05:49:56.283713</td>
    </tr>
    <tr>
      <td style="text-align: center">hash</td>
      <td style="text-align: center">数据属性的散列值</td>
      <td style="text-align: center">Numeric hash of the data property</td>
    </tr>
    <tr>
      <td style="text-align: center">hostnames</td>
      <td style="text-align: center">目标IP的主机名</td>
      <td style="text-align: center">[“shodan.io”, “www.shodan.io”]</td>
    </tr>
    <tr>
      <td style="text-align: center">domains</td>
      <td style="text-align: center">目标IP的所有域名</td>
      <td style="text-align: center">[“shodan.io”]</td>
    </tr>
    <tr>
      <td style="text-align: center">link</td>
      <td style="text-align: center">网络连接类型</td>
      <td style="text-align: center">以太网/调制解调器</td>
    </tr>
    <tr>
      <td style="text-align: center">location</td>
      <td style="text-align: center">设备的物理地址</td>
      <td style="text-align: center">见下文</td>
    </tr>
    <tr>
      <td style="text-align: center">opts</td>
      <td style="text-align: center">补充或者实验数据不包含在主要的banner中</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">org</td>
      <td style="text-align: center">分配IP的组织</td>
      <td style="text-align: center">Google Inc.</td>
    </tr>
    <tr>
      <td style="text-align: center">isp</td>
      <td style="text-align: center">负责IP空间的ISP</td>
      <td style="text-align: center">Verizon Wireless</td>
    </tr>
    <tr>
      <td style="text-align: center">os</td>
      <td style="text-align: center">操作系统</td>
      <td style="text-align: center">Linux</td>
    </tr>
    <tr>
      <td style="text-align: center">uptime</td>
      <td style="text-align: center">IP上线时间</td>
      <td style="text-align: center">50</td>
    </tr>
    <tr>
      <td style="text-align: center">tags</td>
      <td style="text-align: center">描述设备用途的标签列表(仅供企业型账号使用)</td>
      <td style="text-align: center">[“ics”, “vpn”]</td>
    </tr>
    <tr>
      <td style="text-align: center">transport</td>
      <td style="text-align: center">用于收集banner的传输协议(UDP或者是TCP)</td>
      <td style="text-align: center">tcp</td>
    </tr>
  </tbody>
</table>

<h3 id="elastic属性">Elastic属性</h3>

<p>下列属性是为 Elastic (曾经的 ElasticSearch)收集的:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">elastic.cluster</td>
      <td style="text-align: center">有关集群的一般信息</td>
    </tr>
    <tr>
      <td style="text-align: center">elastic.indices</td>
      <td style="text-align: center">集群上可用的索引列表</td>
    </tr>
    <tr>
      <td style="text-align: center">elastic.nodes</td>
      <td style="text-align: center">群集的节点/对等点列表及其信息</td>
    </tr>
  </tbody>
</table>

<h3 id="https属性">HTTP(S)属性</h3>

<p>Shodan遵循HTTP响应的重定向，并将所有中间数据存储在banner中。抓取工具不遵循重定向的情况是HTTP请求被重定向到HTTPS位置，反之亦然：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">http.components</td>
      <td style="text-align: center">用于创建网站的网络技术</td>
    </tr>
    <tr>
      <td style="text-align: center">http.host</td>
      <td style="text-align: center">发送主机名来抓取网站的HTML</td>
    </tr>
    <tr>
      <td style="text-align: center">http.html</td>
      <td style="text-align: center">网站的HTML内容</td>
    </tr>
    <tr>
      <td style="text-align: center">http.html_hash</td>
      <td style="text-align: center">http.html属性的数字散列</td>
    </tr>
    <tr>
      <td style="text-align: center">http.location</td>
      <td style="text-align: center">最终的HTML响应的位置</td>
    </tr>
    <tr>
      <td style="text-align: center">http.redirects</td>
      <td style="text-align: center">遵循的重定向列表。每个重定向项目有3个属性：主机，数据和位置</td>
    </tr>
    <tr>
      <td style="text-align: center">http.robots</td>
      <td style="text-align: center">robots.txt文件的网站</td>
    </tr>
    <tr>
      <td style="text-align: center">http.server</td>
      <td style="text-align: center">HTTP响应的服务器头</td>
    </tr>
    <tr>
      <td style="text-align: center">http.sitemap</td>
      <td style="text-align: center">网站的Sitemap XML</td>
    </tr>
    <tr>
      <td style="text-align: center">http.title</td>
      <td style="text-align: center">网站的标题</td>
    </tr>
  </tbody>
</table>

<h3 id="位置属性">位置属性</h3>

<table>
  <thead>
    <tr>
      <th>名称</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>area_code</td>
      <td>设备位置的区号</td>
    </tr>
    <tr>
      <td>city</td>
      <td>城市名称</td>
    </tr>
    <tr>
      <td>country_code</td>
      <td>2个字母组成的国家代码</td>
    </tr>
    <tr>
      <td>country_code3</td>
      <td>3个字母组成的国家代码</td>
    </tr>
    <tr>
      <td>country_name</td>
      <td>国家的全名</td>
    </tr>
    <tr>
      <td>dma_code</td>
      <td>指定市场区号（仅限美国）</td>
    </tr>
    <tr>
      <td>latitude</td>
      <td>纬度</td>
    </tr>
    <tr>
      <td>longitude</td>
      <td>经度</td>
    </tr>
    <tr>
      <td>postal_code</td>
      <td>邮政编码</td>
    </tr>
    <tr>
      <td>region_code</td>
      <td>地区代码</td>
    </tr>
  </tbody>
</table>

<h3 id="smb属性">SMB属性</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">smb.anonymous</td>
      <td style="text-align: center">服务是否允许匿名连接（true/false)</td>
    </tr>
    <tr>
      <td style="text-align: center">smb.capabilities</td>
      <td style="text-align: center">服务支持的功能列表</td>
    </tr>
    <tr>
      <td style="text-align: center">smb.shares</td>
      <td style="text-align: center">可用的网络共享列表</td>
    </tr>
    <tr>
      <td style="text-align: center">smb.smb_version</td>
      <td style="text-align: center">用于收集信息的协议版本</td>
    </tr>
    <tr>
      <td style="text-align: center">smb.software</td>
      <td style="text-align: center">提供服务的软件</td>
    </tr>
    <tr>
      <td style="text-align: center">smb.raw</td>
      <td style="text-align: center">服务器发送的十六进制编码数据包列表; 如果想做SMB解析，这很有用</td>
    </tr>
  </tbody>
</table>

<h3 id="ssh属性">SSH属性</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ssh.cipher</td>
      <td style="text-align: center">协商期间使用的密码</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.fingerprint</td>
      <td style="text-align: center">设备的指纹</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.kex</td>
      <td style="text-align: center">服务器支持的密钥交换算法列表</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.key</td>
      <td style="text-align: center">服务器的SSH密钥</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.mac</td>
      <td style="text-align: center">消息认证码算法</td>
    </tr>
  </tbody>
</table>

<h3 id="ssl-属性">SSL 属性</h3>

<p>如果服务使用SSL进行包装，则Shodan将执行附加测试，并在以下属性中提供结果：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ssl.acceptable_cas</td>
      <td style="text-align: center">服务器接受的证书颁发机构列表</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert</td>
      <td style="text-align: center">可解析的SSL证书</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher</td>
      <td style="text-align: center">SSL连接的首选密码</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.chain</td>
      <td style="text-align: center">从用户证书到根证书的SSL证书列表</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.dhparams</td>
      <td style="text-align: center">Diffie-Hellman参数</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.tlsext</td>
      <td style="text-align: center">服务器支持的TLS扩展列表</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.versions</td>
      <td style="text-align: center">支持的SSL版本; 如果该值用<code class="highlighter-rouge">-</code>开头，则该服务不支持该版本（例如：“-SSLv2”是指不支持SSLv2的服务）</td>
    </tr>
  </tbody>
</table>

<h3 id="isakmp属性">ISAKMP属性</h3>

<p>以下为使用ISAKMP协议的VPN（例如IKE）收集的属性：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">isakmp.initiator_spi</td>
      <td style="text-align: center">初始化器的hex编码的安全参数索引</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.responder_spi</td>
      <td style="text-align: center">用于响应器的hex编码的安全参数索引</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.next_payload</td>
      <td style="text-align: center">启动后发送的下一个载荷</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.version</td>
      <td style="text-align: center">协议版本; 例如“1.0”</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.exchange_type</td>
      <td style="text-align: center">交换类型</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.flags.encryption</td>
      <td style="text-align: center">加密设置：true或false</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.flags.commit</td>
      <td style="text-align: center">提交设置：true或false</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.flags.authentication</td>
      <td style="text-align: center">认证设置：true或false</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.msg_id</td>
      <td style="text-align: center">消息的十六进制编码标识</td>
    </tr>
    <tr>
      <td style="text-align: center">isakmp.length</td>
      <td style="text-align: center">ISAKMP数据包的大小</td>
    </tr>
  </tbody>
</table>

<h3 id="特殊属性">特殊属性</h3>

<h4 id="_shodan">_shodan</h4>

<p><code class="highlighter-rouge">_shodan</code>属性包含有关数据如何被Shodan收集的信息。它与其他属性不同，因为它不提供有关设备的信息。相反，它会告诉你Shodan使用哪一个banner抓取器来与目标IP交互。这对于探知服务器上的端口运行服务情况是很重要的。例如，80端口是最知名的Web服务端口，但它也被各种恶意软件用来规避防火墙规则，<code class="highlighter-rouge">_shodan</code>属性将让你知道是该端口否用HTTP模块来收集数据或是否使用了反恶意软件模块。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">_shodan.crawler</td>
      <td style="text-align: center">识别Shodan爬取工具的唯一ID</td>
    </tr>
    <tr>
      <td style="text-align: center">_shodan.id</td>
      <td style="text-align: center">此banner的唯一ID</td>
    </tr>
    <tr>
      <td style="text-align: center">_shodan.module</td>
      <td style="text-align: center">爬虫抓取banner而使用SHodan模块的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">_shodan.options</td>
      <td style="text-align: center">数据收集期间使用的配置选项</td>
    </tr>
    <tr>
      <td style="text-align: center">_shodan.hostname</td>
      <td style="text-align: center">发送Web请求时使用的主机名</td>
    </tr>
    <tr>
      <td style="text-align: center">_shodan.options.referrer</td>
      <td style="text-align: center">为某端口/服务触发扫描的banner的惟一ID</td>
    </tr>
  </tbody>
</table>

<h3 id="例子-3">例子</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-01-16T08:37:40.081917"</span><span class="p">,</span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-01-16T08:37:40.081917"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"hostnames"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"hostnames"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"99-46-189-78.lightspeed.tukrga.sbcglobal.net""99-46-189-78.lightspeed.tukrga.sbcglobal.net"</span><span class="w">
   </span><span class="p">],],</span><span class="w">
   </span><span class="s2">"org"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AT&amp;T U-verse"</span><span class="p">,</span><span class="s2">"org"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AT&amp;T U-verse"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1664007502:75a821e2-7e89-11e3-8080-808080808080"</span><span class="p">,</span><span class="s2">"guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1664007502:75a821e2-7e89-11e3-8080-808080808080"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NTP</span><span class="se">\n</span><span class="s2">xxx.xxx.xxx.xxx:7546</span><span class="se">\n</span><span class="s2">68.94.157.2:123</span><span class="se">\n</span><span class="s2">68.94.156.17:123"</span><span class="p">,</span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NTP</span><span class="se">\n</span><span class="s2">xxx.xxx.xxx.xxx:7546</span><span class="se">\n</span><span class="s2">68.94.157.2:123</span><span class="se">\n</span><span class="s2">68.94.156.17:123"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
   </span><span class="s2">"isp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AT&amp;T U-verse"</span><span class="p">,</span><span class="s2">"isp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AT&amp;T U-verse"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"asn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AS7018"</span><span class="p">,</span><span class="s2">"asn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AS7018"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"country_code3"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="s2">"country_code3"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Atlanta"</span><span class="p">,</span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Atlanta"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30328"</span><span class="p">,</span><span class="s2">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30328"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-84.3972</span><span class="p">,</span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-84.3972</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="s2">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">33.93350000000001</span><span class="p">,</span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">33.93350000000001</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="s2">"country_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"area_code"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="s2">"area_code"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dma_code"</span><span class="p">:</span><span class="w"> </span><span class="mi">524</span><span class="p">,</span><span class="s2">"dma_code"</span><span class="p">:</span><span class="w"> </span><span class="mi">524</span><span class="p">,</span><span class="w">
      </span><span class="s2">"region_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="s2">"region_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
   </span><span class="p">},},</span><span class="w">
   </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">1664007502</span><span class="p">,</span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">1664007502</span><span class="p">,</span><span class="w">
   </span><span class="s2">"domains"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"domains"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"sbcglobal.net""sbcglobal.net"</span><span class="w">
   </span><span class="p">],],</span><span class="w">
   </span><span class="s2">"ip_str"</span><span class="p">:</span><span class="w"> </span><span class="s2">"99.46.189.78"</span><span class="p">,</span><span class="s2">"ip_str"</span><span class="p">:</span><span class="w"> </span><span class="s2">"99.46.189.78"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"opts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"opts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\\</span><span class="s2">x97</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x03*</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x03</span><span class="se">\\</span><span class="s2">x00H</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01G</span><span class="se">\\</span><span class="s2">x06</span><span class="se">\\</span><span class="s2">xa7</span><span class="se">\\</span><span class="s2">x8ec.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x1dz</span><span class="se">\\</span><span class="s2">x07</span><span class="se">\\</span><span class="s2">x02</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00q</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00i</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00XD^</span><span class="se">\\</span><span class="s2">x9d</span><span class="se">\\</span><span class="s2">x02c.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x00{</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00q</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00o</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00YD^</span><span class="se">\\</span><span class="s2">x9c</span><span class="se">\\</span><span class="s2">x11c.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x00{</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00"</span><span class="p">,</span><span class="s2">"raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\\</span><span class="s2">x97</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x03*</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x03</span><span class="se">\\</span><span class="s2">x00H</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01G</span><span class="se">\\</span><span class="s2">x06</span><span class="se">\\</span><span class="s2">xa7</span><span class="se">\\</span><span class="s2">x8ec.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x1dz</span><span class="se">\\</span><span class="s2">x07</span><span class="se">\\</span><span class="s2">x02</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00q</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00i</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00XD^</span><span class="se">\\</span><span class="s2">x9d</span><span class="se">\\</span><span class="s2">x02c.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x00{</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00q</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00o</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00YD^</span><span class="se">\\</span><span class="s2">x9c</span><span class="se">\\</span><span class="s2">x11c.</span><span class="se">\\</span><span class="s2">xbdN</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x01</span><span class="se">\\</span><span class="s2">x00{</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x04</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00</span><span class="se">\\</span><span class="s2">x00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ntp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"ntp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="s2">"more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="s2">"more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}}</span><span class="w">
   </span><span class="p">}}</span><span class="w">
</span><span class="p">}}</span><span class="w">

</span></code></pre></div></div>

<h2 id="附录b搜索语法关键词列表">附录B：搜索语法关键词列表</h2>

<h3 id="常用语法">常用语法</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">过滤器名</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
      <th style="text-align: center">举例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">after</td>
      <td style="text-align: center">只显示给出日期之后的结果(dd/mm/yyyy)</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">after:"04/02/2017"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">asn</td>
      <td style="text-align: center">自治系统号码</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">asn:"AS4130"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">before</td>
      <td style="text-align: center">只显示给出日期之前的结果(dd/mm/yyyy)</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">before:"04/02/2017"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">category</td>
      <td style="text-align: center">现有的分类：ics,malware</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">category:"malware"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">city</td>
      <td style="text-align: center">城市的名字</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">city:"San Diego"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">country</td>
      <td style="text-align: center">国家简写</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">country:"ES"</code> <code class="highlighter-rouge">country:"CN"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">geo</td>
      <td style="text-align: center">经纬度</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">geo:"46.9481,7.4474"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">hash</td>
      <td style="text-align: center">数据的hash值</td>
      <td style="text-align: center">int</td>
      <td style="text-align: center"><code class="highlighter-rouge">-hash:0</code></td>
    </tr>
    <tr>
      <td style="text-align: center">has_ipv6</td>
      <td style="text-align: center">是否是IPv6</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center"><code class="highlighter-rouge">has_ipv6:true</code></td>
    </tr>
    <tr>
      <td style="text-align: center">has_screenshot</td>
      <td style="text-align: center">是否有截图</td>
      <td style="text-align: center">boolean</td>
      <td style="text-align: center"><code class="highlighter-rouge">has_screenshot:true</code></td>
    </tr>
    <tr>
      <td style="text-align: center">hostname</td>
      <td style="text-align: center">主机名或域名</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">hostname:"google"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">ip</td>
      <td style="text-align: center">ip地址</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">ip:"54.67.82.248 "</code></td>
    </tr>
    <tr>
      <td style="text-align: center">isp</td>
      <td style="text-align: center">ISP供应商</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">isp:"China Telecom"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">org</td>
      <td style="text-align: center">组织或公司</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">org:"google"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">os</td>
      <td style="text-align: center">操作系统</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">os:"Windows 7 or 8"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">port</td>
      <td style="text-align: center">端口号</td>
      <td style="text-align: center">int</td>
      <td style="text-align: center"><code class="highlighter-rouge">port:21</code></td>
    </tr>
    <tr>
      <td style="text-align: center">postal</td>
      <td style="text-align: center">邮政编码(仅限于美国)</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">postal:"98221"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">product</td>
      <td style="text-align: center">软件、平台</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">product:"Apache httpd"</code> <code class="highlighter-rouge">product:"openssh"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">region</td>
      <td style="text-align: center">地区或国家别名</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: center">state</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">string</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: center">net</td>
      <td style="text-align: center">CIDR格式的IP地址</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">net:190.30.40.0/24</code></td>
    </tr>
    <tr>
      <td style="text-align: center">version</td>
      <td style="text-align: center">软件版本</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">version:"2.6.1"</code></td>
    </tr>
    <tr>
      <td style="text-align: center">vuln</td>
      <td style="text-align: center">漏洞的CVE ID</td>
      <td style="text-align: center">string</td>
      <td style="text-align: center"><code class="highlighter-rouge">vuln:CVE-2014-0723</code></td>
    </tr>
  </tbody>
</table>

<h4 id="http过滤器">HTTP过滤器</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">http.component</td>
      <td style="text-align: center">网站上所使用的网络技术名称</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">http.component_category</td>
      <td style="text-align: center">网站上使用的网络组件的类别</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">http.html</td>
      <td style="text-align: center">Web banner</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">http.html_hash</td>
      <td style="text-align: center">网站HTML的哈希值</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">http.status</td>
      <td style="text-align: center">响应状态码</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">http.title</td>
      <td style="text-align: center">网站title得banner</td>
      <td style="text-align: center">string</td>
    </tr>
  </tbody>
</table>

<h4 id="ntp-过滤器">NTP 过滤器</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ntp.ip</td>
      <td style="text-align: center">查找在其monlist中NTP服务器的IP</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.ip_count</td>
      <td style="text-align: center">初始monlist返回的IP数量</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.more</td>
      <td style="text-align: center">真/假; monlist集是否有更多的IP地址</td>
      <td style="text-align: center">boolean</td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.port</td>
      <td style="text-align: center">monlist中的IP地址使用的端口</td>
      <td style="text-align: center">int</td>
    </tr>
  </tbody>
</table>

<h4 id="ssl过滤器">SSL过滤器</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">has_ssl</td>
      <td style="text-align: center">有无SSL</td>
      <td style="text-align: center">boolean</td>
    </tr>
    <tr>
      <td style="text-align: center">SSL</td>
      <td style="text-align: center">搜索所有SSL的数据</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.alpn</td>
      <td style="text-align: center">诸如HTTP/2的应用层协议</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.chain_count</td>
      <td style="text-align: center">链中的证书数量</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.version</td>
      <td style="text-align: center">可能的值：SSLv2，SSLv3，TLSv1，TLSv1.1，TLSv1.2</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.alg</td>
      <td style="text-align: center">证书算法</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.expired</td>
      <td style="text-align: center">是否是过期证书</td>
      <td style="text-align: center">boolean</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.extension</td>
      <td style="text-align: center">证书中的扩展名</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.serial</td>
      <td style="text-align: center">序列号为整数或十六进制字符串</td>
      <td style="text-align: center">int/string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.pubkey.bits</td>
      <td style="text-align: center">公钥的位数</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.pubkey.type</td>
      <td style="text-align: center">公钥类型</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.version</td>
      <td style="text-align: center">SSL版本的首选密码</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.bits</td>
      <td style="text-align: center">首选密码中的位数</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.name</td>
      <td style="text-align: center">首选密码的名称</td>
      <td style="text-align: center">string</td>
    </tr>
  </tbody>
</table>

<h4 id="telnet-过滤器">Telnet 过滤器</h4>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">telnet.option</td>
      <td style="text-align: center">搜索所有选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.do</td>
      <td style="text-align: center">对方执行的请求或期望对方执行指示的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.dont</td>
      <td style="text-align: center">对方停止执行的请求或不再期望对方执行指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.will</td>
      <td style="text-align: center">确认现在正在执行指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.wont</td>
      <td style="text-align: center">表示拒绝执行或继续执行指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
  </tbody>
</table>

<h2 id="附录cfacets搜索">附录C：Facets搜索</h2>

<h3 id="常用facets">常用Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">asn</td>
      <td style="text-align: center">自治系统号码</td>
    </tr>
    <tr>
      <td style="text-align: center">city</td>
      <td style="text-align: center">城市的全名</td>
    </tr>
    <tr>
      <td style="text-align: center">country</td>
      <td style="text-align: center">国家的全名</td>
    </tr>
    <tr>
      <td style="text-align: center">domain</td>
      <td style="text-align: center">设备的域名</td>
    </tr>
    <tr>
      <td style="text-align: center">has_screenshot</td>
      <td style="text-align: center">有无可用的截图</td>
    </tr>
    <tr>
      <td style="text-align: center">isp</td>
      <td style="text-align: center">ISP管理网络块</td>
    </tr>
    <tr>
      <td style="text-align: center">link</td>
      <td style="text-align: center">网络连接的类型</td>
    </tr>
    <tr>
      <td style="text-align: center">org</td>
      <td style="text-align: center">拥有该网块的组织</td>
    </tr>
    <tr>
      <td style="text-align: center">os</td>
      <td style="text-align: center">操作系统</td>
    </tr>
    <tr>
      <td style="text-align: center">port</td>
      <td style="text-align: center">服务的端口号</td>
    </tr>
    <tr>
      <td style="text-align: center">postal</td>
      <td style="text-align: center">邮政编码</td>
    </tr>
    <tr>
      <td style="text-align: center">product</td>
      <td style="text-align: center">软件/产品的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">region</td>
      <td style="text-align: center">地区/国家的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">state</td>
      <td style="text-align: center">区域的别名</td>
    </tr>
    <tr>
      <td style="text-align: center">uptime</td>
      <td style="text-align: center">主机启动的时间(以秒为单位计算)</td>
    </tr>
    <tr>
      <td style="text-align: center">vuln</td>
      <td style="text-align: center">漏洞的CVE ID</td>
    </tr>
  </tbody>
</table>

<h3 id="http-facets">HTTP Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">http.component</td>
      <td style="text-align: center">网站上使用的网络技术的名称</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">http.component_category</td>
      <td style="text-align: center">网站上使用的网络组件的类别</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">http.html_hash</td>
      <td style="text-align: center">HTML网站的哈希值</td>
      <td style="text-align: center">int</td>
    </tr>
    <tr>
      <td style="text-align: center">http.status</td>
      <td style="text-align: center">响应状态码</td>
      <td style="text-align: center">int</td>
    </tr>
  </tbody>
</table>

<h3 id="ntp-facets">NTP Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ntp.ip</td>
      <td style="text-align: center">monlist返回的IP地址</td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.ip_count</td>
      <td style="text-align: center">初始monlist返回的IP数量</td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.more</td>
      <td style="text-align: center">真假; monlist收集的是否有更多的IP地址</td>
    </tr>
    <tr>
      <td style="text-align: center">ntp.port</td>
      <td style="text-align: center">monlist中的IP地址使用的端口</td>
    </tr>
  </tbody>
</table>

<h3 id="ssh-facets">SSH Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ssh.cipher</td>
      <td style="text-align: center">密码的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.fingerprint</td>
      <td style="text-align: center">设备的指纹</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.mac</td>
      <td style="text-align: center">使用的MAC算法名称（例如：hmac-sha1）</td>
    </tr>
    <tr>
      <td style="text-align: center">ssh.type</td>
      <td style="text-align: center">认证密钥的类型（例如：ssh-rsa）</td>
    </tr>
  </tbody>
</table>

<h3 id="ssl-facets">SSL Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ssl.version</td>
      <td style="text-align: center">支持SSL版本</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.alpn</td>
      <td style="text-align: center">应用层协议</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.chain_count</td>
      <td style="text-align: center">链中的证书数量</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.alg</td>
      <td style="text-align: center">证书算法</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.expired</td>
      <td style="text-align: center">真假; 证书过期与否</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.serial</td>
      <td style="text-align: center">证书序列号为整数</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.extension</td>
      <td style="text-align: center">证书扩展名</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.pubkey.bits</td>
      <td style="text-align: center">公钥的位数</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cert.pubkey</td>
      <td style="text-align: center">公钥类型的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.bits</td>
      <td style="text-align: center">首选密码中的位数</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.name</td>
      <td style="text-align: center">首选密码的名称</td>
    </tr>
    <tr>
      <td style="text-align: center">ssl.cipher.version</td>
      <td style="text-align: center">SSL版本的首选密码</td>
    </tr>
  </tbody>
</table>

<h3 id="telnet-facets">Telnet Facets</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">名称</th>
      <th style="text-align: center">描述</th>
      <th style="text-align: center">类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">telnet.option</td>
      <td style="text-align: center">显示所有选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.do</td>
      <td style="text-align: center">对方执行的请求或期望对方执行指示的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.dont</td>
      <td style="text-align: center">对方停止执行的请求或不再期望对方执行指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.will</td>
      <td style="text-align: center">服务器支持指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
    <tr>
      <td style="text-align: center">telnet.wont</td>
      <td style="text-align: center">服务器不支持指定的选项</td>
      <td style="text-align: center">string</td>
    </tr>
  </tbody>
</table>

<h2 id="附录d端口列表">附录D：端口列表</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Port</th>
      <th style="text-align: right">Service</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">7</td>
      <td style="text-align: right">Echo</td>
    </tr>
    <tr>
      <td style="text-align: left">11</td>
      <td style="text-align: right">Systat</td>
    </tr>
    <tr>
      <td style="text-align: left">13</td>
      <td style="text-align: right">Daytime</td>
    </tr>
    <tr>
      <td style="text-align: left">15</td>
      <td style="text-align: right">Netstat</td>
    </tr>
    <tr>
      <td style="text-align: left">17</td>
      <td style="text-align: right">Quote of the day</td>
    </tr>
    <tr>
      <td style="text-align: left">19</td>
      <td style="text-align: right">Character generator</td>
    </tr>
    <tr>
      <td style="text-align: left">21</td>
      <td style="text-align: right">FTP</td>
    </tr>
    <tr>
      <td style="text-align: left">22</td>
      <td style="text-align: right">SSH</td>
    </tr>
    <tr>
      <td style="text-align: left">23</td>
      <td style="text-align: right">Telnet</td>
    </tr>
    <tr>
      <td style="text-align: left">25</td>
      <td style="text-align: right">SMTP</td>
    </tr>
    <tr>
      <td style="text-align: left">26</td>
      <td style="text-align: right">SSH</td>
    </tr>
    <tr>
      <td style="text-align: left">37</td>
      <td style="text-align: right">rdate</td>
    </tr>
    <tr>
      <td style="text-align: left">49</td>
      <td style="text-align: right">TACACS+</td>
    </tr>
    <tr>
      <td style="text-align: left">53</td>
      <td style="text-align: right">DNS</td>
    </tr>
    <tr>
      <td style="text-align: left">67</td>
      <td style="text-align: right">DHCP</td>
    </tr>
    <tr>
      <td style="text-align: left">69</td>
      <td style="text-align: right">TFTP, BitTorrent</td>
    </tr>
    <tr>
      <td style="text-align: left">70</td>
      <td style="text-align: right">Gopher</td>
    </tr>
    <tr>
      <td style="text-align: left">79</td>
      <td style="text-align: right">Finger</td>
    </tr>
    <tr>
      <td style="text-align: left">80</td>
      <td style="text-align: right">HTTP, malware</td>
    </tr>
    <tr>
      <td style="text-align: left">81</td>
      <td style="text-align: right">HTTP, malware</td>
    </tr>
    <tr>
      <td style="text-align: left">82</td>
      <td style="text-align: right">HTTP, malware</td>
    </tr>
    <tr>
      <td style="text-align: left">83</td>
      <td style="text-align: right">HTTP</td>
    </tr>
    <tr>
      <td style="text-align: left">84</td>
      <td style="text-align: right">HTTP</td>
    </tr>
    <tr>
      <td style="text-align: left">88</td>
      <td style="text-align: right">Kerberos</td>
    </tr>
    <tr>
      <td style="text-align: left">102</td>
      <td style="text-align: right">Siemens S7</td>
    </tr>
    <tr>
      <td style="text-align: left">104</td>
      <td style="text-align: right">DICOM</td>
    </tr>
    <tr>
      <td style="text-align: left">110</td>
      <td style="text-align: right">POP3</td>
    </tr>
    <tr>
      <td style="text-align: left">111</td>
      <td style="text-align: right">Portmapper</td>
    </tr>
    <tr>
      <td style="text-align: left">113</td>
      <td style="text-align: right">identd</td>
    </tr>
    <tr>
      <td style="text-align: left">119</td>
      <td style="text-align: right">NNTP</td>
    </tr>
    <tr>
      <td style="text-align: left">123</td>
      <td style="text-align: right">NTP</td>
    </tr>
    <tr>
      <td style="text-align: left">129</td>
      <td style="text-align: right">Password generator protocol</td>
    </tr>
    <tr>
      <td style="text-align: left">137</td>
      <td style="text-align: right">NetBIOS</td>
    </tr>
    <tr>
      <td style="text-align: left">143</td>
      <td style="text-align: right">IMAP</td>
    </tr>
    <tr>
      <td style="text-align: left">161</td>
      <td style="text-align: right">SNMP</td>
    </tr>
    <tr>
      <td style="text-align: left">175</td>
      <td style="text-align: right">IBM Network Job Entry</td>
    </tr>
    <tr>
      <td style="text-align: left">179</td>
      <td style="text-align: right">BGP</td>
    </tr>
    <tr>
      <td style="text-align: left">195</td>
      <td style="text-align: right">TA14-353a</td>
    </tr>
    <tr>
      <td style="text-align: left">311</td>
      <td style="text-align: right">OS X Server Manager</td>
    </tr>
    <tr>
      <td style="text-align: left">389</td>
      <td style="text-align: right">LDAP</td>
    </tr>
    <tr>
      <td style="text-align: left">389</td>
      <td style="text-align: right">CLDAP</td>
    </tr>
    <tr>
      <td style="text-align: left">443</td>
      <td style="text-align: right">HTTPS</td>
    </tr>
    <tr>
      <td style="text-align: left">443</td>
      <td style="text-align: right">QUIC</td>
    </tr>
    <tr>
      <td style="text-align: left">444</td>
      <td style="text-align: right">TA14-353a, Dell SonicWALL</td>
    </tr>
    <tr>
      <td style="text-align: left">445</td>
      <td style="text-align: right">SMB</td>
    </tr>
    <tr>
      <td style="text-align: left">465</td>
      <td style="text-align: right">SMTPS</td>
    </tr>
    <tr>
      <td style="text-align: left">500</td>
      <td style="text-align: right">IKE (VPN)</td>
    </tr>
    <tr>
      <td style="text-align: left">502</td>
      <td style="text-align: right">Modbus</td>
    </tr>
    <tr>
      <td style="text-align: left">503</td>
      <td style="text-align: right">Modbus</td>
    </tr>
    <tr>
      <td style="text-align: left">515</td>
      <td style="text-align: right">Line Printer Daemon</td>
    </tr>
    <tr>
      <td style="text-align: left">520</td>
      <td style="text-align: right">RIP</td>
    </tr>
    <tr>
      <td style="text-align: left">523</td>
      <td style="text-align: right">IBM DB2</td>
    </tr>
    <tr>
      <td style="text-align: left">554</td>
      <td style="text-align: right">RTSP</td>
    </tr>
    <tr>
      <td style="text-align: left">587</td>
      <td style="text-align: right">SMTP mail submission</td>
    </tr>
    <tr>
      <td style="text-align: left">623</td>
      <td style="text-align: right">IPMI</td>
    </tr>
    <tr>
      <td style="text-align: left">626</td>
      <td style="text-align: right">OS X serialnumbered</td>
    </tr>
    <tr>
      <td style="text-align: left">636</td>
      <td style="text-align: right">LDAPS</td>
    </tr>
    <tr>
      <td style="text-align: left">666</td>
      <td style="text-align: right">Telnet</td>
    </tr>
    <tr>
      <td style="text-align: left">771</td>
      <td style="text-align: right">Realport</td>
    </tr>
    <tr>
      <td style="text-align: left">789</td>
      <td style="text-align: right">Redlion Crimson3</td>
    </tr>
    <tr>
      <td style="text-align: left">873</td>
      <td style="text-align: right">rsync</td>
    </tr>
    <tr>
      <td style="text-align: left">902</td>
      <td style="text-align: right">VMWare authentication</td>
    </tr>
    <tr>
      <td style="text-align: left">992</td>
      <td style="text-align: right">Telnet (secure)</td>
    </tr>
    <tr>
      <td style="text-align: left">993</td>
      <td style="text-align: right">IMAP with SSL</td>
    </tr>
    <tr>
      <td style="text-align: left">995</td>
      <td style="text-align: right">POP3 with SSL</td>
    </tr>
    <tr>
      <td style="text-align: left">1010</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">1023</td>
      <td style="text-align: right">Telnet</td>
    </tr>
    <tr>
      <td style="text-align: left">1025</td>
      <td style="text-align: right">Kamstrup</td>
    </tr>
    <tr>
      <td style="text-align: left">1099</td>
      <td style="text-align: right">Java RMI</td>
    </tr>
    <tr>
      <td style="text-align: left">1177</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">1200</td>
      <td style="text-align: right">Codesys</td>
    </tr>
    <tr>
      <td style="text-align: left">1234</td>
      <td style="text-align: right">udpxy</td>
    </tr>
    <tr>
      <td style="text-align: left">1400</td>
      <td style="text-align: right">Sonos</td>
    </tr>
    <tr>
      <td style="text-align: left">1434</td>
      <td style="text-align: right">MS-SQL monitor</td>
    </tr>
    <tr>
      <td style="text-align: left">1515</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">1521</td>
      <td style="text-align: right">Oracle TNS</td>
    </tr>
    <tr>
      <td style="text-align: left">1604</td>
      <td style="text-align: right">Citrix, malware</td>
    </tr>
    <tr>
      <td style="text-align: left">1723</td>
      <td style="text-align: right">PPTP</td>
    </tr>
    <tr>
      <td style="text-align: left">1741</td>
      <td style="text-align: right">CiscoWorks</td>
    </tr>
    <tr>
      <td style="text-align: left">1833</td>
      <td style="text-align: right">MQTT</td>
    </tr>
    <tr>
      <td style="text-align: left">1900</td>
      <td style="text-align: right">UPnP</td>
    </tr>
    <tr>
      <td style="text-align: left">1911</td>
      <td style="text-align: right">Niagara Fox</td>
    </tr>
    <tr>
      <td style="text-align: left">1962</td>
      <td style="text-align: right">PCworx</td>
    </tr>
    <tr>
      <td style="text-align: left">1991</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">2000</td>
      <td style="text-align: right">iKettle, MikroTik bandwidth test</td>
    </tr>
    <tr>
      <td style="text-align: left">2081</td>
      <td style="text-align: right">Smarter Coffee</td>
    </tr>
    <tr>
      <td style="text-align: left">2082</td>
      <td style="text-align: right">cPanel</td>
    </tr>
    <tr>
      <td style="text-align: left">2083</td>
      <td style="text-align: right">cPanel</td>
    </tr>
    <tr>
      <td style="text-align: left">2086</td>
      <td style="text-align: right">WHM</td>
    </tr>
    <tr>
      <td style="text-align: left">2087</td>
      <td style="text-align: right">WHM</td>
    </tr>
    <tr>
      <td style="text-align: left">2123</td>
      <td style="text-align: right">GTPv1</td>
    </tr>
    <tr>
      <td style="text-align: left">2152</td>
      <td style="text-align: right">GTPv1</td>
    </tr>
    <tr>
      <td style="text-align: left">2181</td>
      <td style="text-align: right">Apache Zookeeper</td>
    </tr>
    <tr>
      <td style="text-align: left">2222</td>
      <td style="text-align: right">SSH, PLC5, EtherNet/IP</td>
    </tr>
    <tr>
      <td style="text-align: left">2323</td>
      <td style="text-align: right">Telnet</td>
    </tr>
    <tr>
      <td style="text-align: left">2332</td>
      <td style="text-align: right">Sierra wireless (Telnet)</td>
    </tr>
    <tr>
      <td style="text-align: left">2375</td>
      <td style="text-align: right">Docker</td>
    </tr>
    <tr>
      <td style="text-align: left">2376</td>
      <td style="text-align: right">Docker</td>
    </tr>
    <tr>
      <td style="text-align: left">2379</td>
      <td style="text-align: right">etcd</td>
    </tr>
    <tr>
      <td style="text-align: left">2404</td>
      <td style="text-align: right">IEC-104</td>
    </tr>
    <tr>
      <td style="text-align: left">2455</td>
      <td style="text-align: right">CoDeSys</td>
    </tr>
    <tr>
      <td style="text-align: left">2480</td>
      <td style="text-align: right">OrientDB</td>
    </tr>
    <tr>
      <td style="text-align: left">2628</td>
      <td style="text-align: right">Dictionary</td>
    </tr>
    <tr>
      <td style="text-align: left">3000</td>
      <td style="text-align: right">ntop</td>
    </tr>
    <tr>
      <td style="text-align: left">3260</td>
      <td style="text-align: right">iSCSI</td>
    </tr>
    <tr>
      <td style="text-align: left">3306</td>
      <td style="text-align: right">MySQL</td>
    </tr>
    <tr>
      <td style="text-align: left">3310</td>
      <td style="text-align: right">ClamAV</td>
    </tr>
    <tr>
      <td style="text-align: left">3386</td>
      <td style="text-align: right">GTPv1</td>
    </tr>
    <tr>
      <td style="text-align: left">3388</td>
      <td style="text-align: right">RDP</td>
    </tr>
    <tr>
      <td style="text-align: left">3389</td>
      <td style="text-align: right">RDP</td>
    </tr>
    <tr>
      <td style="text-align: left">3460</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">3541</td>
      <td style="text-align: right">PBX GUI</td>
    </tr>
    <tr>
      <td style="text-align: left">3542</td>
      <td style="text-align: right">PBX GUI</td>
    </tr>
    <tr>
      <td style="text-align: left">3689</td>
      <td style="text-align: right">DACP</td>
    </tr>
    <tr>
      <td style="text-align: left">3702</td>
      <td style="text-align: right">Onvif</td>
    </tr>
    <tr>
      <td style="text-align: left">3780</td>
      <td style="text-align: right">Metasploit</td>
    </tr>
    <tr>
      <td style="text-align: left">3787</td>
      <td style="text-align: right">Ventrilo</td>
    </tr>
    <tr>
      <td style="text-align: left">4000</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">4022</td>
      <td style="text-align: right">udpxy</td>
    </tr>
    <tr>
      <td style="text-align: left">4040</td>
      <td style="text-align: right">Deprecated Chef web interface</td>
    </tr>
    <tr>
      <td style="text-align: left">4063</td>
      <td style="text-align: right">ZeroC Glacier2</td>
    </tr>
    <tr>
      <td style="text-align: left">4064</td>
      <td style="text-align: right">ZeroC Glacier2 with SSL</td>
    </tr>
    <tr>
      <td style="text-align: left">4070</td>
      <td style="text-align: right">HID VertX/ Edge door controller</td>
    </tr>
    <tr>
      <td style="text-align: left">4157</td>
      <td style="text-align: right">DarkTrack RAT</td>
    </tr>
    <tr>
      <td style="text-align: left">4369</td>
      <td style="text-align: right">EPMD</td>
    </tr>
    <tr>
      <td style="text-align: left">4443</td>
      <td style="text-align: right">Symantec Data Center Security</td>
    </tr>
    <tr>
      <td style="text-align: left">4444</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">4500</td>
      <td style="text-align: right">IKE NAT-T (VPN)</td>
    </tr>
    <tr>
      <td style="text-align: left">4567</td>
      <td style="text-align: right">Modem web interface</td>
    </tr>
    <tr>
      <td style="text-align: left">4664</td>
      <td style="text-align: right">Qasar</td>
    </tr>
    <tr>
      <td style="text-align: left">4730</td>
      <td style="text-align: right">Gearman</td>
    </tr>
    <tr>
      <td style="text-align: left">4782</td>
      <td style="text-align: right">Qasar</td>
    </tr>
    <tr>
      <td style="text-align: left">4800</td>
      <td style="text-align: right">Moxa Nport</td>
    </tr>
    <tr>
      <td style="text-align: left">4840</td>
      <td style="text-align: right">OPC UA</td>
    </tr>
    <tr>
      <td style="text-align: left">4911</td>
      <td style="text-align: right">Niagara Fox with SSL</td>
    </tr>
    <tr>
      <td style="text-align: left">4949</td>
      <td style="text-align: right">Munin</td>
    </tr>
    <tr>
      <td style="text-align: left">5006</td>
      <td style="text-align: right">MELSEC-Q</td>
    </tr>
    <tr>
      <td style="text-align: left">5007</td>
      <td style="text-align: right">MELSEC-Q</td>
    </tr>
    <tr>
      <td style="text-align: left">5008</td>
      <td style="text-align: right">NetMobility</td>
    </tr>
    <tr>
      <td style="text-align: left">5009</td>
      <td style="text-align: right">Apple Airport Administration</td>
    </tr>
    <tr>
      <td style="text-align: left">5060</td>
      <td style="text-align: right">SIP</td>
    </tr>
    <tr>
      <td style="text-align: left">5094</td>
      <td style="text-align: right">HART-IP</td>
    </tr>
    <tr>
      <td style="text-align: left">5222</td>
      <td style="text-align: right">XMPP</td>
    </tr>
    <tr>
      <td style="text-align: left">5269</td>
      <td style="text-align: right">XMPP Server-to-Server</td>
    </tr>
    <tr>
      <td style="text-align: left">5353</td>
      <td style="text-align: right">mDNS</td>
    </tr>
    <tr>
      <td style="text-align: left">5357</td>
      <td style="text-align: right">Microsoft-HTTPAPI/2.0</td>
    </tr>
    <tr>
      <td style="text-align: left">5432</td>
      <td style="text-align: right">PostgreSQL</td>
    </tr>
    <tr>
      <td style="text-align: left">5577</td>
      <td style="text-align: right">Flux LED</td>
    </tr>
    <tr>
      <td style="text-align: left">5601</td>
      <td style="text-align: right">Kibana</td>
    </tr>
    <tr>
      <td style="text-align: left">5632</td>
      <td style="text-align: right">PCAnywhere</td>
    </tr>
    <tr>
      <td style="text-align: left">5672</td>
      <td style="text-align: right">RabbitMQ</td>
    </tr>
    <tr>
      <td style="text-align: left">5900</td>
      <td style="text-align: right">VNC</td>
    </tr>
    <tr>
      <td style="text-align: left">5901</td>
      <td style="text-align: right">VNC</td>
    </tr>
    <tr>
      <td style="text-align: left">5938</td>
      <td style="text-align: right">TeamViewer</td>
    </tr>
    <tr>
      <td style="text-align: left">5984</td>
      <td style="text-align: right">CouchDB</td>
    </tr>
    <tr>
      <td style="text-align: left">6000</td>
      <td style="text-align: right">X11</td>
    </tr>
    <tr>
      <td style="text-align: left">6001</td>
      <td style="text-align: right">X11</td>
    </tr>
    <tr>
      <td style="text-align: left">6379</td>
      <td style="text-align: right">Redis</td>
    </tr>
    <tr>
      <td style="text-align: left">6666</td>
      <td style="text-align: right">Voldemort database, malware</td>
    </tr>
    <tr>
      <td style="text-align: left">6667</td>
      <td style="text-align: right">IRC</td>
    </tr>
    <tr>
      <td style="text-align: left">6881</td>
      <td style="text-align: right">BitTorrent DHT</td>
    </tr>
    <tr>
      <td style="text-align: left">6969</td>
      <td style="text-align: right">TFTP, BitTorrent</td>
    </tr>
    <tr>
      <td style="text-align: left">7218</td>
      <td style="text-align: right">Sierra wireless (Telnet)</td>
    </tr>
    <tr>
      <td style="text-align: left">7474</td>
      <td style="text-align: right">Neo4j database</td>
    </tr>
    <tr>
      <td style="text-align: left">7548</td>
      <td style="text-align: right">CWMP (HTTPS)</td>
    </tr>
    <tr>
      <td style="text-align: left">7777</td>
      <td style="text-align: right">Oracle</td>
    </tr>
    <tr>
      <td style="text-align: left">7779</td>
      <td style="text-align: right">Dell Service Tag API</td>
    </tr>
    <tr>
      <td style="text-align: left">8008</td>
      <td style="text-align: right">Chromecast</td>
    </tr>
    <tr>
      <td style="text-align: left">8009</td>
      <td style="text-align: right">Vizio HTTPS</td>
    </tr>
    <tr>
      <td style="text-align: left">8010</td>
      <td style="text-align: right">Intelbras DVR</td>
    </tr>
    <tr>
      <td style="text-align: left">8060</td>
      <td style="text-align: right">Roku web interface</td>
    </tr>
    <tr>
      <td style="text-align: left">8069</td>
      <td style="text-align: right">OpenERP</td>
    </tr>
    <tr>
      <td style="text-align: left">8087</td>
      <td style="text-align: right">Riak</td>
    </tr>
    <tr>
      <td style="text-align: left">8090</td>
      <td style="text-align: right">Insteon HUB</td>
    </tr>
    <tr>
      <td style="text-align: left">8099</td>
      <td style="text-align: right">Yahoo SmartTV</td>
    </tr>
    <tr>
      <td style="text-align: left">8112</td>
      <td style="text-align: right">Deluge (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">8126</td>
      <td style="text-align: right">StatsD</td>
    </tr>
    <tr>
      <td style="text-align: left">8139</td>
      <td style="text-align: right">Puppet agent</td>
    </tr>
    <tr>
      <td style="text-align: left">8140</td>
      <td style="text-align: right">Puppet master</td>
    </tr>
    <tr>
      <td style="text-align: left">8181</td>
      <td style="text-align: right">GlassFish Server (HTTPS)</td>
    </tr>
    <tr>
      <td style="text-align: left">8333</td>
      <td style="text-align: right">Bitcoin</td>
    </tr>
    <tr>
      <td style="text-align: left">8334</td>
      <td style="text-align: right">Bitcoin node dashboard (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">8443</td>
      <td style="text-align: right">HTTPS</td>
    </tr>
    <tr>
      <td style="text-align: left">8554</td>
      <td style="text-align: right">RTSP</td>
    </tr>
    <tr>
      <td style="text-align: left">8800</td>
      <td style="text-align: right">HTTP</td>
    </tr>
    <tr>
      <td style="text-align: left">8880</td>
      <td style="text-align: right">Websphere SOAP</td>
    </tr>
    <tr>
      <td style="text-align: left">8888</td>
      <td style="text-align: right">HTTP, Andromouse</td>
    </tr>
    <tr>
      <td style="text-align: left">8889</td>
      <td style="text-align: right">SmartThings Remote Access</td>
    </tr>
    <tr>
      <td style="text-align: left">9000</td>
      <td style="text-align: right">Vizio HTTPS</td>
    </tr>
    <tr>
      <td style="text-align: left">9001</td>
      <td style="text-align: right">Tor OR</td>
    </tr>
    <tr>
      <td style="text-align: left">9002</td>
      <td style="text-align: right">Tor OR</td>
    </tr>
    <tr>
      <td style="text-align: left">9009</td>
      <td style="text-align: right">Julia</td>
    </tr>
    <tr>
      <td style="text-align: left">9042</td>
      <td style="text-align: right">Cassandra CQL</td>
    </tr>
    <tr>
      <td style="text-align: left">9051</td>
      <td style="text-align: right">Tor Control</td>
    </tr>
    <tr>
      <td style="text-align: left">9100</td>
      <td style="text-align: right">Printer Job Language</td>
    </tr>
    <tr>
      <td style="text-align: left">9151</td>
      <td style="text-align: right">Tor Control</td>
    </tr>
    <tr>
      <td style="text-align: left">9160</td>
      <td style="text-align: right">Apache Cassandra</td>
    </tr>
    <tr>
      <td style="text-align: left">9191</td>
      <td style="text-align: right">Sierra wireless (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">9418</td>
      <td style="text-align: right">Git</td>
    </tr>
    <tr>
      <td style="text-align: left">9443</td>
      <td style="text-align: right">Sierra wireless (HTTPS)</td>
    </tr>
    <tr>
      <td style="text-align: left">9595</td>
      <td style="text-align: right">LANDesk Management Agent</td>
    </tr>
    <tr>
      <td style="text-align: left">9600</td>
      <td style="text-align: right">OMRON</td>
    </tr>
    <tr>
      <td style="text-align: left">9633</td>
      <td style="text-align: right">DarkTrack RAT</td>
    </tr>
    <tr>
      <td style="text-align: left">9869</td>
      <td style="text-align: right">OpenNebula</td>
    </tr>
    <tr>
      <td style="text-align: left">10001</td>
      <td style="text-align: right">Automated Tank Gauge</td>
    </tr>
    <tr>
      <td style="text-align: left">10001</td>
      <td style="text-align: right">Ubiquiti</td>
    </tr>
    <tr>
      <td style="text-align: left">10243</td>
      <td style="text-align: right">Microsoft-HTTPAPI/2.0</td>
    </tr>
    <tr>
      <td style="text-align: left">10554</td>
      <td style="text-align: right">RTSP</td>
    </tr>
    <tr>
      <td style="text-align: left">11211</td>
      <td style="text-align: right">Memcache</td>
    </tr>
    <tr>
      <td style="text-align: left">12345</td>
      <td style="text-align: right">malware</td>
    </tr>
    <tr>
      <td style="text-align: left">17000</td>
      <td style="text-align: right">Bose SoundTouch</td>
    </tr>
    <tr>
      <td style="text-align: left">17185</td>
      <td style="text-align: right">VxWorks WDBRPC</td>
    </tr>
    <tr>
      <td style="text-align: left">12345</td>
      <td style="text-align: right">Sierra wireless (Telnet)</td>
    </tr>
    <tr>
      <td style="text-align: left">11300</td>
      <td style="text-align: right">Beanstalk</td>
    </tr>
    <tr>
      <td style="text-align: left">13579</td>
      <td style="text-align: right">Media player classic web interface</td>
    </tr>
    <tr>
      <td style="text-align: left">14147</td>
      <td style="text-align: right">Filezilla FTP</td>
    </tr>
    <tr>
      <td style="text-align: left">16010</td>
      <td style="text-align: right">Apache Hbase</td>
    </tr>
    <tr>
      <td style="text-align: left">16992</td>
      <td style="text-align: right">Intel AMT</td>
    </tr>
    <tr>
      <td style="text-align: left">16993</td>
      <td style="text-align: right">Intel AMT</td>
    </tr>
    <tr>
      <td style="text-align: left">18245</td>
      <td style="text-align: right">General Electric SRTP</td>
    </tr>
    <tr>
      <td style="text-align: left">20000</td>
      <td style="text-align: right">DNP3</td>
    </tr>
    <tr>
      <td style="text-align: left">20547</td>
      <td style="text-align: right">ProconOS</td>
    </tr>
    <tr>
      <td style="text-align: left">21025</td>
      <td style="text-align: right">Starbound</td>
    </tr>
    <tr>
      <td style="text-align: left">21379</td>
      <td style="text-align: right">Matrikon OPC</td>
    </tr>
    <tr>
      <td style="text-align: left">23023</td>
      <td style="text-align: right">Telnet</td>
    </tr>
    <tr>
      <td style="text-align: left">23424</td>
      <td style="text-align: right">Serviio</td>
    </tr>
    <tr>
      <td style="text-align: left">25105</td>
      <td style="text-align: right">Insteon Hub</td>
    </tr>
    <tr>
      <td style="text-align: left">25565</td>
      <td style="text-align: right">Minecraft</td>
    </tr>
    <tr>
      <td style="text-align: left">27015</td>
      <td style="text-align: right">Steam A2S server query, Steam RCon</td>
    </tr>
    <tr>
      <td style="text-align: left">27016</td>
      <td style="text-align: right">Steam A2S server query</td>
    </tr>
    <tr>
      <td style="text-align: left">27017</td>
      <td style="text-align: right">MongoDB</td>
    </tr>
    <tr>
      <td style="text-align: left">28015</td>
      <td style="text-align: right">Steam A2S server query</td>
    </tr>
    <tr>
      <td style="text-align: left">28017</td>
      <td style="text-align: right">MongoDB (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">30313</td>
      <td style="text-align: right">Gardasoft Lighting</td>
    </tr>
    <tr>
      <td style="text-align: left">30718</td>
      <td style="text-align: right">Lantronix Setup</td>
    </tr>
    <tr>
      <td style="text-align: left">32400</td>
      <td style="text-align: right">Plex</td>
    </tr>
    <tr>
      <td style="text-align: left">37777</td>
      <td style="text-align: right">Dahuva DVR</td>
    </tr>
    <tr>
      <td style="text-align: left">44818</td>
      <td style="text-align: right">EtherNet/IP</td>
    </tr>
    <tr>
      <td style="text-align: left">47808</td>
      <td style="text-align: right">Bacnet</td>
    </tr>
    <tr>
      <td style="text-align: left">49152</td>
      <td style="text-align: right">Supermicro (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">49153</td>
      <td style="text-align: right">WeMo Link</td>
    </tr>
    <tr>
      <td style="text-align: left">50070</td>
      <td style="text-align: right">HDFS Namenode</td>
    </tr>
    <tr>
      <td style="text-align: left">51106</td>
      <td style="text-align: right">Deluge (HTTP)</td>
    </tr>
    <tr>
      <td style="text-align: left">53413</td>
      <td style="text-align: right">Netis backdoor</td>
    </tr>
    <tr>
      <td style="text-align: left">54138</td>
      <td style="text-align: right">Toshiba PoS</td>
    </tr>
    <tr>
      <td style="text-align: left">55443</td>
      <td style="text-align: right">McAfee</td>
    </tr>
    <tr>
      <td style="text-align: left">55553</td>
      <td style="text-align: right">Metasploit</td>
    </tr>
    <tr>
      <td style="text-align: left">55554</td>
      <td style="text-align: right">Metasploit</td>
    </tr>
    <tr>
      <td style="text-align: left">62078</td>
      <td style="text-align: right">Apple iDevice</td>
    </tr>
    <tr>
      <td style="text-align: left">64738</td>
      <td style="text-align: right">Mumble</td>
    </tr>
  </tbody>
</table>

<h2 id="附录e-ssl-banner示例">附录E: SSL banner示例</h2>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"hostnames"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">2928565374</span><span class="p">,</span><span class="w">
    </span><span class="s2">"isp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iWeb Technologies"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transport"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTP/1.1 200 OK</span><span class="se">\r\n</span><span class="s2">Expires: Sat, 26 Mar 2016 11:56:36 GMT</span><span class="se">\r\n</span><span class="s2">Expire</span><span class="err">\</span><span class="s2">
s: Fri, 28 May 1999 00:00:00 GMT</span><span class="se">\r\n</span><span class="s2">Cache-Control: max-age=2592000</span><span class="se">\r\n</span><span class="s2">Cache-Cont</span><span class="err">\</span><span class="s2">
rol: no-store, no-cache, must-revalidate</span><span class="se">\r\n</span><span class="s2">Cache-Control: post-check=0, pre-che</span><span class="err">\</span><span class="s2">
ck=0</span><span class="se">\r\n</span><span class="s2">Last-Modified: Thu, 25 Feb 2016 11:56:36 GMT</span><span class="se">\r\n</span><span class="s2">Pragma: no-cache</span><span class="se">\r\n</span><span class="s2">P3P:</span><span class="err">\</span><span class="s2">
 CP=</span><span class="se">\"</span><span class="s2">NON COR CURa ADMa OUR NOR UNI COM NAV STA</span><span class="se">\"\r\n</span><span class="s2">Content-type: text/html</span><span class="se">\r\n</span><span class="err">\</span><span class="s2">
Transfer-Encoding: chunked</span><span class="se">\r\n</span><span class="s2">Date: Thu, 25 Feb 2016 11:56:36 GMT</span><span class="se">\r\n</span><span class="s2">Server: sw-</span><span class="err">\</span><span class="s2">
cp-server</span><span class="se">\r\n\r\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"asn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AS32613"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">8443</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ssl"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"chain"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"-----BEGIN CERTIFICATE-----</span><span class="se">\n</span><span class="s2">MIIDszCCApsCBFBTb4swDQYJKoZIhvcN</span><span class="err">\</span><span class="s2">
AQEFBQAwgZ0xCzAJBgNVBAYTAlVTMREw</span><span class="se">\n</span><span class="s2">DwYDVQQIEwhWaXJnaW5pYTEQMA4GA1UEBxMHSGVybmRvbj</span><span class="err">\</span><span class="s2">
ESMBAGA1UEChMJUGFy</span><span class="se">\n</span><span class="s2">YWxsZWxzMRgwFgYDVQQLEw9QYXJhbGxlbHMgUGFuZWwxGDAWBgNVBAMTD1Bh</span><span class="err">\</span><span class="s2">
cmFs</span><span class="se">\n</span><span class="s2">bGVscyBQYW5lbDEhMB8GCSqGSIb3DQEJARYSaW5mb0BwYXJhbGxlbHMuY29tMB4X</span><span class="se">\n</span><span class="s2">DTEyMDkx</span><span class="err">\</span><span class="s2">
NDE3NTUyM1oXDTEzMDkxNDE3NTUyM1owgZ0xCzAJBgNVBAYTAlVTMREw</span><span class="se">\n</span><span class="s2">DwYDVQQIEwhWaXJnaW5pYT</span><span class="err">\</span><span class="s2">
EQMA4GA1UEBxMHSGVybmRvbjESMBAGA1UEChMJUGFy</span><span class="se">\n</span><span class="s2">YWxsZWxzMRgwFgYDVQQLEw9QYXJhbGxlbHMg</span><span class="err">\</span><span class="s2">
UGFuZWwxGDAWBgNVBAMTD1BhcmFs</span><span class="se">\n</span><span class="s2">bGVscyBQYW5lbDEhMB8GCSqGSIb3DQEJARYSaW5mb0BwYXJhbG</span><span class="err">\</span><span class="s2">
xlbHMuY29tMIIB</span><span class="se">\n</span><span class="s2">IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxc9Vy/qajKtFFnHxGOFPHTxm</span><span class="err">\</span><span class="s2">
</span><span class="se">\n</span><span class="s2">SOnsffWBTBfyXnK3h8u041VxvZDh3XkpA+ptg2fWOuIT0TTYuqw+tqiDmg8YTsHy</span><span class="se">\n</span><span class="s2">jcpMFBtXV2cV</span><span class="err">\</span><span class="s2">
dhKXaS3YYlM7dP3gMmkGmH+ZvCgCYc7L9MIJxYJy6Zeuh67YxEMV</span><span class="se">\n</span><span class="s2">giU8mZpvc70Cg5WeW1uBCXtUAi</span><span class="err">\</span><span class="s2">
jDLsVWnhsV3YuxlweEvkRpAk3EHehKbvgMnEZS</span><span class="se">\n</span><span class="s2">Q30QySe0GAqC7bWzKrwsJAOUk/+Js18+3QKb/LmD</span><span class="err">\</span><span class="s2">
a9cRjtFCTo6hYfPbfHj8RxQh</span><span class="se">\n</span><span class="s2">4Xmnn/CtZ48wRQTqKXSO6+Zk3OuU7/jX1Gt/jxN6n77673e6uCsggT</span><span class="err">\</span><span class="s2">
wut/EtNwID</span><span class="se">\n</span><span class="s2">AQABMA0GCSqGSIb3DQEBBQUAA4IBAQBb/yTy76Ykwr7DBOPAXc766n73OsZizjAt</span><span class="se">\n</span><span class="s2">1k</span><span class="err">\</span><span class="s2">
mx7LxgN3X/wFxD53ir+sdOqbPgJl3edrE/ZG9dNl6LhUBbUK+9s6z9QicEfSxo</span><span class="se">\n</span><span class="s2">4uQpFSywbGGmXInE</span><span class="err">\</span><span class="s2">
ZmyT4SsOLi/hNgy68f49LO1h6rn/p7QgIKd31g7189ZfFkFb</span><span class="se">\n</span><span class="s2">RdD49s1l/Cc5Nm4XapUVvmnS91MlPk</span><span class="err">\</span><span class="s2">
/OOIg1Lu1rYkuc8sIoZdPbep52H3Ga7TjG</span><span class="se">\n</span><span class="s2">kmO7nUIii0goB7TQ63mU67+NWHAmQQ8CtCDCN49kJyen</span><span class="err">\</span><span class="s2">
1WFjD6Je2U4q0IFQrxHw</span><span class="se">\n</span><span class="s2">My+tquo/n/sa+NV8QOj1gMVcFsLhYm7Z5ZONg0QFXSAL+Eyj/AwZ</span><span class="se">\n</span><span class="s2">----</span><span class="err">\</span><span class="s2">
-END CERTIFICATE-----</span><span class="se">\n</span><span class="s2">"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"cipher"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TLSv1/SSLv3"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DHE-RSA-AES256-GCM-SHA384"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"alpn"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"dhparams"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"prime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b10b8f96a080e01dde92de5eae5d54ec52c99fbcfb06a3c69a6a9dca52</span><span class="err">\</span><span class="s2">
d23b616073e28675a23d189838ef1e2ee652c013ecb4aea906112324975c3cd49b83bfaccbdd7d90</span><span class="err">\</span><span class="s2">
c4bd7098488e9c219a73724effd6fae5644738faa31a4ff55bccc0a151af5f0dc8b4bd45bf35c1a65e68cfda76d4da708df1fb2bc2e4a4371"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"public_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2e30a6e455730b2f24bdaf5986b9f0876068d4aa7a4e15c9a1b9c</span><span class="err">\</span><span class="s2">
a05a420e8fd3b496f7781a9423d3475f0bedee83f0391aaa95a738c8f0e250a8869a86d41bdb0194</span><span class="err">\</span><span class="s2">
66dba5c641e4b2b4b82db4cc2d4ea8d9804ec00514f30a4b6ce170b81c3e1ce4b3d17647c8e5b8f6</span><span class="err">\</span><span class="s2">
65bb7f588100bcc9a447d34d728c3709fd8a5b7753b"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"bits"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
            </span><span class="s2">"generator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a4d1cbd5c3fd34126765a442efb99905f8104dd258ac507fd6406c</span><span class="err">\</span><span class="s2">
ff14266d31266fea1e5c41564b777e690f5504f213160217b4b01b886a5e91547f9e2749f4d7fbd7</span><span class="err">\</span><span class="s2">
d3b9a92ee1909d0d2263f80a76a6a24c087a091f531dbf0a0169b6a28ad662a4d18e73afa32d779d</span><span class="err">\</span><span class="s2">
5918d08bc8858f4dcef97c2a24855e6eeb22b3b2e5"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RFC5114/1024-bit MODP Group with 160-bit Prime Order</span><span class="err">\</span><span class="s2">
 Subgroup"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"versions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"TLSv1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-SSLv2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SSLv3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"TLSv1.1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"TLSv1.2"</span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"html"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\n\t\t</span><span class="s2">&lt;html&gt;&lt;head&gt;</span><span class="se">\n\t\t</span><span class="s2">&lt;meta charset=</span><span class="se">\"</span><span class="s2">utf-8</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\t\t</span><span class="s2">&lt;meta http-eq</span><span class="err">\</span><span class="s2">
uiv=</span><span class="se">\"</span><span class="s2">X-UA-Compatible</span><span class="se">\"</span><span class="s2"> 
content=</span><span class="se">\"</span><span class="s2">IE=edge,chrome=1</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n\t\t</span><span class="s2">&lt;title&gt;&lt;/title&gt;</span><span class="se">\n\t\t</span><span class="err">\</span><span class="s2">
&lt;script language=</span><span class="se">\"</span><span class="s2">javascript</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2"> src=</span><span class="se">\"</span><span class="s2">/javascript/commo</span><span class="err">\</span><span class="s2">
n.js?plesk_version=psa-11.0.9-110120608.16</span><span class="se">\"</span><span class="s2">/&gt;&lt;/script&gt;</span><span class="se">\n\t\t</span><span class="s2">&lt;script language=</span><span class="se">\"</span><span class="err">\</span><span class="s2">
javascript</span><span class="se">\"</span><span class="s2"> type=</span><span class="se">\"</span><span class="s2">text/javascript</span><span class="se">\"</span><span class="s2"> src=</span><span class="se">\"</span><span class="s2">/javascript/prototype.js?plesk_versi</span><span class="err">\</span><span class="s2">
on=psa-11.0.9-110120608.16</span><span class="se">\"</span><span class="s2">&gt;&lt;/script&gt;</span><span class="se">\n\t\t</span><span class="s2">&lt;script&gt;</span><span class="se">\n\t\t\t</span><span class="s2">var opt_no_frames = </span><span class="err">\</span><span class="s2">
false;</span><span class="se">\n\t\t\t</span><span class="s2">var opt_integrated_mode = false;</span><span class="se">\n\t\t</span><span class="s2">&lt;/script&gt;</span><span class="se">\n\t\t\n\t\t</span><span class="s2">&lt;/head&gt;</span><span class="err">\</span><span class="s2">
&lt;body onLoad=</span><span class="se">\"</span><span class="s2">;top.location='/login.php3?window_id=&amp;amp;requested_url=https%3A%</span><span class="err">\</span><span class="s2">
2F%2F174.142.92.126%3A8443%2F';</span><span class="se">\"</span><span class="s2">&gt;&lt;/body&gt;&lt;noscript&gt;You will be redirected to the</span><span class="err">\</span><span class="s2">
 new address in 15 seconds... If you are not automatically taken to the new loca</span><span class="err">\</span><span class="s2">
tion, please enable javascript or click the hyperlink &lt;a href=</span><span class="se">\"</span><span class="s2">/login.php3?wind</span><span class="err">\</span><span class="s2">
ow_id=&amp;amp;requested_url=https%3A%2F%2F174.142.92.126%3A8443%2F</span><span class="se">\"</span><span class="s2"> target=</span><span class="se">\"</span><span class="s2">top</span><span class="se">\"</span><span class="err">\</span><span class="s2">
&gt;/login.php3?window_id=&amp;amp;requested_url=https%3A%2F%2F174.142.92.126%3A8443%2F</span><span class="err">\</span><span class="s2">
&lt;/a&gt;.&lt;/noscript&gt;&lt;/html&gt;&lt;!--_____________________________________________________</span><span class="err">\</span><span class="s2">
________________________________________________________________________________</span><span class="err">\</span><span class="s2">
________________________________________________________________________________</span><span class="err">\</span><span class="s2">
_________________________IE error page size limitation__________________________</span><span class="err">\</span><span class="s2">
________________________________________________________________________________</span><span class="err">\</span><span class="s2">
________________________________________________________________________________</span><span class="err">\</span><span class="s2">
____________________________________________________--&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"region_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QC"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"area_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-73.5833</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country_code3"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAN"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">45.5</span><span class="p">,</span><span class="w">
        </span><span class="s2">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"H3G"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dma_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Canada"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-25T11:56:52.548187"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"domains"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"org"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iWeb Technologies"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"_shodan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="s2">"module"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"crawler"</span><span class="p">:</span><span class="w"> </span><span class="s2">"122dd688b363c3b45b0e7582622da1e725444808"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"opts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"heartbleed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016/02/25 03:56:45 ([]uint8) {</span><span class="se">\n</span><span class="s2"> 00000000  02 00 74 63 6</span><span class="err">\</span><span class="s2">
5 6e 73 75  73 2e 73 68 6f 64 61 6e  |..tcensus.shodan|</span><span class="se">\n</span><span class="s2"> 00000010  2e 69 6f 53 </span><span class="err">\</span><span class="s2">
45 43 55 52  49 54 59 20 53 55 52 56  |.ioSECURITY SURV|</span><span class="se">\n</span><span class="s2"> 00000020  45 59 fe 7a</span><span class="err">\</span><span class="s2">
 a2 0d fa ed  93 42 ed 18 b0 15 7d 6e  |EY.z.....B....}n|</span><span class="se">\n</span><span class="s2"> 00000030  29 08 f6 f</span><span class="err">\</span><span class="s2">
8 ce 00 b1 94  b5 4b 47 ac dd 18 aa b9  |)........KG.....|</span><span class="se">\n</span><span class="s2"> 00000040  db 1c 01 </span><span class="err">\</span><span class="s2">
45 95 10 e0 a2  43 fe 8e ac 88 2f e8 75  |...E....C..../.u|</span><span class="se">\n</span><span class="s2"> 00000050  8b 19 5f</span><span class="err">\</span><span class="s2">
 8c e0 8a 80 61  56 3c 68 0f e1 1f 73 9e  |.._....aV&lt;h...s.|</span><span class="se">\n</span><span class="s2"> 00000060  61 4f d</span><span class="err">\</span><span class="s2">
a db 90 ce 84 e3  79 5f 9d 6c a0 90 ff fa  |aO......y_.l....|</span><span class="se">\n</span><span class="s2"> 00000070  d8 16 </span><span class="err">\</span><span class="s2">
e8 76 07 b2 e5 5e  8e 3e a4 45 61 2f 6a 2d  |...v...^.&gt;.Ea/j-|</span><span class="se">\n</span><span class="s2"> 00000080  5d 11</span><span class="err">\</span><span class="s2">
74 94 03 3c 5d                              |].t..&lt;]|</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n\n</span><span class="s2">2016/02/25 03:56:45</span><span class="err">\</span><span class="s2">
 174.142.92.126:8443 - VULNERABLE</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"vulns"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"CVE-2014-0160"</span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"ip_str"</span><span class="p">:</span><span class="w"> </span><span class="s2">"174.142.92.126"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="refer">Refer</h2>
<ul>
  <li><a href="https://asciinema.org/~Shodan">28 public asciicasts by Shodan</a>:https://asciinema.org/~Shodan</li>
  <li><a href="http://www.freebuf.com/sectool/121339.html">Shodan新手入坑指南</a>:http://www.freebuf.com/sectool/121339.html</li>
  <li><a href="https://leanpub.com/shodan">Complete Guide to Shodan</a>：https://leanpub.com/shodan</li>
  <li><a href="http://shodan.readthedocs.io/en/latest/index.html">shodan - The official Python library for the Shodan search engine</a>：http://shodan.readthedocs.io/en/latest/index.html</li>
  <li><a href="https://gist.github.com/achillean/963eea552233d9550101">Create GIFs from a Shodan json.gz file using the API</a>：https://gist.github.com/achillean/963eea552233d9550101https://gist.github.com/achillean/963eea552233d9550101</li>
  <li><a href="http://drops.wooyun.org/tips/8594">工控安全入门分析</a>：http://drops.wooyun.org/tips/8594</li>
  <li><a href="http://plcscan.org/blog/">灯塔实验室</a>：http://plcscan.org/blog/</li>
  <li><a href="https://github.com/evilcos/papers">网络空间工控设备的发现与入侵</a>：https://github.com/evilcos/papers</li>
  <li><a href="http://b404.xyz/2017/10/27/industrial-control/">工控</a>：http://b404.xyz/2017/10/27/industrial-control/</li>
</ul>

<p><img src="D:\我的文章\投稿文章\jirairya\Shodan——从入门到放弃(md版本)\Shodan——从入门到放弃(md版本)\2.png" alt="2" /></p>

        </article>
        <hr>

        
        
            
            
                
                    
                        
                        <h2 id="similar_posts">Similar Posts</h2>
                        <ul>
                        
                        <li class="relatedPost">
                            <a href="/2018/01/27/hidden-the-network/">阻碍获取真实网络指纹
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2018/01/04/command-and-control-images/">command-and-control-images
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2017/12/27/open-RDP/">开启RDP
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2017/11/30/Test-LAB-11/">TEST LAB 11
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2017/11/29/proxy/">代理
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2017/11/29/port-fowarding-and-socks-proxy/">Socks端口转发和Socks端口代理
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
        
            </ul>
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/2018/01/27/hidden-the-network/">阻碍获取真实网络指纹</a></p>
        
    </div>
    <div class="nex">

        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        


<div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function() {
        this.page.url = 'http://localhost:4000/2018/02/08/Shodan-Manual/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://localhost:4000/2018/02/08/Shodan-Manual/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//http-b404-xyz.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#similar_posts">Similar Posts</a></li>
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             The quieter you become, the more you can hear. 
        </p>

        <br>
        <p class="contact">
             
            <a href="https://github.com/9jan" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:jirairya404@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        
            
        </p>
        <!--
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
    -->
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a>
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
